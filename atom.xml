<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Honey</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://zhanghuaxiao.github.io/"/>
  <updated>2019-02-18T08:10:11.796Z</updated>
  <id>https://zhanghuaxiao.github.io/</id>
  
  <author>
    <name>Honey</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>æ¢ç©¶call å’Œ apply çš„åŸç†</title>
    <link href="https://zhanghuaxiao.github.io/2019/02/18/%E6%8E%A2%E7%A9%B6call-%E5%92%8C-apply-%E7%9A%84%E5%8E%9F%E7%90%86/"/>
    <id>https://zhanghuaxiao.github.io/2019/02/18/æ¢ç©¶call-å’Œ-apply-çš„åŸç†/</id>
    <published>2019-02-18T06:40:01.000Z</published>
    <updated>2019-02-18T08:10:11.796Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>éŸ³ä¹ğŸµæ­é…å­¦ä¹ æ›´ç¾å‘³å“¦ï¼</p></blockquote><p><img src="/img/callAndapply.jpg"><br>å»ºè®®çœ‹è¿™ç‰‡æ–‡ç« æ—¶å¯ä»¥ç‚¹å‡»<a href="https://music.163.com/#/song?id=1293886117" target="_blank" rel="noopener">éŸ³ä¹ğŸµ</a>ï¼Œæ¥ä¸ªå•æ›²å¾ªï¼Œç¾æ»‹æ»‹<br><a id="more"></a></p><h1 id="å…ˆæ‹¿callå¼€åˆ€"><a href="#å…ˆæ‹¿callå¼€åˆ€" class="headerlink" title="å…ˆæ‹¿callå¼€åˆ€"></a>å…ˆæ‹¿callå¼€åˆ€</h1><blockquote><p>ä½œç”¨ï¼šcallå’Œapplyéƒ½æ˜¯æ›¿æ¢å‡½æ•°å†…é”™è¯¯çš„this</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">    value:<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> b = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.value) <span class="comment">// å¦‚æœä¸å¯¹thisè¿›è¡Œç»‘å®šæ‰§è¡Œbar() ä¼šè¿”å›undefined</span></span><br><span class="line">&#125;</span><br><span class="line">b.call(a) <span class="comment">//1</span></span><br></pre></td></tr></table></figure><p>å»é™¤ç¹ççš„è®²è§£ï¼Œä¸€æ­¥åˆ°ä½è‡ªå·±æ¨¡æ‹Ÿcallçš„ç”¨æ³•å†™ä¸€ä¸ªå‡½æ•°ï¼Œè¾¾åˆ°ç›¸åŒç›®çš„</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myCall = <span class="function"><span class="keyword">function</span>(<span class="params">context</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> context = context || <span class="built_in">window</span>; <span class="comment">//å½“æ²¡ä¼ å…¥å€¼æ—¶å€™ï¼Œå°±æ˜¯æŒ‡å…¨å±€window</span></span><br><span class="line">    context.fn = <span class="keyword">this</span>; <span class="comment">//æŠŠè°ƒç”¨myCallå‰çš„æ–¹æ³•ç¼“å­˜ä¸‹æ¥</span></span><br><span class="line">    <span class="keyword">var</span> args = [...arguments].slice(<span class="number">1</span>);<span class="comment">//ä½¿ç”¨...æ‰“æ•£ä¼ å…¥å€¼ï¼Œå¹¶å»é™¤ç¬¬ä¸€æ–¹æ³•ï¼Œå¾—åˆ°ä¸€ä¸ªæ•°ç»„</span></span><br><span class="line">    <span class="keyword">var</span> result = context.fn(...args);<span class="comment">//æŠŠæ•°ç»„æ‰“æ•£ï¼ŒæŠŠdinging 18ä¼ å…¥bæ–¹æ³•ä¸­</span></span><br><span class="line">    <span class="keyword">delete</span> context.fn(); <span class="comment">//åˆ é™¤</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">    value:<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> b = <span class="function"><span class="keyword">function</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.value)</span><br><span class="line">    <span class="built_in">console</span>.log(name)</span><br><span class="line">    <span class="built_in">console</span>.log(age)</span><br><span class="line">&#125;</span><br><span class="line">b.myCall(a,<span class="string">"dingding"</span>,<span class="number">18</span>)</span><br></pre></td></tr></table></figure><h2 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h2><blockquote><p>applyçš„æ–¹æ³•å’Œ call æ–¹æ³•çš„å®ç°ç±»ä¼¼ï¼Œåªä¸è¿‡æ˜¯å¦‚æœæœ‰å‚æ•°ï¼Œä»¥æ•°ç»„å½¢å¼è¿›è¡Œä¼ é€’</p></blockquote><p>applyè¿™ä¸ªAPIå¹³æ—¶ä½¿ç”¨çš„åœºæ™¯ï¼Œä»£ç å¦‚ä¸‹:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">    value:<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> b = <span class="function"><span class="keyword">function</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.value)</span><br><span class="line">    <span class="built_in">console</span>.log(name)</span><br><span class="line">    <span class="built_in">console</span>.log(age)</span><br><span class="line">&#125;</span><br><span class="line">b.apply(a,[<span class="string">"dingding"</span>,<span class="number">18</span>])</span><br></pre></td></tr></table></figure></p><p>ç›´æ¥ä¸Šæ¨¡æ‹ŸapplyåŠŸèƒ½ä»£ç <br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myApply = <span class="function"><span class="keyword">function</span>(<span class="params">context</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> context = context || <span class="built_in">window</span>;</span><br><span class="line">    context.fn = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">var</span> result;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">arguments</span>[<span class="number">1</span>])&#123;</span><br><span class="line">        result = context.fn(...arguments[<span class="number">1</span>]) </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        result = context.fn()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">delete</span> context.fn()</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">    value:<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> b = <span class="function"><span class="keyword">function</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.value)</span><br><span class="line">    <span class="built_in">console</span>.log(name)</span><br><span class="line">    <span class="built_in">console</span>.log(age)</span><br><span class="line">&#125;</span><br><span class="line">b.myApply(a,[<span class="string">"dingding"</span>,<span class="number">18</span>])</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;p&gt;éŸ³ä¹ğŸµæ­é…å­¦ä¹ æ›´ç¾å‘³å“¦ï¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;/img/callAndapply.jpg&quot;&gt;&lt;br&gt;å»ºè®®çœ‹è¿™ç‰‡æ–‡ç« æ—¶å¯ä»¥ç‚¹å‡»&lt;a href=&quot;https://music.163.com/#/song?id=1293886117&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;éŸ³ä¹ğŸµ&lt;/a&gt;ï¼Œæ¥ä¸ªå•æ›²å¾ªï¼Œç¾æ»‹æ»‹&lt;br&gt;
    
    </summary>
    
      <category term="web" scheme="https://zhanghuaxiao.github.io/categories/web/"/>
    
    
      <category term="æ¢ç©¶call å’Œ apply çš„åŸç†" scheme="https://zhanghuaxiao.github.io/tags/%E6%8E%A2%E7%A9%B6call-%E5%92%8C-apply-%E7%9A%84%E5%8E%9F%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>å›¾ç‰‡æ‡’åŠ è½½</title>
    <link href="https://zhanghuaxiao.github.io/2019/02/14/%E5%9B%BE%E7%89%87%E6%87%92%E5%8A%A0%E8%BD%BD/"/>
    <id>https://zhanghuaxiao.github.io/2019/02/14/å›¾ç‰‡æ‡’åŠ è½½/</id>
    <published>2019-02-14T11:22:21.000Z</published>
    <updated>2019-02-18T06:37:24.293Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>LazyLoad </p></blockquote><p><img src="/img/lazyload.gif"><br><a id="more"></a></p><h1 id="æ‡’åŠ è½½çš„æ„ä¹‰"><a href="#æ‡’åŠ è½½çš„æ„ä¹‰" class="headerlink" title="æ‡’åŠ è½½çš„æ„ä¹‰"></a>æ‡’åŠ è½½çš„æ„ä¹‰</h1><p>è¿™é‡Œâ€˜æ‡’â€™çš„æ„æ€å¯ä»¥ç†è§£ä¸ºå»¶è¿Ÿï¼Œå¦‚æ·˜å®ã€äº¬ä¸œè¿™äº›ç”µå•†å¹³å°æœ‰å¤§é‡çš„å›¾ç‰‡ï¼Œå¦‚æœä¸Šæ¥å°±åŠ è½½æœåŠ¡å™¨è¡¨ç¤ºå‹åŠ›å±±å¤§ï¼Œæ‰€ä»¥å°±æƒ³å‡ºäº†æ‡’åŠ è½½è¿™ç§å…‹æ•Œä¹‹æ³•ï¼Œç”¨æˆ·æ»šåŠ¨åˆ°çš„åŒºåŸŸæ‰å‘é€è¯·æ±‚åŠ è½½å†…å®¹</p><h1 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h1><p>å°†é¡µé¢ä¸­çš„imgæ ‡ç­¾srcæŒ‡å‘ä¸€å¼ å°ç…§ç‰‡æˆ–è€…ä¸ºç©ºéƒ½å¯ä»¥ï¼Œç„¶åå†™ä¸€ä¸ªè‡ªå®šä¹‰å±æ€§æ¯”å¦‚ï¼ˆdata-srcï¼‰æŒ‡å‘æ­£ç¡®çš„å›¾ç‰‡ï¼Œå…¶å®å°±æ˜¯ç”¨æ­£ç¡®çš„ç…§ç‰‡æ›¿æ¢srcé‡Œé¢çš„ç…§ç‰‡</p><h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><p>åœ¨å†™ä»£ç å‰ï¼Œéœ€è¦äº†è§£å„ç§é«˜åº¦ã€‚å…ˆçœ‹è¿™ç¯‡æ–‡ç« <a href="https://zhanghuaxiao.github.io/2019/02/14/jsè·å–äº‹ä»¶åæ ‡ä½ç½®/">jsåæ ‡ä½ç½®</a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">    &lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">    &lt;style&gt;</span></span><br><span class="line"><span class="regexp">        img &#123;</span></span><br><span class="line"><span class="regexp">            display: block;</span></span><br><span class="line"><span class="regexp">            margin-bottom: 50px;</span></span><br><span class="line"><span class="regexp">            width: 400px;</span></span><br><span class="line"><span class="regexp">            height: 400px;</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>style&gt;</span><br><span class="line">&lt;<span class="regexp">/head&gt;</span></span><br><span class="line"><span class="regexp">&lt;body&gt;</span></span><br><span class="line"><span class="regexp">    &lt;img src="" data-src="http:/</span><span class="regexp">/ww4.sinaimg.cn/</span>large/<span class="number">006</span>y8mN6gw1fa5obmqrmvj305k05k3yh.jpg<span class="string">" alt="</span><span class="string">"&gt;</span></span><br><span class="line"><span class="string">        &lt;img src="</span><span class="string">" data-src="</span>http:<span class="comment">//ww1.sinaimg.cn/large/006y8mN6gw1fa7kaed2hpj30sg0l9q54.jpg" alt=""&gt;</span></span><br><span class="line">        &lt;img src=<span class="string">""</span> data-src=<span class="string">"http://imgsrc.baidu.com/imgad/pic/item/3c6d55fbb2fb43161361e1432ba4462309f7d389.jpg"</span> alt=<span class="string">""</span>&gt;</span><br><span class="line">        &lt;img src=<span class="string">""</span> data-src=<span class="string">"http://pic.58pic.com/58pic/15/68/59/71X58PICNjx_1024.jpg"</span> alt=<span class="string">""</span>&gt;</span><br><span class="line">        &lt;img src=<span class="string">""</span> data-src=<span class="string">"http://qimg.hxnews.com/2019/0128/1548663985785.jpg"</span> alt=<span class="string">""</span>&gt;</span><br><span class="line">        &lt;img src=<span class="string">""</span> data-src=<span class="string">"http://imgsrc.baidu.com/imgad/pic/item/242dd42a2834349bf8d014a3c3ea15ce37d3bec6.jpg"</span> alt=<span class="string">""</span>&gt;</span><br><span class="line">        &lt;img src=<span class="string">""</span> data-src=<span class="string">"http://imgsrc.baidu.com/imgad/pic/item/d439b6003af33a87089f4704cc5c10385343b53a.jpg"</span> alt=<span class="string">""</span>&gt;</span><br><span class="line">        &lt;img src=<span class="string">""</span> data-src=<span class="string">"http://imgsrc.baidu.com/imgad/pic/item/38dbb6fd5266d01607666e0b9d2bd40735fa3591.jpg"</span> alt=<span class="string">""</span>&gt;</span><br><span class="line">        &lt;img src=<span class="string">""</span> data-src=<span class="string">"http://imgsrc.baidu.com/imgad/pic/item/d043ad4bd11373f02f236d8cae0f4bfbfbed0480.jpg"</span> alt=<span class="string">""</span>&gt;</span><br><span class="line">&lt;<span class="regexp">/body&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="javascript"><a href="#javascript" class="headerlink" title="javascript"></a>javascript</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'img'</span>).length;</span><br><span class="line"><span class="keyword">var</span> img = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"img"</span>);</span><br><span class="line"><span class="keyword">var</span> n = <span class="number">0</span>; <span class="comment">//å­˜å‚¨å›¾ç‰‡åŠ è½½åˆ°çš„ä½ç½®ï¼Œé¿å…æ¯æ¬¡éƒ½ä»ç¬¬ä¸€å¼ å›¾ç‰‡å¼€å§‹éå†</span></span><br><span class="line">lazyload(); <span class="comment">//é¡µé¢è½½å…¥å®Œæ¯•åŠ è½½å¯æ˜¯åŒºåŸŸå†…çš„å›¾ç‰‡</span></span><br><span class="line"><span class="built_in">window</span>.onscroll = lazyload;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">lazyload</span>(<span class="params"></span>) </span>&#123; <span class="comment">//ç›‘å¬é¡µé¢æ»šåŠ¨äº‹ä»¶</span></span><br><span class="line">    <span class="keyword">var</span> seeHeight = <span class="built_in">document</span>.documentElement.clientHeight; <span class="comment">//å¯è§åŒºåŸŸé«˜åº¦</span></span><br><span class="line">    <span class="keyword">var</span> scrollTop = <span class="built_in">document</span>.documentElement.scrollTop || <span class="built_in">document</span>.body.scrollTop; <span class="comment">//æ»šåŠ¨æ¡è·ç¦»é¡¶éƒ¨é«˜åº¦</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = n; i &lt; num; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (img[i].offsetTop &lt; seeHeight + scrollTop) &#123;</span><br><span class="line">            <span class="keyword">if</span> (img[i].getAttribute(<span class="string">"src"</span>) == <span class="string">""</span>) &#123;</span><br><span class="line">                img[i].src = img[i].getAttribute(<span class="string">"data-src"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            n = i + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨èŠ‚æµå‡½æ•°è¿›è¡Œæ€§èƒ½ä¼˜åŒ–"><a href="#ä½¿ç”¨èŠ‚æµå‡½æ•°è¿›è¡Œæ€§èƒ½ä¼˜åŒ–" class="headerlink" title="ä½¿ç”¨èŠ‚æµå‡½æ•°è¿›è¡Œæ€§èƒ½ä¼˜åŒ–"></a>ä½¿ç”¨èŠ‚æµå‡½æ•°è¿›è¡Œæ€§èƒ½ä¼˜åŒ–</h2><p>å¦‚æœç›´æ¥å°†å‡½æ•°ç»‘å®šåœ¨scrolläº‹ä»¶ä¸Šï¼Œå½“é¡µé¢æ»šåŠ¨æ—¶ï¼Œå‡½æ•°ä¼šè¢«é«˜é¢‘è§¦å‘ï¼Œè¿™éå¸¸å½±å“æµè§ˆå™¨çš„æ€§èƒ½ã€‚<br>æˆ‘æƒ³å®ç°é™åˆ¶è§¦å‘é¢‘ç‡ï¼Œæ¥ä¼˜åŒ–æ€§èƒ½ã€‚</p><p>èŠ‚æµå‡½æ•°ï¼šåªå…è®¸ä¸€ä¸ªå‡½æ•°åœ¨Nç§’å†…æ‰§è¡Œä¸€æ¬¡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªé€šä¿—æ˜“é€šçš„èŠ‚æµå‡½æ•°ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'img'</span>).length;</span><br><span class="line"><span class="keyword">var</span> img = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"img"</span>);</span><br><span class="line"><span class="keyword">var</span> n = <span class="number">0</span>; <span class="comment">//å­˜å‚¨å›¾ç‰‡åŠ è½½åˆ°çš„ä½ç½®ï¼Œé¿å…æ¯æ¬¡éƒ½ä»ç¬¬ä¸€å¼ å›¾ç‰‡å¼€å§‹éå†</span></span><br><span class="line">resizehandler(); <span class="comment">//é¡µé¢è½½å…¥å®Œæ¯•åŠ è½½å¯æ˜¯åŒºåŸŸå†…çš„å›¾ç‰‡</span></span><br><span class="line">n=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resizehandler</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> seeHeight = <span class="built_in">document</span>.documentElement.clientHeight; <span class="comment">//å¯è§åŒºåŸŸé«˜åº¦</span></span><br><span class="line">    <span class="keyword">var</span> scrollTop = <span class="built_in">document</span>.documentElement.scrollTop || <span class="built_in">document</span>.body.scrollTop; <span class="comment">//æ»šåŠ¨æ¡è·ç¦»é¡¶éƒ¨é«˜åº¦</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = n; i &lt; num; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (img[i].offsetTop &lt; seeHeight + scrollTop) &#123;</span><br><span class="line">            <span class="keyword">if</span> (img[i].getAttribute(<span class="string">"src"</span>) == <span class="string">""</span>) &#123;</span><br><span class="line">                img[i].src = img[i].getAttribute(<span class="string">"data-src"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            n = i + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">method,context</span>)</span>&#123;</span><br><span class="line">    clearTimeout(method.tId);</span><br><span class="line">    method.tId=setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        method.call(context);</span><br><span class="line">    &#125;,<span class="number">500</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.onscroll=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    throttle(resizehandler,<span class="built_in">window</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>    </p><h1 id="å‡½æ•°èŠ‚æµæ–¹æ¡ˆä»¥ä¸‹ä¸‰ç§"><a href="#å‡½æ•°èŠ‚æµæ–¹æ¡ˆä»¥ä¸‹ä¸‰ç§" class="headerlink" title="å‡½æ•°èŠ‚æµæ–¹æ¡ˆä»¥ä¸‹ä¸‰ç§"></a>å‡½æ•°èŠ‚æµæ–¹æ¡ˆä»¥ä¸‹ä¸‰ç§</h1><h2 id="æ—¶é—´æˆ³æ–¹æ¡ˆ"><a href="#æ—¶é—´æˆ³æ–¹æ¡ˆ" class="headerlink" title="æ—¶é—´æˆ³æ–¹æ¡ˆ"></a>æ—¶é—´æˆ³æ–¹æ¡ˆ</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">var</span> num = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'img'</span>).length;</span><br><span class="line">    <span class="keyword">var</span> img = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"img"</span>);</span><br><span class="line">    <span class="keyword">var</span> n = <span class="number">0</span>; <span class="comment">//å­˜å‚¨å›¾ç‰‡åŠ è½½åˆ°çš„ä½ç½®ï¼Œé¿å…æ¯æ¬¡éƒ½ä»ç¬¬ä¸€å¼ å›¾ç‰‡å¼€å§‹éå†</span></span><br><span class="line">    lazyload(); <span class="comment">//é¡µé¢è½½å…¥å®Œæ¯•åŠ è½½å¯æ˜¯åŒºåŸŸå†…çš„å›¾ç‰‡</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">lazyload</span>(<span class="params"></span>) </span>&#123; <span class="comment">//ç›‘å¬é¡µé¢æ»šåŠ¨äº‹ä»¶</span></span><br><span class="line">        <span class="keyword">var</span> seeHeight = <span class="built_in">document</span>.documentElement.clientHeight; <span class="comment">//å¯è§åŒºåŸŸé«˜åº¦</span></span><br><span class="line">        <span class="keyword">var</span> scrollTop = <span class="built_in">document</span>.documentElement.scrollTop || <span class="built_in">document</span>.body.scrollTop; <span class="comment">//æ»šåŠ¨æ¡è·ç¦»é¡¶éƒ¨é«˜åº¦</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = n; i &lt; num; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (img[i].offsetTop &lt; seeHeight + scrollTop) &#123;</span><br><span class="line">                <span class="keyword">if</span> (img[i].getAttribute(<span class="string">"src"</span>) == <span class="string">""</span>) &#123;</span><br><span class="line">                    img[i].src = img[i].getAttribute(<span class="string">"data-src"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                n = i + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">---------------------------------  ä»¥ä¸Šä»£ç ä¸åœ¨é‡å¤  --------------------------------</span><br><span class="line">    <span class="keyword">var</span> throttle = <span class="function"><span class="keyword">function</span>(<span class="params">fun,delay</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> perv = <span class="built_in">Date</span>.now();</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> context = <span class="keyword">this</span>;</span><br><span class="line">            <span class="keyword">var</span> now = <span class="built_in">Date</span>.now();</span><br><span class="line">            <span class="keyword">if</span> (now-perv &gt;= delay)&#123;</span><br><span class="line">                fun.apply(context,<span class="built_in">arguments</span>)</span><br><span class="line">                prev = <span class="built_in">Date</span>.now();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">'scroll'</span>,throttle(lazyload,<span class="number">1000</span>))</span><br></pre></td></tr></table></figure><h2 id="å®šæ—¶å™¨æ–¹æ¡ˆ"><a href="#å®šæ—¶å™¨æ–¹æ¡ˆ" class="headerlink" title="å®šæ—¶å™¨æ–¹æ¡ˆ"></a>å®šæ—¶å™¨æ–¹æ¡ˆ</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> throttle = <span class="function"><span class="keyword">function</span>(<span class="params">fun,delay</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> timer = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> context = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">if</span>(!timer)&#123;</span><br><span class="line">            timer = setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">                fun.apply(context,<span class="built_in">arguments</span>)</span><br><span class="line">                timer = <span class="literal">null</span></span><br><span class="line">            &#125;,delay)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'scroll'</span>,throttle(lazyload,<span class="number">1000</span>))</span><br></pre></td></tr></table></figure><h2 id="æ—¶é—´æˆ³-å®šæ—¶å™¨æ–¹æ¡ˆ"><a href="#æ—¶é—´æˆ³-å®šæ—¶å™¨æ–¹æ¡ˆ" class="headerlink" title="æ—¶é—´æˆ³+å®šæ—¶å™¨æ–¹æ¡ˆ"></a>æ—¶é—´æˆ³+å®šæ—¶å™¨æ–¹æ¡ˆ</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> throttle = <span class="function"><span class="keyword">function</span>(<span class="params">fun,delay</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> timer = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">var</span> startTime = <span class="built_in">Date</span>.now();</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> curTime = <span class="built_in">Date</span>.now();</span><br><span class="line">            <span class="keyword">var</span> remaining = delay - (curTime - startTime);</span><br><span class="line">            <span class="keyword">var</span> context = <span class="keyword">this</span>;</span><br><span class="line">            <span class="keyword">var</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">            clearTimeout(timer);</span><br><span class="line">            <span class="keyword">if</span> (remaining &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                    fun.apply(context, args);</span><br><span class="line">                    startTime = <span class="built_in">Date</span>.now();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    timer = setTimeout(fun, remaining);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'scroll'</span>,throttle(lazyload,<span class="number">1000</span>))</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;p&gt;LazyLoad &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;/img/lazyload.gif&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="web" scheme="https://zhanghuaxiao.github.io/categories/web/"/>
    
    
      <category term="å›¾ç‰‡æ‡’åŠ è½½" scheme="https://zhanghuaxiao.github.io/tags/%E5%9B%BE%E7%89%87%E6%87%92%E5%8A%A0%E8%BD%BD/"/>
    
      <category term="å‡½æ•°èŠ‚æµ3ç§æ–¹å¼" scheme="https://zhanghuaxiao.github.io/tags/%E5%87%BD%E6%95%B0%E8%8A%82%E6%B5%813%E7%A7%8D%E6%96%B9%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>jsè·å–äº‹ä»¶åæ ‡ä½ç½®</title>
    <link href="https://zhanghuaxiao.github.io/2019/02/14/js%E8%8E%B7%E5%8F%96%E4%BA%8B%E4%BB%B6%E5%9D%90%E6%A0%87%E4%BD%8D%E7%BD%AE/"/>
    <id>https://zhanghuaxiao.github.io/2019/02/14/jsè·å–äº‹ä»¶åæ ‡ä½ç½®/</id>
    <published>2019-02-14T09:21:15.000Z</published>
    <updated>2019-02-15T06:27:53.189Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>å¿ƒæœ‰çŒ›è™ï¼Œç»†å—…è”·è–‡ </p></blockquote><a id="more"></a><h1 id="å…³äºscrollTop-offsetTop-scrollLeft-offsetLeftç”¨æ³•ä»‹ç»"><a href="#å…³äºscrollTop-offsetTop-scrollLeft-offsetLeftç”¨æ³•ä»‹ç»" class="headerlink" title="å…³äºscrollTop,offsetTop,scrollLeft,offsetLeftç”¨æ³•ä»‹ç»"></a>å…³äºscrollTop,offsetTop,scrollLeft,offsetLeftç”¨æ³•ä»‹ç»</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">é¡µå¯è§åŒºåŸŸå®½ï¼š <span class="built_in">document</span>.body.clientWidth;</span><br><span class="line">ç½‘é¡µå¯è§åŒºåŸŸé«˜ï¼š <span class="built_in">document</span>.body.clientHeight;</span><br><span class="line">ç½‘é¡µå¯è§åŒºåŸŸå®½ï¼š <span class="built_in">document</span>.body.offsetWidth (åŒ…æ‹¬è¾¹çº¿çš„å®½);</span><br><span class="line">ç½‘é¡µå¯è§åŒºåŸŸé«˜ï¼š <span class="built_in">document</span>.body.offsetHeight (åŒ…æ‹¬è¾¹çº¿çš„å®½);</span><br><span class="line">ç½‘é¡µæ­£æ–‡å…¨æ–‡å®½ï¼š <span class="built_in">document</span>.body.scrollWidth;</span><br><span class="line">ç½‘é¡µæ­£æ–‡å…¨æ–‡é«˜ï¼š <span class="built_in">document</span>.body.scrollHeight;</span><br><span class="line">ç½‘é¡µè¢«å·å»çš„é«˜ï¼š <span class="built_in">document</span>.body.scrollTop;</span><br><span class="line">ç½‘é¡µè¢«å·å»çš„å·¦ï¼š <span class="built_in">document</span>.body.scrollLeft;</span><br><span class="line">ç½‘é¡µæ­£æ–‡éƒ¨åˆ†ä¸Šï¼š <span class="built_in">window</span>.screenTop;</span><br><span class="line">ç½‘é¡µæ­£æ–‡éƒ¨åˆ†å·¦ï¼š <span class="built_in">window</span>.screenLeft;</span><br><span class="line">å±å¹•åˆ†è¾¨ç‡çš„é«˜ï¼š <span class="built_in">window</span>.screen.height;</span><br><span class="line">å±å¹•åˆ†è¾¨ç‡çš„å®½ï¼š <span class="built_in">window</span>.screen.width;</span><br><span class="line">å±å¹•å¯ç”¨å·¥ä½œåŒºé«˜åº¦ï¼š <span class="built_in">window</span>.screen.availHeight;</span><br></pre></td></tr></table></figure><p><img src="/img/location.jpeg"></p><h1 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶</h1><h2 id="åæ ‡äº‹ä»¶"><a href="#åæ ‡äº‹ä»¶" class="headerlink" title="åæ ‡äº‹ä»¶"></a>åæ ‡äº‹ä»¶</h2><p>1.ç›¸å¯¹äºæ˜¾ç¤ºå±å·¦ä¸Šè§’:e.screenX,e.screenY<br>2.ç›¸å¯¹äºæ–‡æ¡£æ˜¾ç¤ºåŒºå·¦ä¸Šè§’:e.clientX,e.clientY<br>3.ç›¸å¯¹äºdivå·¦ä¸Šè§’:e.offsetX,e.offsetY</p><hr><h2 id="é¡µé¢æ»šåŠ¨äº‹ä»¶"><a href="#é¡µé¢æ»šåŠ¨äº‹ä»¶" class="headerlink" title="é¡µé¢æ»šåŠ¨äº‹ä»¶"></a>é¡µé¢æ»šåŠ¨äº‹ä»¶</h2><p>window.onscroll  å½“é¡µé¢æ»šåŠ¨æ—¶è§¦å‘<br>              è·å–æ»šåŠ¨è·ç¦»ï¼šdocument.body.scrollTop | |  document.documentElement.scrollTop<br>      ä¸»åŠ¨æ§åˆ¶é¡µé¢çš„æ»šåŠ¨ä½ç½®ï¼š<br>            window.scrollToï¼ˆæ¨ªå‘æ»šåŠ¨åˆ°çš„ä½ç½®ï¼Œçºµå‘æ»šåŠ¨åˆ°çš„ä½ç½®ï¼‰<br>            window.scrollBy(æ¨ªå‘æ»šåŠ¨çš„è·ç¦»ï¼Œçºµå‘æ»šåŠ¨çš„è·ç¦»)</p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><p><a href="https://blog.csdn.net/qq_35430000/article/details/80277587" target="_blank" rel="noopener">ææ¸…clientHeightã€offsetHeightã€scrollHeightã€offsetTopã€scrollTop</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;p&gt;å¿ƒæœ‰çŒ›è™ï¼Œç»†å—…è”·è–‡ &lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="web" scheme="https://zhanghuaxiao.github.io/categories/web/"/>
    
    
      <category term="screenX/screenY" scheme="https://zhanghuaxiao.github.io/tags/screenX-screenY/"/>
    
      <category term="clientX/slientY" scheme="https://zhanghuaxiao.github.io/tags/clientX-slientY/"/>
    
      <category term="offsetX/offsetY" scheme="https://zhanghuaxiao.github.io/tags/offsetX-offsetY/"/>
    
  </entry>
  
  <entry>
    <title>æ·±åº¦å­¦ä¹ ä¹‹ç¥ç»ç½‘ç»œ</title>
    <link href="https://zhanghuaxiao.github.io/2019/02/04/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B9%8B%E4%B9%8B%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"/>
    <id>https://zhanghuaxiao.github.io/2019/02/04/æ·±åº¦å­¦ä¹ ä¹‹ä¹‹ç¥ç»ç½‘ç»œ/</id>
    <published>2019-02-04T09:50:33.000Z</published>
    <updated>2019-02-05T12:43:57.621Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>ä»Šå¤©æ˜¯19å¹´é™¤å¤•å¤œ</p></blockquote><a id="more"></a><h1 id="ç¥ç»ç½‘ç»œ"><a href="#ç¥ç»ç½‘ç»œ" class="headerlink" title="ç¥ç»ç½‘ç»œ"></a>ç¥ç»ç½‘ç»œ</h1><p><a href="https://www.imooc.com/video/18099" target="_blank" rel="noopener">å‚è€ƒè§†é¢‘</a></p><h2 id="ç¥ç»å…ƒâ€”â€”â€”â€”æœ€å°çš„ç¥ç»ç½‘ç»œ"><a href="#ç¥ç»å…ƒâ€”â€”â€”â€”æœ€å°çš„ç¥ç»ç½‘ç»œ" class="headerlink" title="ç¥ç»å…ƒâ€”â€”â€”â€”æœ€å°çš„ç¥ç»ç½‘ç»œ"></a>ç¥ç»å…ƒâ€”â€”â€”â€”æœ€å°çš„ç¥ç»ç½‘ç»œ</h2><p><img src="/img/nerve.png"><br><img src="/img/nerve1.png"></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å¤ªæ¯ç‡¥çœ‹ä¸ä¸‹å»äº† ğŸ˜‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;p&gt;ä»Šå¤©æ˜¯19å¹´é™¤å¤•å¤œ&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="æ·±åº¦å­¦ä¹ " scheme="https://zhanghuaxiao.github.io/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="ç¥ç»ç½‘ç»œ" scheme="https://zhanghuaxiao.github.io/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"/>
    
  </entry>
  
  <entry>
    <title>åŒºå—é“¾ç†è®ºå’Œä»£ç æ¼”ç¤º</title>
    <link href="https://zhanghuaxiao.github.io/2019/02/03/%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF/"/>
    <id>https://zhanghuaxiao.github.io/2019/02/03/åŒºå—é“¾æŠ€æœ¯/</id>
    <published>2019-02-03T13:28:21.000Z</published>
    <updated>2019-02-04T06:52:53.515Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>ä¸€åœºæ²¡æœ‰è¯—å’Œè¿œæ–¹ï¼Œå…¨æ˜¯è‹Ÿä¸”çš„æ¼”è®²</p></blockquote><p>æ— æ„é—´çœ‹æ™“è¯´ï¼Œä»–è¯´5Gå¯¹ä»¥åçš„å½±å“ï¼Œå…¶ä¸­æœ‰ä¸ªæ•°æ®åˆ†å‘ä½¿ç”¨äº†æ¯”ç‰¹å¸æŠ€æœ¯ï¼Œå¯¹æ­¤æŸ¥é˜…èµ„æ–™åŠè§†é¢‘è¿›è¡Œå­¦ä¹ ï¼Œä»¥ä¸‹ä¸ºä¸ªäººæ€»ç»“<br><a id="more"></a><br>å‚è€ƒèµ„æ–™å¦‚ä½•</p><ul><li><p><a href="https://v.youku.com/v_show/id_XMzk5Mzk3MjI4OA==.html?spm=a2h0j.11185381.listitem_page1.5!6~A&amp;&amp;s=6e782defbfbd0d4e11ef" target="_blank" rel="noopener">æ™“è¯´è§†é¢‘</a></p></li><li><p><a href="https://www.imooc.com/video/17059" target="_blank" rel="noopener">è®²è§£åŒºå—é“¾åŸç†è§†é¢‘</a></p></li><li><p><a href="https://www.imooc.com/video/17549" target="_blank" rel="noopener">åŒºå—é“¾ä»£ç å®ç°è§†é¢‘</a></p></li><li><p><a href="https://github.com/ethereum/go-ethereum" target="_blank" rel="noopener">ä»¥å¤ªåŠå¼€æºä»£ç </a> ä»¥å¤ªåŠï¼ˆè‹±æ–‡Ethereumï¼‰æ˜¯ä¸€ä¸ªå¼€æºçš„æœ‰æ™ºèƒ½åˆçº¦åŠŸèƒ½çš„å…¬å…±åŒºå—é“¾å¹³å°ï¼Œé€šè¿‡å…¶ä¸“ç”¨åŠ å¯†è´§å¸ä»¥å¤ªå¸ï¼ˆEtherï¼‰æä¾›å»ä¸­å¿ƒåŒ–çš„ä»¥å¤ªè™šæ‹Ÿæœºï¼ˆEthereum Virtual Machineï¼‰æ¥å¤„ç†ç‚¹å¯¹ç‚¹åˆçº¦ã€‚</p></li></ul><h2 id="åŒºå—é“¾åŸºæœ¬åŸå‹"><a href="#åŒºå—é“¾åŸºæœ¬åŸå‹" class="headerlink" title="åŒºå—é“¾åŸºæœ¬åŸå‹"></a>åŒºå—é“¾åŸºæœ¬åŸå‹</h2><ul><li>åŒºå—é“¾æœ¬è´¨å°±æ˜¯ <strong>åˆ†å¸ƒå¼æ•°æ®åº“</strong></li><li>åŒºå—é“¾æ˜¯ <strong>å…¬å¼€çš„æ•°æ®åº“</strong>ï¼Œä¸æ˜¯ç§äººçš„æ•°æ®åº“</li><li>åŒºå—é“¾æ˜¯åŠ å¯†è´§å¸å’Œæ™ºèƒ½åˆçº¦çš„åŸºç¡€</li></ul><h2 id="è§£å†³å»ä¸­å¿ƒé—®é¢˜"><a href="#è§£å†³å»ä¸­å¿ƒé—®é¢˜" class="headerlink" title="è§£å†³å»ä¸­å¿ƒé—®é¢˜"></a>è§£å†³å»ä¸­å¿ƒé—®é¢˜</h2><p>é—®ï¼šå¦‚ä½•å¿«é€ŸéªŒè¯å“ªä¸ªæ•°æ®æ‰æ˜¯æ­£ç¡®çš„ï¼Ÿ<br>ç­”ï¼šæ¯æ¬¡äº¤æ˜“éƒ½è®°å½• åºå·/æ—¶é—´æˆ³/hashå€¼ï¼Œå½¢æˆä¸€ä¸ªåŒºå—é“¾ï¼Œå’Œå…¶ä»–åŒºå—è¿›è¡Œå¯¹æ¯”</p><h2 id="å¦‚ä½•ç¡®å®šä½¿ç”¨æƒã€‚"><a href="#å¦‚ä½•ç¡®å®šä½¿ç”¨æƒã€‚" class="headerlink" title="å¦‚ä½•ç¡®å®šä½¿ç”¨æƒã€‚"></a>å¦‚ä½•ç¡®å®šä½¿ç”¨æƒã€‚</h2><p>é—®ï¼šè´¦æˆ·æ‰€æœ‰æƒé—®é¢˜<br>    <img src="/img/ownership.png"><br>    <img src="/img/ownership1.png"><br>ç­”ï¼šåœ°å€æ˜¯ç”¨å…¬é’¥é€šè¿‡hashå€¼ç”Ÿæˆçš„ï¼Œå€¼å†è¿›è¡ŒBase58è¿›è¡Œç¼–ç çš„å€¼,è°ç”¨è¿™ä¸ªåœ°å€æ”¯ä»˜ï¼Œè°å°±æ‹¥æœ‰è¿™ä¸ªåœ°å€çš„æ‰€æœ‰æƒ,è°æœ‰è¿™ä¸ªç§é’¥ï¼Œè°å°±èƒ½ç”¨è¿™ä¸ªåœ°å€æ”¯ä»˜ï¼Œä¸¢å¤±ç§é’¥å°±æ˜¯ä¸¢å¤±ä½¿ç”¨æƒä¸èƒ½è¡¥åŠ</p><h2 id="ä½¿ç”¨goè¯­è¨€æ¨¡æ‹ŸåŒºå—é“¾æŠ€æœ¯åŸºæœ¬åŸç†"><a href="#ä½¿ç”¨goè¯­è¨€æ¨¡æ‹ŸåŒºå—é“¾æŠ€æœ¯åŸºæœ¬åŸç†" class="headerlink" title="ä½¿ç”¨goè¯­è¨€æ¨¡æ‹ŸåŒºå—é“¾æŠ€æœ¯åŸºæœ¬åŸç†"></a>ä½¿ç”¨goè¯­è¨€æ¨¡æ‹ŸåŒºå—é“¾æŠ€æœ¯åŸºæœ¬åŸç†</h2><p><img src="/img/blockchain-basic-core.png"></p><h1 id="æŒ–çŸ¿çš„æœ¬è´¨"><a href="#æŒ–çŸ¿çš„æœ¬è´¨" class="headerlink" title="æŒ–çŸ¿çš„æœ¬è´¨"></a>æŒ–çŸ¿çš„æœ¬è´¨</h1><p>ä½¿ç”¨è®¡ç®—æœºè®¡ç®—ï¼Œå‰é¢è¿ç»­éƒ½æ˜¯é›¶çš„ä¸€ä¸²ï¼Œè®°å½•äº¤æ˜“ä¿¡æ¯çš„ç‰¹æ®Šçš„hashå€¼ç”Ÿäº§çš„ç¼–ç </p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;p&gt;ä¸€åœºæ²¡æœ‰è¯—å’Œè¿œæ–¹ï¼Œå…¨æ˜¯è‹Ÿä¸”çš„æ¼”è®²&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ— æ„é—´çœ‹æ™“è¯´ï¼Œä»–è¯´5Gå¯¹ä»¥åçš„å½±å“ï¼Œå…¶ä¸­æœ‰ä¸ªæ•°æ®åˆ†å‘ä½¿ç”¨äº†æ¯”ç‰¹å¸æŠ€æœ¯ï¼Œå¯¹æ­¤æŸ¥é˜…èµ„æ–™åŠè§†é¢‘è¿›è¡Œå­¦ä¹ ï¼Œä»¥ä¸‹ä¸ºä¸ªäººæ€»ç»“&lt;br&gt;
    
    </summary>
    
      <category term="åŒºå—é“¾" scheme="https://zhanghuaxiao.github.io/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/"/>
    
    
      <category term="åŒºå—é“¾ç†è®ºå’Œä»£ç æ¼”ç¤º" scheme="https://zhanghuaxiao.github.io/tags/%E5%8C%BA%E5%9D%97%E9%93%BE%E7%90%86%E8%AE%BA%E5%92%8C%E4%BB%A3%E7%A0%81%E6%BC%94%E7%A4%BA/"/>
    
  </entry>
  
  <entry>
    <title>Vuejsæºç è§£æ</title>
    <link href="https://zhanghuaxiao.github.io/2019/01/31/Vuejs%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <id>https://zhanghuaxiao.github.io/2019/01/31/Vuejsæºç è§£æ/</id>
    <published>2019-01-31T08:40:13.000Z</published>
    <updated>2019-02-13T09:39:56.343Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>é™¤äº†ä½¿ç”¨vueå·¥å…·ï¼Œæ›´æƒ³æ­å¼€ç¥ç§˜é¢çº±,å¼€å§‹ä¸€åœºç¥ç§˜ä¹‹æ—…å§ </p></blockquote><a id="more"></a><p><a href="https://github.com/vuejs/vue/blob/dev/src/core/instance/index.js" target="_blank" rel="noopener">vue.jsæºç åœ°å€</a></p><h1 id="çœ‹åæ„Ÿè§‰å†…å®¹ä¸é”™çš„å‚è€ƒèµ„æ–™"><a href="#çœ‹åæ„Ÿè§‰å†…å®¹ä¸é”™çš„å‚è€ƒèµ„æ–™" class="headerlink" title="çœ‹åæ„Ÿè§‰å†…å®¹ä¸é”™çš„å‚è€ƒèµ„æ–™"></a>çœ‹åæ„Ÿè§‰å†…å®¹ä¸é”™çš„å‚è€ƒèµ„æ–™</h1><p>1.<a href="http://hcysun.me/vue-design/art/2vue-constructor.html" target="_blank" rel="noopener">VueæŠ€æœ¯å†…å¹•</a></p><h1 id="ä»ä¸€ä¸ªç®€å•çš„exampleå¼€å§‹"><a href="#ä»ä¸€ä¸ªç®€å•çš„exampleå¼€å§‹" class="headerlink" title="ä»ä¸€ä¸ªç®€å•çš„exampleå¼€å§‹"></a>ä»ä¸€ä¸ªç®€å•çš„exampleå¼€å§‹</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">"app"</span>&gt;&#123;&#123;test&#125;&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">var vm = new Vue(&#123;</span></span><br><span class="line"><span class="regexp">el: '#app',</span></span><br><span class="line"><span class="regexp">data: &#123;</span></span><br><span class="line"><span class="regexp">        test: 1</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç ç®€å•è°ƒç”¨äº†<em>Vue</em>ï¼Œä¼ é€’äº†ä¸¤ä¸ªé€‰é¡¹ <em>el</em> å’Œ <em>data</em>,è¿™æ®µä»£ç åœ¨é¡µé¢å‘ˆç°çš„DOMå¦‚ä¸‹:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">"app"</span>&gt;<span class="number">1</span>&lt;div&gt;</span><br></pre></td></tr></table></figure></p><h2 id="æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹ä¸Šé¢çš„ä¾‹å­åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"><a href="#æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹ä¸Šé¢çš„ä¾‹å­åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ" class="headerlink" title="æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹ä¸Šé¢çš„ä¾‹å­åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"></a>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹ä¸Šé¢çš„ä¾‹å­åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h2><p>é¦–å…ˆå½“æˆ‘ä»¬ä½¿ç”¨Vueæ„é€ å‡½æ•°çš„æ—¶å€™ï¼Œç¬¬ä¸€å¥æ‰§è¡Œçš„ä»£ç åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°Vueçš„æ„é€ å‡½æ•°ï¼ŒVueçš„æ„é€ å‡½æ•°åœ¨<em>core/instance/index.js</em><br>    <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Vue</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span> &amp;&amp;</span><br><span class="line">        !(<span class="keyword">this</span> <span class="keyword">instanceof</span> Vue)</span><br><span class="line">    ) &#123;</span><br><span class="line">        warn(<span class="string">'Vue is a constructor and should be called with the `new` keyword'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>._init(options)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸Šé¢çš„ä»£ç ä¸€ç›®äº†ç„¶ï¼Œå½“new Vueæ„é€ å‡½æ•°æ—¶ï¼Œæ‰§è¡Œçš„ç¬¬ä¸€å¥ä»£ç æ—¶this._init(options)æ–¹æ³•ï¼Œoptionså‚æ•°å†…å®¹æ˜¯æˆ‘ä»¬è°ƒç”¨Vueæ„é€ å‡½æ•°ä¼ å…¥çš„<br>    <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">options = &#123;</span><br><span class="line">    el:<span class="string">'#app'</span>,</span><br><span class="line">    data:&#123;</span><br><span class="line">        test:<span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ—¢ç„¶å¦‚æ­¤æˆ‘ä»¬å°±æ‰¾åˆ° <em>_initæ–¹æ³•</em>ï¼Œ_init æ–¹æ³•åœ¨ src/core/instance/init.js æ–‡ä»¶è¢«æ·»åŠ åˆ° Vue çš„åŸå‹ä¸Šï¼Œä¸‹é¢æˆ‘ä»¬å°±çœ‹çœ‹ _init åšäº†ä»€ä¹ˆã€‚<br>_init æ–¹æ³•çš„ä¸€å¼€å§‹ï¼Œæ˜¯è¿™ä¸¤å¥ä»£ç ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm: Component = <span class="keyword">this</span></span><br><span class="line"><span class="comment">// a uid</span></span><br><span class="line">vm._uid = uid++</span><br></pre></td></tr></table></figure></p><p>é¦–å…ˆå£°æ˜äº†ä¸€ä¸ªå¸¸é‡vmï¼Œå¹¶ä¸”åœ¨vmä¸Šæ·»åŠ äº†ä¸€ä¸ªå±æ€§ <em>_uid</em>ï¼Œuidçš„åˆå§‹å€¼æ˜¯0æ¯æ¬¡å®ä¾‹åŒ–ä¸€ä¸ª Vue å®ä¾‹ä¹‹åï¼Œuid çš„å€¼éƒ½ä¼š ++ã€‚</p><h2 id="æ¥ä¸‹å»çš„ä»£ç å¦‚ä¸‹"><a href="#æ¥ä¸‹å»çš„ä»£ç å¦‚ä¸‹" class="headerlink" title="æ¥ä¸‹å»çš„ä»£ç å¦‚ä¸‹"></a>æ¥ä¸‹å»çš„ä»£ç å¦‚ä¸‹</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> startTag, endTag</span><br><span class="line"><span class="comment">/* istanbul ignore if */</span></span><br><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span> &amp;&amp; config.performance &amp;&amp; mark) &#123;</span><br><span class="line">  startTag = <span class="string">`vue-perf-start:<span class="subst">$&#123;vm._uid&#125;</span>`</span></span><br><span class="line">  endTag = <span class="string">`vue-perf-end:<span class="subst">$&#123;vm._uid&#125;</span>`</span></span><br><span class="line">  mark(startTag)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆå£°æ˜äº†startTag, endTagè¿™ä¸¤ä¸ªå‚æ•°(parameter)ï¼Œå…¶ä¸­ifæ‹¬å·ä¸­çš„æ„æ€æ˜¯ï¼šåœ¨éç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œå¹¶ä¸”config.performanceå’Œmarkéƒ½ä¸ºçœŸï¼Œæ‰æ‰§è¡Œé‡Œé¢çš„ä»£ç ï¼Œå…¶ä¸­ config.performance æ¥è‡ªäº core/config.js æ–‡ä»¶ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒVue.config åŒæ ·å¼•ç”¨äº†è¿™ä¸ªå¯¹è±¡ï¼Œåœ¨ Vue çš„å®˜æ–¹æ–‡æ¡£ä¸­å¯ä»¥çœ‹åˆ°å¦‚ä¸‹å†…å®¹ï¼š<br><strong>Vue æä¾›äº†å…¨å±€é…ç½® Vue.config.performanceï¼Œæˆ‘ä»¬é€šè¿‡å°†å…¶è®¾ç½®ä¸º trueï¼Œå³å¯å¼€å¯æ€§èƒ½è¿½è¸ª</strong></p><h2 id="ä½ å¯ä»¥è¿½è¸ªå››ä¸ªåœºæ™¯çš„æ€§èƒ½"><a href="#ä½ å¯ä»¥è¿½è¸ªå››ä¸ªåœºæ™¯çš„æ€§èƒ½" class="headerlink" title="ä½ å¯ä»¥è¿½è¸ªå››ä¸ªåœºæ™¯çš„æ€§èƒ½"></a>ä½ å¯ä»¥è¿½è¸ªå››ä¸ªåœºæ™¯çš„æ€§èƒ½</h2><p>1ã€ç»„ä»¶åˆå§‹åŒ–(component init)<br>2ã€ç¼–è¯‘(compile)ï¼Œå°†æ¨¡æ¿(template)ç¼–è¯‘æˆæ¸²æŸ“å‡½æ•°<br>3ã€æ¸²æŸ“(render)ï¼Œå…¶å®å°±æ˜¯æ¸²æŸ“å‡½æ•°çš„æ€§èƒ½ï¼Œæˆ–è€…è¯´æ¸²æŸ“å‡½æ•°æ‰§è¡Œä¸”ç”Ÿæˆè™šæ‹ŸDOM(vnode)çš„æ€§èƒ½<br>4ã€æ‰“è¡¥ä¸(patch)ï¼Œå°†è™šæ‹ŸDOMæ¸²æŸ“ä¸ºçœŸå®DOMçš„æ€§èƒ½</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;p&gt;é™¤äº†ä½¿ç”¨vueå·¥å…·ï¼Œæ›´æƒ³æ­å¼€ç¥ç§˜é¢çº±,å¼€å§‹ä¸€åœºç¥ç§˜ä¹‹æ—…å§ &lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>vueä¸­diffç®—æ³•è¯¦è§£</title>
    <link href="https://zhanghuaxiao.github.io/2019/01/30/vue-diff%E7%AE%97%E6%B3%95/"/>
    <id>https://zhanghuaxiao.github.io/2019/01/30/vue-diffç®—æ³•/</id>
    <published>2019-01-30T04:53:01.000Z</published>
    <updated>2019-02-14T07:15:32.583Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p><a href="https://zhanghuaxiao.github.io/2019/01/30/vue-source-code/">å¯ä»¥å…ˆçœ‹Vuejsè¿è¡Œæœºåˆ¶</a></p></blockquote><a id="more"></a><h1 id="å½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œvueæ˜¯æ€ä¹ˆæ›´æ–°èŠ‚ç‚¹çš„ï¼Ÿ"><a href="#å½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œvueæ˜¯æ€ä¹ˆæ›´æ–°èŠ‚ç‚¹çš„ï¼Ÿ" class="headerlink" title="å½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œvueæ˜¯æ€ä¹ˆæ›´æ–°èŠ‚ç‚¹çš„ï¼Ÿ"></a>å½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œvueæ˜¯æ€ä¹ˆæ›´æ–°èŠ‚ç‚¹çš„ï¼Ÿ</h1><p>è¦çŸ¥é“æ¸²æŸ“çœŸå®DOMçš„å¼€é”€æ˜¯å¾ˆå¤§çš„ï¼Œæ¯”å¦‚æœ‰æ—¶å€™æˆ‘ä»¬ä¿®æ”¹äº†æŸä¸ªæ•°æ®ï¼Œå¦‚æœç›´æ¥æ¸²æŸ“åˆ°çœŸå®domä¸Šä¼šå¼•èµ·æ•´ä¸ªdomæ ‘çš„é‡ç»˜å’Œé‡æ’ï¼Œæœ‰æ²¡æœ‰å¯èƒ½æˆ‘ä»¬åªæ›´æ–°æˆ‘ä»¬ä¿®æ”¹çš„é‚£ä¸€å°å—domè€Œä¸è¦æ›´æ–°æ•´ä¸ªdomå‘¢ï¼Ÿdiffç®—æ³•èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬ã€‚</p><p>æˆ‘ä»¬å…ˆæ ¹æ®çœŸå®DOMç”Ÿæˆä¸€é¢—virtual DOMï¼Œå½“virtual DOMæŸä¸ªèŠ‚ç‚¹çš„æ•°æ®æ”¹å˜åä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„Vnodeï¼Œç„¶åVnodeå’ŒoldVnodeä½œå¯¹æ¯”ï¼Œå‘ç°æœ‰ä¸ä¸€æ ·çš„åœ°æ–¹å°±ç›´æ¥ä¿®æ”¹åœ¨çœŸå®çš„DOMä¸Šï¼Œç„¶åä½¿oldVnodeçš„å€¼ä¸ºVnodeã€‚</p><p>diffçš„è¿‡ç¨‹å°±æ˜¯è°ƒç”¨åä¸ºpatchçš„å‡½æ•°ï¼Œæ¯”è¾ƒæ–°æ—§èŠ‚ç‚¹ï¼Œä¸€è¾¹æ¯”è¾ƒä¸€è¾¹ç»™çœŸå®çš„DOMæ‰“è¡¥ä¸ã€‚</p><h1 id="virtual-DOMå’ŒçœŸå®DOMçš„åŒºåˆ«ï¼Ÿ"><a href="#virtual-DOMå’ŒçœŸå®DOMçš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="virtual DOMå’ŒçœŸå®DOMçš„åŒºåˆ«ï¼Ÿ"></a>virtual DOMå’ŒçœŸå®DOMçš„åŒºåˆ«ï¼Ÿ</h1><p>virtual DOMæ˜¯å°†çœŸå®çš„DOMçš„æ•°æ®æŠ½å–å‡ºæ¥ï¼Œä»¥å¯¹è±¡çš„å½¢å¼æ¨¡æ‹Ÿæ ‘å½¢ç»“æ„ã€‚æ¯”å¦‚domæ˜¯è¿™æ ·çš„ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;p&gt;<span class="number">123</span>&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line"></span><br><span class="line">å¯¹åº”çš„virtual DOMï¼ˆä¼ªä»£ç ï¼‰ï¼š</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> Vnode = &#123;</span><br><span class="line">        tag: <span class="string">'div'</span>,</span><br><span class="line">        children: [</span><br><span class="line">            &#123; <span class="attr">tag</span>: <span class="string">'p'</span>, <span class="attr">text</span>: <span class="string">'123'</span> &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure></p><p>ï¼ˆæ¸©é¦¨æç¤ºï¼šVNodeå’ŒoldVNodeéƒ½æ˜¯å¯¹è±¡ï¼Œä¸€å®šè¦è®°ä½ï¼‰</p><h1 id="diffçš„æ¯”è¾ƒæ–¹å¼ï¼Ÿ"><a href="#diffçš„æ¯”è¾ƒæ–¹å¼ï¼Ÿ" class="headerlink" title="diffçš„æ¯”è¾ƒæ–¹å¼ï¼Ÿ"></a>diffçš„æ¯”è¾ƒæ–¹å¼ï¼Ÿ</h1><p>åœ¨é‡‡å–diffç®—æ³•æ¯”è¾ƒæ–°æ—§èŠ‚ç‚¹çš„æ—¶å€™ï¼Œæ¯”è¾ƒåªä¼šåœ¨åŒå±‚çº§è¿›è¡Œ, ä¸ä¼šè·¨å±‚çº§æ¯”è¾ƒã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;p&gt;<span class="number">123</span>&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;span&gt;<span class="number">456</span>&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br></pre></td></tr></table></figure></p><p>ä¸Šé¢çš„ä»£ç ä¼šåˆ†åˆ«æ¯”è¾ƒåŒä¸€å±‚çš„ä¸¤ä¸ªdivä»¥åŠç¬¬äºŒå±‚çš„på’Œspanï¼Œä½†æ˜¯ä¸ä¼šæ‹¿divå’Œspanä½œæ¯”è¾ƒã€‚åœ¨åˆ«å¤„çœ‹åˆ°çš„ä¸€å¼ å¾ˆå½¢è±¡çš„å›¾ï¼š<br><img src="/img/diff.png"></p><h1 id="diffæµç¨‹å›¾"><a href="#diffæµç¨‹å›¾" class="headerlink" title="diffæµç¨‹å›¾"></a>diffæµç¨‹å›¾</h1><p>å½“æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œsetæ–¹æ³•ä¼šè®©è°ƒç”¨Dep.notifyé€šçŸ¥æ‰€æœ‰è®¢é˜…è€…Watcherï¼Œè®¢é˜…è€…å°±ä¼šè°ƒç”¨patchç»™çœŸå®çš„DOMæ‰“è¡¥ä¸ï¼Œæ›´æ–°ç›¸åº”çš„è§†å›¾<br><img src="/img/diff-diagram.png"></p><h1 id="å…·ä½“åˆ†æ"><a href="#å…·ä½“åˆ†æ" class="headerlink" title="å…·ä½“åˆ†æ"></a>å…·ä½“åˆ†æ</h1><p>patch<br>æ¥çœ‹çœ‹patchæ˜¯æ€ä¹ˆæ‰“è¡¥ä¸çš„ï¼ˆä»£ç åªä¿ç•™æ ¸å¿ƒéƒ¨åˆ†ï¼‰<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">patch</span> (<span class="params">oldVnode,vnode</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//some code</span></span><br><span class="line">    <span class="keyword">if</span>(sameVnode(oldVnode,vnode))&#123;</span><br><span class="line">        patchVnode(oldVnode,vnode)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">const</span> oEl = oldVnode.el   <span class="comment">//å½“å‰oldVnodeå¯¹åº”çš„çœŸå®å…ƒç´ èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">let</span> parentEle = api.parentNode(oEl)   <span class="comment">//çˆ¶å…ƒç´ </span></span><br><span class="line">        createEle(vnode)   <span class="comment">//æ ¹æ®Vnodeç”Ÿæˆæ–°å…ƒç´ </span></span><br><span class="line">            <span class="keyword">if</span> (parentEle !== <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// å°†æ–°å…ƒç´ æ·»åŠ è¿›çˆ¶å…ƒç´     </span></span><br><span class="line">            api.insertBefore(parentEle, vnode.el, api.nextSibling(oEl)) </span><br><span class="line">            api.removeChild(parentEle, oldVnode.el)  <span class="comment">// ç§»é™¤ä»¥å‰çš„æ—§å…ƒç´ èŠ‚ç‚¹</span></span><br><span class="line">            oldVnode = <span class="literal">null</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// some code </span></span><br><span class="line">    <span class="keyword">return</span> vnode</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>patchå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°oldVnodeå’ŒVnodeåˆ†åˆ«ä»£è¡¨æ–°çš„èŠ‚ç‚¹å’Œä¹‹å‰çš„æ—§èŠ‚ç‚¹</p><p><em>åˆ¤æ–­ä¸¤èŠ‚ç‚¹æ˜¯å¦å€¼å¾—æ¯”è¾ƒï¼Œå€¼å¾—æ¯”è¾ƒåˆ™æ‰§è¡ŒpatchVnode</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sameVnode</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        a.key === b.key &amp;&amp;  <span class="comment">// keyå€¼</span></span><br><span class="line">        a.tag === b.tag &amp;&amp;  <span class="comment">// æ ‡ç­¾å</span></span><br><span class="line">        a.isComment === b.isComment &amp;&amp;  <span class="comment">// æ˜¯å¦ä¸ºæ³¨é‡ŠèŠ‚ç‚¹</span></span><br><span class="line">        <span class="comment">// æ˜¯å¦éƒ½å®šä¹‰äº†dataï¼ŒdataåŒ…å«ä¸€äº›å…·ä½“ä¿¡æ¯ï¼Œä¾‹å¦‚onclick , style</span></span><br><span class="line">        isDef(a.data) === isDef(b.data) &amp;&amp;  </span><br><span class="line">        sameInputType(a, b) <span class="comment">// å½“æ ‡ç­¾æ˜¯&lt;input&gt;çš„æ—¶å€™ï¼Œtypeå¿…é¡»ç›¸åŒ</span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><em>ä¸å€¼å¾—æ¯”è¾ƒåˆ™ç”¨Vnodeæ›¿æ¢oldVnode</em><br>å¦‚æœä¸¤ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆå°±æ·±å…¥æ£€æŸ¥ä»–ä»¬çš„å­èŠ‚ç‚¹ã€‚å¦‚æœä¸¤ä¸ªèŠ‚ç‚¹ä¸ä¸€æ ·é‚£å°±è¯´æ˜Vnodeå®Œå…¨è¢«æ”¹å˜äº†ï¼Œå°±å¯ä»¥ç›´æ¥æ›¿æ¢oldVnodeã€‚</p><p>è™½ç„¶è¿™ä¸¤ä¸ªèŠ‚ç‚¹ä¸ä¸€æ ·ä½†æ˜¯ä»–ä»¬çš„å­èŠ‚ç‚¹ä¸€æ ·æ€ä¹ˆåŠï¼Ÿåˆ«å¿˜äº†ï¼Œdiffå¯æ˜¯é€å±‚æ¯”è¾ƒçš„ï¼Œå¦‚æœç¬¬ä¸€å±‚ä¸ä¸€æ ·é‚£ä¹ˆå°±ä¸ä¼šç»§ç»­æ·±å…¥æ¯”è¾ƒç¬¬äºŒå±‚äº†ã€‚ï¼ˆæˆ‘åœ¨æƒ³è¿™ç®—æ˜¯ä¸€ä¸ªç¼ºç‚¹å—ï¼Ÿç›¸åŒå­èŠ‚ç‚¹ä¸èƒ½é‡å¤åˆ©ç”¨äº†â€¦å…¶å®æ²¡è¿™ä¹ˆç®€å•ï¼Œå®ƒåˆ©ç”¨é—­åŒ…æœ‰ä¸ªç¼“å­˜æœºåˆ¶ï¼‰</p><h1 id="patchVnode"><a href="#patchVnode" class="headerlink" title="patchVnode"></a>patchVnode</h1><p>å½“æˆ‘ä»¬ç¡®å®šä¸¤ä¸ªèŠ‚ç‚¹å€¼å¾—æ¯”è¾ƒä¹‹åæˆ‘ä»¬ä¼šå¯¹ä¸¤ä¸ªèŠ‚ç‚¹æŒ‡å®špatchVnodeæ–¹æ³•ã€‚é‚£ä¹ˆè¿™ä¸ªæ–¹æ³•åšäº†ä»€ä¹ˆå‘¢ï¼Ÿ<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">    patchVnode (oldVnode, vnode) &#123;</span><br><span class="line">    <span class="keyword">const</span> el = vnode.el = oldVnode.el</span><br><span class="line">    <span class="keyword">let</span> i, oldCh = oldVnode.children, ch = vnode.children</span><br><span class="line">    <span class="keyword">if</span> (oldVnode === vnode) <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">if</span> (oldVnode.text !== <span class="literal">null</span> &amp;&amp; vnode.text !== <span class="literal">null</span> &amp;&amp; oldVnode.text !== vnode.text) &#123;</span><br><span class="line">        api.setTextContent(el, vnode.text)</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        updateEle(el, vnode, oldVnode)</span><br><span class="line">        <span class="keyword">if</span> (oldCh &amp;&amp; ch &amp;&amp; oldCh !== ch) &#123;</span><br><span class="line">            updateChildren(el, oldCh, ch)</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (ch)&#123;</span><br><span class="line">            createEle(vnode) <span class="comment">//create el's children dom</span></span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (oldCh)&#123;</span><br><span class="line">            api.removeChildren(el)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªå‡½æ•°åšäº†ä»¥ä¸‹äº‹æƒ…ï¼š</p><p>æ‰¾åˆ°å¯¹åº”çš„çœŸå®domï¼Œç§°ä¸ºel<br>åˆ¤æ–­Vnodeå’ŒoldVnodeæ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœæ˜¯ï¼Œé‚£ä¹ˆç›´æ¥return<br>å¦‚æœä»–ä»¬éƒ½æœ‰æ–‡æœ¬èŠ‚ç‚¹å¹¶ä¸”ä¸ç›¸ç­‰ï¼Œé‚£ä¹ˆå°†elçš„æ–‡æœ¬èŠ‚ç‚¹è®¾ç½®ä¸ºVnodeçš„æ–‡æœ¬èŠ‚ç‚¹ã€‚<br>å¦‚æœoldVnodeæœ‰å­èŠ‚ç‚¹è€ŒVnodeæ²¡æœ‰ï¼Œåˆ™åˆ é™¤elçš„å­èŠ‚ç‚¹<br>å¦‚æœoldVnodeæ²¡æœ‰å­èŠ‚ç‚¹è€ŒVnodeæœ‰ï¼Œåˆ™å°†Vnodeçš„å­èŠ‚ç‚¹çœŸå®åŒ–ä¹‹åæ·»åŠ åˆ°el<br>å¦‚æœä¸¤è€…éƒ½æœ‰å­èŠ‚ç‚¹ï¼Œåˆ™æ‰§è¡ŒupdateChildrenå‡½æ•°æ¯”è¾ƒå­èŠ‚ç‚¹ï¼Œè¿™ä¸€æ­¥å¾ˆé‡è¦<br>å…¶ä»–å‡ ä¸ªç‚¹éƒ½å¾ˆå¥½ç†è§£ï¼Œæˆ‘ä»¬è¯¦ç»†æ¥è®²ä¸€ä¸‹updateChildren</p><h1 id="updateChildren"><a href="#updateChildren" class="headerlink" title="updateChildren"></a>updateChildren</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">    updateChildren (parentElm, oldCh, newCh) &#123;</span><br><span class="line">    <span class="keyword">let</span> oldStartIdx = <span class="number">0</span>, newStartIdx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">let</span> oldEndIdx = oldCh.length - <span class="number">1</span></span><br><span class="line">    <span class="keyword">let</span> oldStartVnode = oldCh[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">let</span> oldEndVnode = oldCh[oldEndIdx]</span><br><span class="line">    <span class="keyword">let</span> newEndIdx = newCh.length - <span class="number">1</span></span><br><span class="line">    <span class="keyword">let</span> newStartVnode = newCh[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">let</span> newEndVnode = newCh[newEndIdx]</span><br><span class="line">    <span class="keyword">let</span> oldKeyToIdx</span><br><span class="line">    <span class="keyword">let</span> idxInOld</span><br><span class="line">    <span class="keyword">let</span> elmToMove</span><br><span class="line">    <span class="keyword">let</span> before</span><br><span class="line">    <span class="keyword">while</span> (oldStartIdx &lt;= oldEndIdx &amp;&amp; newStartIdx &lt;= newEndIdx) &#123;</span><br><span class="line">        <span class="keyword">if</span> (oldStartVnode == <span class="literal">null</span>) &#123;   <span class="comment">// å¯¹äºvnode.keyçš„æ¯”è¾ƒï¼Œä¼šæŠŠoldVnode = null</span></span><br><span class="line">            oldStartVnode = oldCh[++oldStartIdx] </span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (oldEndVnode == <span class="literal">null</span>) &#123;</span><br><span class="line">            oldEndVnode = oldCh[--oldEndIdx]</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (newStartVnode == <span class="literal">null</span>) &#123;</span><br><span class="line">            newStartVnode = newCh[++newStartIdx]</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (newEndVnode == <span class="literal">null</span>) &#123;</span><br><span class="line">            newEndVnode = newCh[--newEndIdx]</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (sameVnode(oldStartVnode, newStartVnode)) &#123;</span><br><span class="line">            patchVnode(oldStartVnode, newStartVnode)</span><br><span class="line">            oldStartVnode = oldCh[++oldStartIdx]</span><br><span class="line">            newStartVnode = newCh[++newStartIdx]</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (sameVnode(oldEndVnode, newEndVnode)) &#123;</span><br><span class="line">            patchVnode(oldEndVnode, newEndVnode)</span><br><span class="line">            oldEndVnode = oldCh[--oldEndIdx]</span><br><span class="line">            newEndVnode = newCh[--newEndIdx]</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (sameVnode(oldStartVnode, newEndVnode)) &#123;</span><br><span class="line">            patchVnode(oldStartVnode, newEndVnode)</span><br><span class="line">            api.insertBefore(parentElm, oldStartVnode.el, api.nextSibling(oldEndVnode.el))</span><br><span class="line">            oldStartVnode = oldCh[++oldStartIdx]</span><br><span class="line">            newEndVnode = newCh[--newEndIdx]</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (sameVnode(oldEndVnode, newStartVnode)) &#123;</span><br><span class="line">            patchVnode(oldEndVnode, newStartVnode)</span><br><span class="line">            api.insertBefore(parentElm, oldEndVnode.el, oldStartVnode.el)</span><br><span class="line">            oldEndVnode = oldCh[--oldEndIdx]</span><br><span class="line">            newStartVnode = newCh[++newStartIdx]</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨keyæ—¶çš„æ¯”è¾ƒ</span></span><br><span class="line">            <span class="keyword">if</span> (oldKeyToIdx === <span class="literal">undefined</span>) &#123;</span><br><span class="line">                oldKeyToIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx) <span class="comment">// æœ‰keyç”Ÿæˆindexè¡¨</span></span><br><span class="line">            &#125;</span><br><span class="line">            idxInOld = oldKeyToIdx[newStartVnode.key]</span><br><span class="line">            <span class="keyword">if</span> (!idxInOld) &#123;</span><br><span class="line">                api.insertBefore(parentElm, createEle(newStartVnode).el, oldStartVnode.el)</span><br><span class="line">                newStartVnode = newCh[++newStartIdx]</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                elmToMove = oldCh[idxInOld]</span><br><span class="line">                <span class="keyword">if</span> (elmToMove.sel !== newStartVnode.sel) &#123;</span><br><span class="line">                    api.insertBefore(parentElm, createEle(newStartVnode).el, oldStartVnode.el)</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    patchVnode(elmToMove, newStartVnode)</span><br><span class="line">                    oldCh[idxInOld] = <span class="literal">null</span></span><br><span class="line">                    api.insertBefore(parentElm, elmToMove.el, oldStartVnode.el)</span><br><span class="line">                &#125;</span><br><span class="line">                newStartVnode = newCh[++newStartIdx]</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (oldStartIdx &gt; oldEndIdx) &#123;</span><br><span class="line">        before = newCh[newEndIdx + <span class="number">1</span>] == <span class="literal">null</span> ? <span class="literal">null</span> : newCh[newEndIdx + <span class="number">1</span>].el</span><br><span class="line">        addVnodes(parentElm, before, newCh, newStartIdx, newEndIdx)</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (newStartIdx &gt; newEndIdx) &#123;</span><br><span class="line">        removeVnodes(parentElm, oldCh, oldStartIdx, oldEndIdx)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…ˆè¯´ä¸€ä¸‹è¿™ä¸ªå‡½æ•°åšäº†ä»€ä¹ˆ</p><ul><li>å°†Vnodeçš„å­èŠ‚ç‚¹Vchå’ŒoldVnodeçš„å­èŠ‚ç‚¹oldChæå–å‡ºæ¥</li><li>oldChå’ŒvChå„æœ‰ä¸¤ä¸ªå¤´å°¾çš„å˜é‡StartIdxå’ŒEndIdxï¼Œå®ƒä»¬çš„2ä¸ªå˜é‡ç›¸äº’æ¯”è¾ƒï¼Œä¸€å…±æœ‰4ç§æ¯”è¾ƒæ–¹å¼ã€‚å¦‚æœ4ç§æ¯”è¾ƒéƒ½æ²¡åŒ¹é…ï¼Œå¦‚æœè®¾ç½®äº†keyï¼Œå°±ä¼šç”¨keyè¿›è¡Œæ¯”è¾ƒï¼Œåœ¨æ¯”è¾ƒçš„è¿‡ç¨‹ä¸­ï¼Œå˜é‡ä¼šå¾€ä¸­é—´é ï¼Œä¸€æ—¦StartIdx&gt;EndIdxè¡¨æ˜oldChå’ŒvChè‡³å°‘æœ‰ä¸€ä¸ªå·²ç»éå†å®Œäº†ï¼Œå°±ä¼šç»“æŸæ¯”è¾ƒã€‚</li></ul><h1 id="å›¾è§£updateChildren"><a href="#å›¾è§£updateChildren" class="headerlink" title="å›¾è§£updateChildren"></a>å›¾è§£updateChildren</h1><p>ç»ˆäºæ¥åˆ°äº†è¿™ä¸€éƒ¨åˆ†ï¼Œä¸Šé¢çš„æ€»ç»“ç›¸ä¿¡å¾ˆå¤šäººä¹Ÿçœ‹å¾—ä¸€è„¸æ‡µé€¼ï¼Œä¸‹é¢æˆ‘ä»¬å¥½å¥½è¯´é“è¯´é“ã€‚<br><img src="/img/updateChildren.png"><br>ç°åœ¨åˆ†åˆ«å¯¹oldSã€oldEã€Sã€Eä¸¤ä¸¤åšsameVnodeæ¯”è¾ƒï¼Œæœ‰å››ç§æ¯”è¾ƒæ–¹å¼ï¼Œå½“å…¶ä¸­ä¸¤ä¸ªèƒ½åŒ¹é…ä¸Šé‚£ä¹ˆçœŸå®domä¸­çš„ç›¸åº”èŠ‚ç‚¹ä¼šç§»åˆ°Vnodeç›¸åº”çš„ä½ç½®ï¼Œè¿™å¥è¯æœ‰ç‚¹ç»•ï¼Œæ‰“ä¸ªæ¯”æ–¹</p><ul><li>å¦‚æœæ˜¯oldSå’ŒEåŒ¹é…ä¸Šäº†ï¼Œé‚£ä¹ˆçœŸå®domä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¼šç§»åˆ°æœ€å</li><li>å¦‚æœæ˜¯oldEå’ŒSåŒ¹é…ä¸Šäº†ï¼Œé‚£ä¹ˆçœŸå®domä¸­çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹ä¼šç§»åˆ°æœ€å‰ï¼ŒåŒ¹é…ä¸Šçš„ä¸¤ä¸ªæŒ‡é’ˆå‘ä¸­é—´ç§»åŠ¨</li><li>å¦‚æœå››ç§åŒ¹é…æ²¡æœ‰ä¸€å¯¹æ˜¯æˆåŠŸçš„ï¼Œé‚£ä¹ˆéå†oldChildï¼ŒSæŒ¨ä¸ªå’Œä»–ä»¬åŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸå°±åœ¨çœŸå®domä¸­å°†æˆåŠŸçš„èŠ‚ç‚¹ç§»åˆ°æœ€å‰é¢ï¼Œå¦‚æœä¾æ—§æ²¡æœ‰æˆåŠŸçš„ï¼Œé‚£ä¹ˆå°†Så¯¹åº”çš„èŠ‚ç‚¹æ’å…¥åˆ°domä¸­å¯¹åº”çš„oldSä½ç½®ï¼ŒoldSå’ŒSæŒ‡é’ˆå‘ä¸­é—´ç§»åŠ¨ã€‚<br><img src="/img/sameVnode.png"></li></ul><p>ç¬¬ä¸€æ­¥</p><pre><code>oldS = a, oldE = dï¼›S = a, E = b;</code></pre><p>oldSå’ŒSåŒ¹é…ï¼Œåˆ™å°†domä¸­çš„aèŠ‚ç‚¹æ”¾åˆ°ç¬¬ä¸€ä¸ªï¼Œå·²ç»æ˜¯ç¬¬ä¸€ä¸ªäº†å°±ä¸ç®¡äº†ï¼Œæ­¤æ—¶domçš„ä½ç½®ä¸ºï¼ša b d<br>ç¬¬äºŒæ­¥</p><pre><code>oldS = b, oldE = dï¼›S = c, E = b;</code></pre><p>oldSå’ŒEåŒ¹é…ï¼Œå°±å°†åŸæœ¬çš„bèŠ‚ç‚¹ç§»åŠ¨åˆ°æœ€åï¼Œå› ä¸ºEæ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»–ä»¬ä½ç½®è¦ä¸€è‡´ï¼Œè¿™å°±æ˜¯ä¸Šé¢è¯´çš„ï¼šå½“å…¶ä¸­ä¸¤ä¸ªèƒ½åŒ¹é…ä¸Šé‚£ä¹ˆçœŸå®domä¸­çš„ç›¸åº”èŠ‚ç‚¹ä¼šç§»åˆ°Vnodeç›¸åº”çš„ä½ç½®ï¼Œæ­¤æ—¶domçš„ä½ç½®ä¸ºï¼ša d b<br>ç¬¬ä¸‰æ­¥</p><pre><code>oldS = d, oldE = dï¼›S = c, E = d;</code></pre><p>oldEå’ŒEåŒ¹é…ï¼Œä½ç½®ä¸å˜æ­¤æ—¶domçš„ä½ç½®ä¸ºï¼ša d b<br>ç¬¬å››æ­¥</p><pre><code>oldS++;oldE--;oldS &gt; oldE;</code></pre><p>éå†ç»“æŸï¼Œè¯´æ˜oldChå…ˆéå†å®Œã€‚å°±å°†å‰©ä½™çš„vChèŠ‚ç‚¹æ ¹æ®è‡ªå·±çš„çš„indexæ’å…¥åˆ°çœŸå®domä¸­å»ï¼Œæ­¤æ—¶domä½ç½®ä¸ºï¼ša c d b<br>ä¸€æ¬¡æ¨¡æ‹Ÿå®Œæˆã€‚<br>è¿™ä¸ªåŒ¹é…è¿‡ç¨‹çš„ç»“æŸæœ‰ä¸¤ä¸ªæ¡ä»¶ï¼š</p><ul><li>oldS &gt; oldEè¡¨ç¤ºoldChå…ˆéå†å®Œï¼Œé‚£ä¹ˆå°±å°†å¤šä½™çš„vChæ ¹æ®indexæ·»åŠ åˆ°domä¸­å»ï¼ˆå¦‚ä¸Šå›¾ï¼‰</li><li>S &gt; Eè¡¨ç¤ºvChå…ˆéå†å®Œï¼Œé‚£ä¹ˆå°±åœ¨çœŸå®domä¸­å°†åŒºé—´ä¸º[oldS, oldE]çš„å¤šä½™èŠ‚ç‚¹åˆ æ‰</li></ul><p><img src="/img/dom.png"></p><p>ä¸‹é¢å†ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå¯ä»¥åƒä¸Šé¢é‚£æ ·è‡ªå·±è¯•ç€æ¨¡æ‹Ÿä¸€ä¸‹<br><img src="/img/dom1.png"></p><p>å½“è¿™äº›èŠ‚ç‚¹sameVnodeæˆåŠŸåå°±ä¼šç´§æ¥ç€æ‰§è¡ŒpatchVnodeäº†ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ä¸Šé¢çš„ä»£ç <br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (sameVnode(oldStartVnode, newStartVnode)) &#123;</span><br><span class="line">    patchVnode(oldStartVnode, newStartVnode)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å°±è¿™æ ·å±‚å±‚é€’å½’ä¸‹å»ï¼Œç›´åˆ°å°†oldVnodeå’ŒVnodeä¸­çš„æ‰€æœ‰å­èŠ‚ç‚¹æ¯”å¯¹å®Œã€‚ä¹Ÿå°†domçš„æ‰€æœ‰è¡¥ä¸éƒ½æ‰“å¥½å•¦ã€‚é‚£ä¹ˆç°åœ¨å†å›è¿‡å»çœ‹updateChildrençš„ä»£ç ä¼šä¸ä¼šå®¹æ˜“å¾ˆå¤šå‘¢ï¼Ÿ</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;p&gt;&lt;a href=&quot;https://zhanghuaxiao.github.io/2019/01/30/vue-source-code/&quot;&gt;å¯ä»¥å…ˆçœ‹Vuejsè¿è¡Œæœºåˆ¶&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="web" scheme="https://zhanghuaxiao.github.io/categories/web/"/>
    
    
      <category term="vueçš„diffç®—æ³•" scheme="https://zhanghuaxiao.github.io/tags/vue%E7%9A%84diff%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>Vue.js å†…éƒ¨è¿è¡Œæœºåˆ¶</title>
    <link href="https://zhanghuaxiao.github.io/2019/01/30/vue-source-code/"/>
    <id>https://zhanghuaxiao.github.io/2019/01/30/vue-source-code/</id>
    <published>2019-01-30T03:37:58.000Z</published>
    <updated>2019-01-30T06:35:13.150Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>ç”Ÿæ´»çš„å…¨éƒ¨æ„ä¹‰åœ¨äºæ— ç©·åœ°æ¢ç´¢å°šæœªçŸ¥é“çš„ä¸œè¥¿ï¼Œåœ¨äºä¸æ–­åœ°å¢åŠ æ›´å¤šçš„çŸ¥è¯†ã€‚â€”â€”â€”â€”å·¦æ‹‰ </p></blockquote><p><img src="/img/curious.jpg"><br><a id="more"></a><br><a href="https://juejin.im/book/5a36661851882538e2259c0f/section/5a37bbb35188257d167a4d64" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p><h1 id="å…¨å±€æ¦‚è§ˆ"><a href="#å…¨å±€æ¦‚è§ˆ" class="headerlink" title="å…¨å±€æ¦‚è§ˆ"></a>å…¨å±€æ¦‚è§ˆ</h1><p>è¿™ä¸€èŠ‚ç¬”è€…å°†ä¸ºå¤§å®¶ä»‹ç»ä¸€ä¸‹ Vue.js å†…éƒ¨çš„æ•´ä¸ªæµç¨‹ï¼Œå¸Œæœ›èƒ½è®©å¤§å®¶å¯¹å…¨å±€æœ‰ä¸€ä¸ªæ•´ä½“çš„å°è±¡ï¼Œç„¶åæˆ‘ä»¬å†æ¥é€ä¸ªæ¨¡å—è¿›è¡Œè®²è§£ã€‚ä»æ¥æ²¡æœ‰äº†è§£è¿‡ Vue.js å®ç°çš„åŒå­¦å¯èƒ½ä¼šå¯¹ä¸€äº›å†…å®¹æ„Ÿåˆ°ç–‘æƒ‘ï¼Œè¿™æ˜¯å¾ˆæ­£å¸¸çš„ï¼Œè¿™ä¸€èŠ‚çš„ç›®çš„ä¸»è¦æ˜¯ä¸ºäº†è®©å¤§å®¶å¯¹æ•´ä¸ªæµç¨‹æœ‰ä¸€ä¸ªå¤§æ¦‚çš„è®¤è¯†ï¼Œç®—æ˜¯ä¸€ä¸ªæ¦‚è§ˆé¢„å¤‡çš„è¿‡ç¨‹ï¼Œå½“æŠŠæ•´æœ¬å°å†Œè®¤çœŸè¯»å®Œä»¥åï¼Œå†æ¥é˜…è¯»è¿™ä¸€èŠ‚ï¼Œç›¸ä¿¡ä¼šæœ‰æ”¶è·çš„ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ç¬”è€…ç”»çš„å†…éƒ¨æµç¨‹å›¾ã€‚<br><img src="/img/vuejsfrist.png" class="full-image"><br>å¤§å®¶ç¬¬ä¸€æ¬¡çœ‹åˆ°è¿™ä¸ªå›¾ä¸€å®šæ˜¯ä¸€å¤´é›¾æ°´çš„ï¼Œæ²¡æœ‰å…³ç³»ï¼Œæˆ‘ä»¬æ¥é€ä¸ªè®²ä¸€ä¸‹è¿™äº›æ¨¡å—çš„ä½œç”¨ä»¥åŠè°ƒç”¨å…³ç³»ã€‚ç›¸ä¿¡è®²å®Œä¹‹åå¤§å®¶å¯¹Vue.jså†…éƒ¨è¿è¡Œæœºåˆ¶ä¼šæœ‰ä¸€ä¸ªå¤§æ¦‚çš„è®¤è¯†ã€‚</p><h1 id="åˆå§‹åŒ–åŠæŒ‚è½½"><a href="#åˆå§‹åŒ–åŠæŒ‚è½½" class="headerlink" title="åˆå§‹åŒ–åŠæŒ‚è½½"></a>åˆå§‹åŒ–åŠæŒ‚è½½</h1><p><img src="/img/vuejs2.png" class="full-image"><br>åœ¨ new Vue() ä¹‹åã€‚ Vue ä¼šè°ƒç”¨ _init å‡½æ•°è¿›è¡Œåˆå§‹åŒ–ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œçš„ init è¿‡ç¨‹ï¼Œå®ƒä¼šåˆå§‹åŒ–ç”Ÿå‘½å‘¨æœŸã€äº‹ä»¶ã€ propsã€ methodsã€ dataã€ computed ä¸ watch ç­‰ã€‚å…¶ä¸­æœ€é‡è¦çš„æ˜¯é€šè¿‡ Object.defineProperty è®¾ç½® setter ä¸ getter å‡½æ•°ï¼Œç”¨æ¥å®ç°ã€Œå“åº”å¼ã€ä»¥åŠã€Œä¾èµ–æ”¶é›†ã€ï¼Œåé¢ä¼šè¯¦ç»†è®²åˆ°ï¼Œè¿™é‡Œåªè¦æœ‰ä¸€ä¸ªå°è±¡å³å¯ã€‚</p><p>åˆå§‹åŒ–ä¹‹åè°ƒç”¨ $mount ä¼šæŒ‚è½½ç»„ä»¶ï¼Œå¦‚æœæ˜¯è¿è¡Œæ—¶ç¼–è¯‘ï¼Œå³ä¸å­˜åœ¨ render function ä½†æ˜¯å­˜åœ¨ template çš„æƒ…å†µï¼Œéœ€è¦è¿›è¡Œã€Œç¼–è¯‘ã€æ­¥éª¤ã€‚</p><h1 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h1><p>compileç¼–è¯‘å¯ä»¥åˆ†æˆ parseã€optimize ä¸ generate ä¸‰ä¸ªé˜¶æ®µï¼Œæœ€ç»ˆéœ€è¦å¾—åˆ° render functionã€‚<br><img src="/img/vuejs3.png" class="full-image"></p><h2 id="parse"><a href="#parse" class="headerlink" title="parse"></a>parse</h2><p>parse ä¼šç”¨æ­£åˆ™ç­‰æ–¹å¼è§£æ template æ¨¡æ¿ä¸­çš„æŒ‡ä»¤ã€classã€styleç­‰æ•°æ®ï¼Œå½¢æˆASTã€‚</p><h2 id="optimize"><a href="#optimize" class="headerlink" title="optimize"></a>optimize</h2><p>optimize çš„ä¸»è¦ä½œç”¨æ˜¯æ ‡è®° static é™æ€èŠ‚ç‚¹ï¼Œè¿™æ˜¯ Vue åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­çš„ä¸€å¤„ä¼˜åŒ–ï¼Œåé¢å½“ update æ›´æ–°ç•Œé¢æ—¶ï¼Œä¼šæœ‰ä¸€ä¸ª patch çš„è¿‡ç¨‹ï¼Œ <a href="https://zhanghuaxiao.github.io/2019/01/30/vue-diffç®—æ³•/#more">diff</a> ç®—æ³•ä¼šç›´æ¥è·³è¿‡é™æ€èŠ‚ç‚¹ï¼Œä»è€Œå‡å°‘äº†æ¯”è¾ƒçš„è¿‡ç¨‹ï¼Œä¼˜åŒ–äº† patch çš„æ€§èƒ½ã€‚</p><h2 id="generate"><a href="#generate" class="headerlink" title="generate"></a>generate</h2><p>generate æ˜¯å°† AST è½¬åŒ–æˆ render function å­—ç¬¦ä¸²çš„è¿‡ç¨‹ï¼Œå¾—åˆ°ç»“æœæ˜¯ render çš„å­—ç¬¦ä¸²ä»¥åŠ staticRenderFns å­—ç¬¦ä¸²ã€‚</p><p>åœ¨ç»å†è¿‡ parseã€optimize ä¸ generate è¿™ä¸‰ä¸ªé˜¶æ®µä»¥åï¼Œç»„ä»¶ä¸­å°±ä¼šå­˜åœ¨æ¸²æŸ“ VNode æ‰€éœ€çš„ render function äº†ã€‚</p><h1 id="å“åº”å¼"><a href="#å“åº”å¼" class="headerlink" title="å“åº”å¼"></a>å“åº”å¼</h1><p>æ¥ä¸‹æ¥ä¹Ÿå°±æ˜¯ Vue.js å“åº”å¼æ ¸å¿ƒéƒ¨åˆ†ã€‚<br><img src="/img/vuejs4.png" class="full-image"></p><p>è¿™é‡Œçš„ getter è·Ÿ setter å·²ç»åœ¨ä¹‹å‰ä»‹ç»è¿‡äº†ï¼Œåœ¨ init çš„æ—¶å€™é€šè¿‡ Object.defineProperty è¿›è¡Œäº†ç»‘å®šï¼Œå®ƒä½¿å¾—å½“è¢«è®¾ç½®çš„å¯¹è±¡è¢«è¯»å–çš„æ—¶å€™ä¼šæ‰§è¡Œ getter å‡½æ•°ï¼Œè€Œåœ¨å½“è¢«èµ‹å€¼çš„æ—¶å€™ä¼šæ‰§è¡Œ setter å‡½æ•°ã€‚</p><p>å½“ render function è¢«æ¸²æŸ“çš„æ—¶å€™ï¼Œå› ä¸ºä¼šè¯»å–æ‰€éœ€å¯¹è±¡çš„å€¼ï¼Œæ‰€ä»¥ä¼šè§¦å‘ getter å‡½æ•°è¿›è¡Œã€Œä¾èµ–æ”¶é›†ã€ï¼Œã€Œä¾èµ–æ”¶é›†ã€çš„ç›®çš„æ˜¯å°†è§‚å¯Ÿè€… Watcher å¯¹è±¡å­˜æ”¾åˆ°å½“å‰é—­åŒ…ä¸­çš„è®¢é˜…è€… Dep çš„ subs ä¸­ã€‚å½¢æˆå¦‚ä¸‹æ‰€ç¤ºçš„è¿™æ ·ä¸€ä¸ªå…³ç³»ã€‚<br><img src="/img/vuejs5.png" class="full-image"></p><p>åœ¨ä¿®æ”¹å¯¹è±¡çš„å€¼çš„æ—¶å€™ï¼Œä¼šè§¦å‘å¯¹åº”çš„ setterï¼Œ setter é€šçŸ¥ä¹‹å‰ã€Œä¾èµ–æ”¶é›†ã€å¾—åˆ°çš„ Dep ä¸­çš„æ¯ä¸€ä¸ª Watcherï¼Œå‘Šè¯‰å®ƒä»¬è‡ªå·±çš„å€¼æ”¹å˜äº†ï¼Œéœ€è¦é‡æ–°æ¸²æŸ“è§†å›¾ã€‚è¿™æ—¶å€™è¿™äº› Watcher å°±ä¼šå¼€å§‹è°ƒç”¨ update æ¥æ›´æ–°è§†å›¾ï¼Œå½“ç„¶è¿™ä¸­é—´è¿˜æœ‰ä¸€ä¸ª patch çš„è¿‡ç¨‹ä»¥åŠä½¿ç”¨é˜Ÿåˆ—æ¥å¼‚æ­¥æ›´æ–°çš„ç­–ç•¥ï¼Œè¿™ä¸ªæˆ‘ä»¬åé¢å†è®²ã€‚</p><h1 id="Virtual-DOM"><a href="#Virtual-DOM" class="headerlink" title="Virtual DOM"></a>Virtual DOM</h1><p>æˆ‘ä»¬çŸ¥é“ï¼Œrender function ä¼šè¢«è½¬åŒ–æˆ VNode èŠ‚ç‚¹ã€‚Virtual DOM å…¶å®å°±æ˜¯ä¸€æ£µä»¥ JavaScript å¯¹è±¡ï¼ˆ VNode èŠ‚ç‚¹ï¼‰ä½œä¸ºåŸºç¡€çš„æ ‘ï¼Œç”¨å¯¹è±¡å±æ€§æ¥æè¿°èŠ‚ç‚¹ï¼Œå®é™…ä¸Šå®ƒåªæ˜¯ä¸€å±‚å¯¹çœŸå® DOM çš„æŠ½è±¡ã€‚æœ€ç»ˆå¯ä»¥é€šè¿‡ä¸€ç³»åˆ—æ“ä½œä½¿è¿™æ£µæ ‘æ˜ å°„åˆ°çœŸå®ç¯å¢ƒä¸Šã€‚ç”±äº Virtual DOM æ˜¯ä»¥ JavaScript å¯¹è±¡ä¸ºåŸºç¡€è€Œä¸ä¾èµ–çœŸå®å¹³å°ç¯å¢ƒï¼Œæ‰€ä»¥ä½¿å®ƒå…·æœ‰äº†è·¨å¹³å°çš„èƒ½åŠ›ï¼Œæ¯”å¦‚è¯´æµè§ˆå™¨å¹³å°ã€Weexã€Node ç­‰ã€‚</p><p>æ¯”å¦‚è¯´ä¸‹é¢è¿™æ ·ä¸€ä¸ªä¾‹å­ï¼š</p><pre><code>{    tag: &apos;div&apos;,                 /*è¯´æ˜è¿™æ˜¯ä¸€ä¸ªdivæ ‡ç­¾*/    children: [                 /*å­˜æ”¾è¯¥æ ‡ç­¾çš„å­èŠ‚ç‚¹*/        {            tag: &apos;a&apos;,           /*è¯´æ˜è¿™æ˜¯ä¸€ä¸ªaæ ‡ç­¾*/            text: &apos;click me&apos;    /*æ ‡ç­¾çš„å†…å®¹*/        }    ]}</code></pre><p>æ¸²æŸ“åå¯ä»¥å¾—åˆ°</p><pre><code>&lt;div&gt;    &lt;a&gt;click me&lt;/a&gt;&lt;/div&gt;</code></pre><p>è¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå®é™…ä¸Šçš„èŠ‚ç‚¹æœ‰æ›´å¤šçš„å±æ€§æ¥æ ‡å¿—èŠ‚ç‚¹ï¼Œæ¯”å¦‚ isStatic ï¼ˆä»£è¡¨æ˜¯å¦ä¸ºé™æ€èŠ‚ç‚¹ï¼‰ã€ isComment ï¼ˆä»£è¡¨æ˜¯å¦ä¸ºæ³¨é‡ŠèŠ‚ç‚¹ï¼‰ç­‰ã€‚</p><h1 id="æ›´æ–°è§†å›¾"><a href="#æ›´æ–°è§†å›¾" class="headerlink" title="æ›´æ–°è§†å›¾"></a>æ›´æ–°è§†å›¾</h1><p><img src="/img/vuejs6.png" class="full-image"><br>å‰é¢æˆ‘ä»¬è¯´åˆ°ï¼Œåœ¨ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡å€¼çš„æ—¶å€™ï¼Œä¼šé€šè¿‡ setter -&gt; Watcher -&gt; update çš„æµç¨‹æ¥ä¿®æ”¹å¯¹åº”çš„è§†å›¾ï¼Œé‚£ä¹ˆæœ€ç»ˆæ˜¯å¦‚ä½•æ›´æ–°è§†å›¾çš„å‘¢ï¼Ÿ</p><p>å½“æ•°æ®å˜åŒ–åï¼Œæ‰§è¡Œ render function å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ–°çš„ VNode èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¦‚æœæƒ³è¦å¾—åˆ°æ–°çš„è§†å›¾ï¼Œæœ€ç®€å•ç²—æš´çš„æ–¹æ³•å°±æ˜¯ç›´æ¥è§£æè¿™ä¸ªæ–°çš„ VNode èŠ‚ç‚¹ï¼Œç„¶åç”¨ innerHTML ç›´æ¥å…¨éƒ¨æ¸²æŸ“åˆ°çœŸå® DOM ä¸­ã€‚ä½†æ˜¯å…¶å®æˆ‘ä»¬åªå¯¹å…¶ä¸­çš„ä¸€å°å—å†…å®¹è¿›è¡Œäº†ä¿®æ”¹ï¼Œè¿™æ ·åšä¼¼ä¹æœ‰äº›ã€Œæµªè´¹ã€ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸èƒ½åªä¿®æ”¹é‚£äº›ã€Œæ”¹å˜äº†çš„åœ°æ–¹ã€å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å°±è¦ä»‹ç»æˆ‘ä»¬çš„ã€Œpatchã€äº†ã€‚æˆ‘ä»¬ä¼šå°†æ–°çš„ VNode ä¸æ—§çš„ VNode ä¸€èµ·ä¼ å…¥ patch è¿›è¡Œæ¯”è¾ƒï¼Œç»è¿‡ diff ç®—æ³•å¾—å‡ºå®ƒä»¬çš„ã€Œå·®å¼‚ã€ã€‚æœ€åæˆ‘ä»¬åªéœ€è¦å°†è¿™äº›ã€Œå·®å¼‚ã€çš„å¯¹åº” DOM è¿›è¡Œä¿®æ”¹å³å¯ã€‚</p><h1 id="å†çœ‹å…¨å±€"><a href="#å†çœ‹å…¨å±€" class="headerlink" title="å†çœ‹å…¨å±€"></a>å†çœ‹å…¨å±€</h1><p><img src="/img/vuejs7.png" class="full-image"><br>å›è¿‡å¤´å†æ¥çœ‹çœ‹è¿™å¼ å›¾ï¼Œæ˜¯ä¸æ˜¯å¤§è„‘ä¸­å·²ç»æœ‰ä¸€ä¸ªå¤§æ¦‚çš„è„‰ç»œäº†å‘¢ï¼Ÿ</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;p&gt;ç”Ÿæ´»çš„å…¨éƒ¨æ„ä¹‰åœ¨äºæ— ç©·åœ°æ¢ç´¢å°šæœªçŸ¥é“çš„ä¸œè¥¿ï¼Œåœ¨äºä¸æ–­åœ°å¢åŠ æ›´å¤šçš„çŸ¥è¯†ã€‚â€”â€”â€”â€”å·¦æ‹‰ &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;/img/curious.jpg&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="web" scheme="https://zhanghuaxiao.github.io/categories/web/"/>
    
    
      <category term="Vue.js å†…éƒ¨è¿è¡Œæœºåˆ¶" scheme="https://zhanghuaxiao.github.io/tags/Vue-js-%E5%86%85%E9%83%A8%E8%BF%90%E8%A1%8C%E6%9C%BA%E5%88%B6/"/>
    
      <category term="patch" scheme="https://zhanghuaxiao.github.io/tags/patch/"/>
    
      <category term="render function" scheme="https://zhanghuaxiao.github.io/tags/render-function/"/>
    
      <category term="diff" scheme="https://zhanghuaxiao.github.io/tags/diff/"/>
    
  </entry>
  
  <entry>
    <title>gulpå’ŒwebpackåŒºåˆ«</title>
    <link href="https://zhanghuaxiao.github.io/2019/01/29/gulp%E5%92%8Cwebpack%E5%8C%BA%E5%88%AB/"/>
    <id>https://zhanghuaxiao.github.io/2019/01/29/gulpå’ŒwebpackåŒºåˆ«/</id>
    <published>2019-01-29T01:48:44.000Z</published>
    <updated>2019-01-29T04:52:05.144Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>æˆ‘æ„¿åŒ–èº«çŸ³æ¡¥ï¼Œå—äº”ç™¾å¹´é£å¹ï¼Œäº”ç™¾å¹´æ—¥æ™’ï¼Œäº”ç™¾å¹´é›¨æ·‹ï¼Œåªæ±‚å¥¹ä»æ¡¥ä¸Šç»è¿‡</p></blockquote><a id="more"></a><blockquote><p><a href="https://www.cnblogs.com/lovesong/p/6413546.html" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p></blockquote><h1 id="gulp"><a href="#gulp" class="headerlink" title="gulp"></a>gulp</h1><p>gulpå¼ºè°ƒçš„æ˜¯å‰ç«¯å¼€å‘çš„å·¥ä½œæµç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®ä¸€ç³»åˆ—çš„taskï¼Œå®šä¹‰taskå¤„ç†çš„äº‹åŠ¡ï¼ˆä¾‹å¦‚æ–‡ä»¶å‹ç¼©åˆå¹¶ã€é›ªç¢§å›¾ã€å¯åŠ¨serverã€ç‰ˆæœ¬æ§åˆ¶ç­‰ï¼‰ï¼Œç„¶åå®šä¹‰æ‰§è¡Œé¡ºåºï¼Œæ¥è®©gulpæ‰§è¡Œè¿™äº›taskï¼Œä»è€Œæ„å»ºé¡¹ç›®çš„æ•´ä¸ªå‰ç«¯å¼€å‘æµç¨‹ã€‚</p><p>PSï¼šç®€å•è¯´å°±ä¸€ä¸ªTask Runner</p><h1 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h1><p>webpackæ˜¯ä¸€ä¸ªå‰ç«¯æ¨¡å—åŒ–æ–¹æ¡ˆï¼Œæ›´ä¾§é‡æ¨¡å—æ‰“åŒ…ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå¼€å‘ä¸­çš„æ‰€æœ‰èµ„æºï¼ˆå›¾ç‰‡ã€jsæ–‡ä»¶ã€cssæ–‡ä»¶ç­‰ï¼‰éƒ½çœ‹æˆæ¨¡å—ï¼Œé€šè¿‡loaderï¼ˆåŠ è½½å™¨ï¼‰å’Œpluginsï¼ˆæ’ä»¶ï¼‰å¯¹èµ„æºè¿›è¡Œå¤„ç†ï¼Œæ‰“åŒ…æˆç¬¦åˆç”Ÿäº§ç¯å¢ƒéƒ¨ç½²çš„å‰ç«¯èµ„æºã€‚<br>PSï¼šwebpack is a module bundle</p><h1 id="ç›¸åŒåŠŸèƒ½"><a href="#ç›¸åŒåŠŸèƒ½" class="headerlink" title="ç›¸åŒåŠŸèƒ½"></a>ç›¸åŒåŠŸèƒ½</h1><p>gulpä¸webpackå¯ä»¥å®ç°ä¸€äº›ç›¸åŒåŠŸèƒ½ï¼Œå¦‚ä¸‹ï¼ˆåˆ—ä¸¾éƒ¨åˆ†ï¼‰ï¼š</p><table><thead><tr><th>åŠŸèƒ½</th><th style="text-align:center">gulp</th><th style="text-align:right">webpack</th></tr></thead><tbody><tr><td>æ–‡ä»¶åˆå¹¶ä¸å‹ç¼©ï¼ˆcssï¼‰</td><td style="text-align:center">ä½¿ç”¨gulp-minify-cssæ¨¡å—</td><td style="text-align:right">æ ·å¼åˆå¹¶ä¸€èˆ¬ç”¨åˆ°extract-text-webpack-pluginæ’ä»¶å‹ç¼©åˆ™ä½¿ç”¨webpack.optimize.UglifyJsPlugin</td></tr><tr><td>æ–‡ä»¶åˆå¹¶ä¸å‹ç¼©ï¼ˆjsï¼‰</td><td style="text-align:center">ä½¿ç”¨gulp-uglifyå’Œgulp-concatä¸¤ä¸ªæ¨¡å—</td><td style="text-align:right">jsåˆå¹¶åœ¨æ¨¡å—åŒ–å¼€å§‹å°±å·²ç»åš,å‹ç¼©åˆ™ä½¿ç”¨webpack.optimize.UglifyJsPlugin </td></tr><tr><td>sass/lessé¢„ç¼–è¯‘</td><td style="text-align:center">ä½¿ç”¨gulp-sass/gulp-less æ¨¡å—</td><td style="text-align:right">sass-loader/less-loader è¿›è¡Œé¢„å¤„ç† </td></tr><tr><td>å¯åŠ¨server</td><td style="text-align:center">ä½¿ç”¨gulp-webserveræ¨¡å—</td><td style="text-align:right">ä½¿ç”¨webpack-dev-serveræ¨¡å—</td></tr><tr><td>ç‰ˆæœ¬æ§åˆ¶</td><td style="text-align:center">ä½¿ç”¨gulp-revå’Œgulp-rev-collectorä¸¤ä¸ªæ¨¡å—</td><td style="text-align:right">å°†ç”Ÿæˆæ–‡ä»¶åŠ ä¸Šhashå€¼ module.exports = {plugins:[new ExtractTextPlugin(style.[hash].cssâ€)}</td></tr></tbody></table><h1 id="ä¸¤è€…åŒºåˆ«"><a href="#ä¸¤è€…åŒºåˆ«" class="headerlink" title="ä¸¤è€…åŒºåˆ«"></a>ä¸¤è€…åŒºåˆ«</h1><ul><li>è™½ç„¶éƒ½æ˜¯å‰ç«¯è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ï¼Œä½†çœ‹ä»–ä»¬çš„å®šä½å°±çŸ¥é“ä¸æ˜¯å¯¹ç­‰çš„ã€‚</li><li>gulpä¸¥æ ¼ä¸Šè®²ï¼Œæ¨¡å—åŒ–ä¸æ˜¯ä»–å¼ºè°ƒçš„ä¸œè¥¿ï¼Œä»–æ—¨åœ¨è§„èŒƒå‰ç«¯å¼€å‘æµç¨‹ã€‚</li><li>webpackæ›´æ˜¯æ˜æ˜¾å¼ºè°ƒæ¨¡å—åŒ–å¼€å‘ï¼Œè€Œé‚£äº›æ–‡ä»¶å‹ç¼©åˆå¹¶ã€é¢„å¤„ç†ç­‰åŠŸèƒ½ï¼Œä¸è¿‡æ˜¯ä»–é™„å¸¦çš„åŠŸèƒ½ã€‚</li></ul><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><ul><li>gulpåº”è¯¥ä¸gruntæ¯”è¾ƒï¼Œè€Œwebpackåº”è¯¥ä¸browserifyï¼ˆç½‘ä¸Šå¤ªå¤šèµ„æ–™å°±è¿™ä¹ˆè¯´ï¼Œè¿™ä¹ˆè¯´æ˜¯æ²¡æœ‰é”™ï¼Œä¸è¿‡å•å•è¿™æ ·ä¸€å¥è¯å¹¶ä¸èƒ½è®©äººæ¸…æ™°æ˜äº†ï¼‰ã€‚</li><li>gulpä¸webpackä¸Šæ˜¯äº’è¡¥çš„ï¼Œè¿˜æ˜¯å¯æ›¿æ¢çš„ï¼Œå–å†³äºä½ é¡¹ç›®çš„éœ€æ±‚ã€‚å¦‚æœåªæ˜¯ä¸ªvueæˆ–reactçš„å•é¡µåº”ç”¨ï¼Œwebpackä¹Ÿå°±å¤Ÿç”¨ï¼›å¦‚æœwebpackæŸäº›åŠŸèƒ½ä½¿ç”¨èµ·æ¥éº»çƒ¦ç”šè‡³æ²¡æœ‰ï¼ˆé›ªç¢§å›¾å°±æ²¡æœ‰ï¼‰ï¼Œé‚£å°±å¯ä»¥ç»“åˆgulpä¸€èµ·ç”¨ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;p&gt;æˆ‘æ„¿åŒ–èº«çŸ³æ¡¥ï¼Œå—äº”ç™¾å¹´é£å¹ï¼Œäº”ç™¾å¹´æ—¥æ™’ï¼Œäº”ç™¾å¹´é›¨æ·‹ï¼Œåªæ±‚å¥¹ä»æ¡¥ä¸Šç»è¿‡&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="web" scheme="https://zhanghuaxiao.github.io/categories/web/"/>
    
    
      <category term="gulpå’ŒwebpackåŒºåˆ«" scheme="https://zhanghuaxiao.github.io/tags/gulp%E5%92%8Cwebpack%E5%8C%BA%E5%88%AB/"/>
    
  </entry>
  
  <entry>
    <title>jsæ¨¡å—åŒ–ç¼–ç¨‹å¼„æ‡‚CommonJSå’ŒAMD/CMDï¼</title>
    <link href="https://zhanghuaxiao.github.io/2019/01/28/CommonJs-AMD-CMD/"/>
    <id>https://zhanghuaxiao.github.io/2019/01/28/CommonJs-AMD-CMD/</id>
    <published>2019-01-28T03:40:04.000Z</published>
    <updated>2019-01-28T09:14:51.603Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>ä¸ºä»€ä¹ˆæ¨¡å—å¾ˆé‡è¦ï¼Ÿ </p></blockquote><p>å› ä¸ºæœ‰äº†æ¨¡å—ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ›´æ–¹ä¾¿åœ°ä½¿ç”¨åˆ«äººçš„ä»£ç ï¼Œæƒ³è¦ä»€ä¹ˆåŠŸèƒ½ï¼Œå°±åŠ è½½ä»€ä¹ˆæ¨¡å—ã€‚<br>ä½†æ˜¯ï¼Œè¿™æ ·åšæœ‰ä¸€ä¸ªå‰æï¼Œé‚£å°±æ˜¯å¤§å®¶å¿…é¡»ä»¥åŒæ ·çš„æ–¹å¼ç¼–å†™æ¨¡å—ï¼Œå¦åˆ™ä½ æœ‰ä½ çš„å†™æ³•ï¼Œæˆ‘æœ‰æˆ‘çš„å†™æ³•ï¼Œå²‚ä¸æ˜¯ä¹±äº†å¥—ï¼<br><a id="more"></a></p><blockquote><p><a href="https://www.cnblogs.com/chenguangliang/p/5856701.html" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a></p></blockquote><h1 id="CommonJS"><a href="#CommonJS" class="headerlink" title="CommonJS"></a>CommonJS</h1><p>   ä¸€å¼€å§‹å¤§å®¶éƒ½è®¤ä¸ºJSæ˜¯è¾£é¸¡ï¼Œæ²¡ä»€ä¹ˆç”¨ï¼Œå®˜æ–¹å®šä¹‰çš„APIåªèƒ½æ„å»ºåŸºäºæµè§ˆå™¨çš„åº”ç”¨ç¨‹åºï¼Œé€—æˆ‘å‘¢ï¼Œè¿™å¤ªç‹­éš˜äº†å§(ç”¨äº†ä¸ªé«˜ç«¯è¯ï¼Œå˜å˜)ï¼ŒCommonJSå°±æŒ‰è€ä¸ä½äº†ï¼ŒCommonJS APIå®šä¹‰å¾ˆå¤šæ™®é€šåº”ç”¨ç¨‹åºï¼ˆä¸»è¦æŒ‡éæµè§ˆå™¨çš„åº”ç”¨ï¼‰ä½¿ç”¨çš„APIï¼Œä»è€Œå¡«è¡¥äº†è¿™ä¸ªç©ºç™½ã€‚å®ƒçš„ç»ˆæç›®æ ‡æ˜¯æä¾›ä¸€ä¸ªç±»ä¼¼Pythonï¼ŒRubyå’ŒJavaæ ‡å‡†åº“ã€‚è¿™æ ·çš„è¯ï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨CommonJS APIç¼–å†™åº”ç”¨ç¨‹åºï¼Œç„¶åè¿™äº›åº”ç”¨å¯ä»¥è¿è¡Œåœ¨ä¸åŒçš„JavaScriptè§£é‡Šå™¨å’Œä¸åŒçš„ä¸»æœºç¯å¢ƒä¸­ã€‚<br>åœ¨å…¼å®¹CommonJSçš„ç³»ç»Ÿä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨JavaScriptå¼€å‘ä»¥ä¸‹ç¨‹åºï¼š</p><p>(1).æœåŠ¡å™¨ç«¯JavaScriptåº”ç”¨ç¨‹åº<br>(2).å‘½ä»¤è¡Œå·¥å…·<br>(3).å›¾å½¢ç•Œé¢åº”ç”¨ç¨‹åº<br>(4).æ··åˆåº”ç”¨ç¨‹åºï¼ˆå¦‚ï¼ŒTitaniumæˆ–Adobe AIRï¼‰</p><p>2009å¹´ï¼Œç¾å›½ç¨‹åºå‘˜Ryan Dahlåˆ›é€ äº†node.jsé¡¹ç›®ï¼Œå°†javascriptè¯­è¨€ç”¨äºæœåŠ¡å™¨ç«¯ç¼–ç¨‹ã€‚è¿™æ ‡å¿—â€Javascriptæ¨¡å—åŒ–ç¼–ç¨‹â€æ­£å¼è¯ç”Ÿã€‚å› ä¸ºè€å®è¯´ï¼Œåœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹ï¼Œæ²¡æœ‰æ¨¡å—ä¹Ÿä¸æ˜¯ç‰¹åˆ«å¤§çš„é—®é¢˜ï¼Œæ¯•ç«Ÿç½‘é¡µç¨‹åºçš„å¤æ‚æ€§æœ‰é™ï¼›ä½†æ˜¯åœ¨æœåŠ¡å™¨ç«¯ï¼Œä¸€å®šè¦æœ‰æ¨¡å—ï¼Œä¸æ“ä½œç³»ç»Ÿå’Œå…¶ä»–åº”ç”¨ç¨‹åºäº’åŠ¨ï¼Œå¦åˆ™æ ¹æœ¬æ²¡æ³•ç¼–ç¨‹ã€‚NodeJSæ˜¯CommonJSè§„èŒƒçš„å®ç°ï¼Œwebpack ä¹Ÿæ˜¯ä»¥CommonJSçš„å½¢å¼æ¥ä¹¦å†™ã€‚</p><p>node.jsçš„<a href="https://nodejs.org/docs/latest/api/modules.html" target="_blank" rel="noopener">æ¨¡å—ç³»ç»Ÿ</a>ï¼Œå°±æ˜¯å‚ç…§<a href="http://wiki.commonjs.org/wiki/Modules/1.1" target="_blank" rel="noopener">CommonJS</a>è§„èŒƒå®ç°çš„ã€‚åœ¨CommonJSä¸­ï¼Œæœ‰ä¸€ä¸ªå…¨å±€æ€§æ–¹æ³•require()ï¼Œç”¨äºåŠ è½½æ¨¡å—ã€‚å‡å®šæœ‰ä¸€ä¸ªæ•°å­¦æ¨¡å—math.jsï¼Œå°±å¯ä»¥åƒä¸‹é¢è¿™æ ·åŠ è½½ã€‚</p><p>var math = require(â€˜mathâ€™);</p><p>ç„¶åï¼Œå°±å¯ä»¥è°ƒç”¨æ¨¡å—æä¾›çš„æ–¹æ³•ï¼š</p><p>ã€€ã€€var math = require(â€˜mathâ€™);</p><pre><code>math.add(2,3); // 5</code></pre><p>CommonJSå®šä¹‰çš„æ¨¡å—åˆ†ä¸º:{æ¨¡å—å¼•ç”¨(require)} {æ¨¡å—å®šä¹‰(exports)} {æ¨¡å—æ ‡è¯†(module)}</p><p>require()ç”¨æ¥å¼•å…¥å¤–éƒ¨æ¨¡å—ï¼›exportså¯¹è±¡ç”¨äºå¯¼å‡ºå½“å‰æ¨¡å—çš„æ–¹æ³•æˆ–å˜é‡ï¼Œå”¯ä¸€çš„å¯¼å‡ºå£ï¼›moduleå¯¹è±¡å°±ä»£è¡¨æ¨¡å—æœ¬èº«ã€‚</p><p>è™½è¯´Nodeéµå¾ªCommonJSçš„è§„èŒƒï¼Œä½†æ˜¯ç›¸æ¯”ä¹Ÿæ˜¯åšäº†ä¸€äº›å–èˆï¼Œå¡«äº†ä¸€äº›æ–°ä¸œè¥¿çš„ã€‚</p><p>ä¸è¿‡ï¼Œè¯´äº†CommonJSä¹Ÿè¯´äº†Nodeï¼Œé‚£ä¹ˆæˆ‘è§‰å¾—ä¹Ÿå¾—å…ˆäº†è§£ä¸‹NPMäº†ã€‚NPMä½œä¸ºNodeçš„åŒ…ç®¡ç†å™¨ï¼Œä¸æ˜¯ä¸ºäº†å¸®åŠ©Nodeè§£å†³ä¾èµ–åŒ…çš„å®‰è£…é—®é¢˜å˜›ï¼Œé‚£å®ƒè‚¯å®šä¹Ÿè¦éµå¾ªCommonJSè§„èŒƒå•¦ï¼Œå®ƒéµå¾ªåŒ…è§„èŒƒï¼ˆè¿˜æ˜¯ç†è®ºï¼‰çš„ã€‚CommonJS WIKIè®²äº†å®ƒçš„å†å²ï¼Œè¿˜ä»‹ç»äº†moduleså’Œpackagesç­‰ã€‚</p><p>ä¸‹é¢è®²è®²commonJSçš„åŸç†ä»¥åŠç®€æ˜“å®ç°ï¼š</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a><font color="#0099ff" size="3" face="é»‘ä½“">åŸç†</font></h2><p>æµè§ˆå™¨ä¸æ”¯æŒCommonJSåŸå› ï¼Œåœ¨äºç¼ºå°‘å››ä¸ªNode.jsç¯å¢ƒå˜é‡</p><blockquote><ul><li>module</li><li>exports</li><li>require</li><li>global<br>åªè¦èƒ½æä¾›è¿™4ä¸ªå˜é‡ï¼Œæµè§ˆå™¨å°±èƒ½åŠ è½½CommonJSæ¨¡å—<br>ä¸‹é¢ä¸€ä¸ªç®€å•ç¤ºä¾‹</li></ul></blockquote><pre><code>var module = {    exports : {}};(function(module,exports){    exports.multiply = function(n){return n*100}}(module,module.exports))var f = module.exports.multiply;f(5) // 500</code></pre><p>ä¸Šé¢ä»£ç å‘ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°æä¾› module å’Œ exports ä¸¤ä¸ªå¤–éƒ¨å˜é‡ï¼Œæ¨¡å—å°±æ”¾åœ¨è¿™ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°é‡Œé¢ã€‚æ¨¡å—çš„è¾“å‡ºå€¼æ”¾åœ¨ module.exports ä¹‹ä¸­ï¼Œè¿™æ ·å°±å®ç°äº†æ¨¡å—çš„åŠ è½½ã€‚</p><h2 id="Browserify-çš„å®ç°"><a href="#Browserify-çš„å®ç°" class="headerlink" title="Browserify çš„å®ç°"></a><font color="#0099ff" size="3" face="é»‘ä½“">Browserify çš„å®ç°</font></h2><p>çŸ¥é“äº†åŸç†ï¼Œå°±èƒ½åšå‡ºå·¥å…·äº†ã€‚<a href="http://browserify.org/" target="_blank" rel="noopener">Browserify</a> æ˜¯ç›®å‰æœ€å¸¸ç”¨çš„ CommonJS æ ¼å¼è½¬æ¢çš„å·¥å…·ã€‚</p><p>è¯·çœ‹ä¸€ä¸ªä¾‹å­ï¼Œmain.js æ¨¡å—åŠ è½½ foo.js æ¨¡å—ã€‚<br>    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// foo.js</span><br><span class="line">module.exports = function(x) &#123;</span><br><span class="line">console.log(x);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// main.js</span><br><span class="line">var foo = require(&quot;./foo&quot;);</span><br><span class="line">foo(&quot;Hi&quot;);</span><br></pre></td></tr></table></figure></p><pre><code>ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼Œå°±èƒ½å°†main.jsè½¬ä¸ºæµè§ˆå™¨å¯ç”¨çš„æ ¼å¼ã€‚</code></pre><p>$ browserify main.js &gt; compiled.js<br>Browserifyåˆ°åº•åšäº†ä»€ä¹ˆï¼Ÿå®‰è£…ä¸€ä¸‹browser-unpackï¼Œå°±èƒ½çœ‹æ¸…æ¥šäº†ã€‚<br>$ npm install browser-unpack -g<br>ç„¶åï¼Œå°†å‰é¢ç”Ÿæˆçš„compile.jsè§£åŒ…ã€‚<br>    $ browser-unpack &lt; compiled.js<br>    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;id&quot;:1,</span><br><span class="line">        &quot;source&quot;:&quot;module.exports = function(x) &#123;\n  console.log(x);\n&#125;;&quot;,</span><br><span class="line">        &quot;deps&quot;:&#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;id&quot;:2,</span><br><span class="line">        &quot;source&quot;:&quot;var foo = require(\&quot;./foo\&quot;);\nfoo(\&quot;Hi\&quot;);&quot;,</span><br><span class="line">        &quot;deps&quot;:&#123;&quot;./foo&quot;:1&#125;,</span><br><span class="line">        &quot;entry&quot;:true</span><br><span class="line">    &#125;</span><br><span class="line">] </span><br></pre></td></tr></table></figure><br>å¯ä»¥çœ‹åˆ°ï¼Œbrowerify å°†æ‰€æœ‰æ¨¡å—æ”¾å…¥ä¸€ä¸ªæ•°ç»„ï¼Œid å±æ€§æ˜¯æ¨¡å—çš„ç¼–å·ï¼Œsource å±æ€§æ˜¯æ¨¡å—çš„æºç ï¼Œdeps å±æ€§æ˜¯æ¨¡å—çš„ä¾èµ–ã€‚</p><p>å› ä¸ºmain.jsåŠ è½½äº†foo.js,æ‰€ä»¥depså±æ€§å°±æŒ‡å®š./fooå¯¹åº”1å·æ¨¡å—ã€‚æ‰§è¡Œæ—¶å€™ï¼Œæµè§ˆå™¨é‡åˆ°require(./foo)è¯­å¥ï¼Œå°±è‡ªåŠ¨æ‰§è¡Œ1å¥½æ¨¡å—çš„sourceå±æ€§ï¼Œå¹¶å°†æ‰§è¡Œåmodule.exportså±æ€§å€¼è¾“å‡º   </p><h2 id="Tiny-Browser-Require"><a href="#Tiny-Browser-Require" class="headerlink" title="Tiny Browser Require"></a><font color="#0099ff" size="3" face="é»‘ä½“">Tiny Browser Require</font></h2><p>è™½ç„¶ Browserify å¾ˆå¼ºå¤§ï¼Œä½†ä¸èƒ½åœ¨æµè§ˆå™¨é‡Œæ“ä½œï¼Œæœ‰æ—¶å°±å¾ˆä¸æ–¹ä¾¿ã€‚<br>æˆ‘æ ¹æ® <a href="https://github.com/mochajs/mocha" target="_blank" rel="noopener">mocha</a> çš„å†…éƒ¨å®ç°ï¼Œåšäº†ä¸€ä¸ªçº¯æµè§ˆå™¨çš„ CommonJS æ¨¡å—åŠ è½½å™¨ <a href="https://github.com/ruanyf/tiny-browser-require" target="_blank" rel="noopener">tiny-browser-require</a> ã€‚å®Œå…¨ä¸éœ€è¦å‘½ä»¤è¡Œï¼Œç›´æ¥æ”¾è¿›æµè§ˆå™¨å³å¯ï¼Œæ‰€æœ‰ä»£ç åªæœ‰30å¤šè¡Œã€‚</p><p>å®ƒçš„é€»è¾‘éå¸¸ç®€å•ï¼Œå°±æ˜¯æŠŠæ¨¡å—è¯»å…¥æ•°ç»„ï¼ŒåŠ è½½è·¯å¾„å°±æ˜¯æ¨¡å—çš„idã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">  function require(p)&#123;</span><br><span class="line">  var path = require.resolve(p); //node.jsè¯­æ³•åŠ è½½å½“å‰æ¨¡å—ç›®å½•ä¸‹çš„ç»å¯¹è·¯å¾„</span><br><span class="line">  var mod = require.modules[path];</span><br><span class="line">  if (!mod) throw new Error(&apos;failed to require &quot;&apos; + p + &apos;&quot;&apos;);</span><br><span class="line">  if (!mod.exports) &#123;</span><br><span class="line">    mod.exports = &#123;&#125;;</span><br><span class="line">    mod.call(mod.exports, mod, mod.exports, require.relative(path));</span><br><span class="line">  &#125;</span><br><span class="line">  return mod.exports;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">require.modules = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">require.resolve = function (path)&#123;</span><br><span class="line">  var orig = path;</span><br><span class="line">  var reg = path + &apos;.js&apos;;</span><br><span class="line">  var index = path + &apos;/index.js&apos;;</span><br><span class="line">  return require.modules[reg] &amp;&amp; reg</span><br><span class="line">    || require.modules[index] &amp;&amp; index</span><br><span class="line">    || orig;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">require.register = function (path, fn)&#123;</span><br><span class="line">  require.modules[path] = fn;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">require.relative = function (parent) &#123;</span><br><span class="line">  return function(p)&#123;</span><br><span class="line">    if (&apos;.&apos; != p.charAt(0)) return require(p);</span><br><span class="line">    var path = parent.split(&apos;/&apos;);</span><br><span class="line">    var segs = p.split(&apos;/&apos;);</span><br><span class="line">    path.pop();</span><br><span class="line"></span><br><span class="line">    for (var i = 0; i &lt; segs.length; i++) &#123;</span><br><span class="line">      var seg = segs[i];</span><br><span class="line">      if (&apos;..&apos; == seg) path.pop();</span><br><span class="line">      else if (&apos;.&apos; != seg) path.push(seg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return require(path.join(&apos;/&apos;));</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><br>ä½¿ç”¨çš„æ—¶å€™ï¼Œå…ˆå°†ä¸Šé¢çš„ä»£ç æ”¾å…¥é¡µé¢ã€‚ç„¶åï¼Œå°†æ¨¡å—æ”¾åœ¨å¦‚ä¸‹çš„ç«‹å³æ‰§è¡Œå‡½æ•°é‡Œé¢ï¼Œå°±å¯ä»¥è°ƒç”¨äº†ã€‚</p><pre><code>&lt;script src=&quot;require.js&quot; /&gt;&lt;script&gt;    require.register(&quot;moduleId&quot;, function(module, exports, require){    // Module code goes here    });    var result = require(&quot;moduleId&quot;);&lt;/script&gt;</code></pre><p>è¿˜æ˜¯ä»¥å‰é¢çš„ main.js åŠ è½½ foo.js ä¸ºä¾‹ã€‚</p><pre><code>require.register(&quot;./foo.js&quot;, function(module, exports, require){module.exports = function(x) {    console.log(x);    };});var foo = require(&quot;./foo.js&quot;);foo(&quot;Hi&quot;);</code></pre><p>æ³¨æ„ï¼Œè¿™ä¸ªåº“åªæ¨¡æ‹Ÿäº† require ã€module ã€exports ä¸‰ä¸ªå˜é‡ï¼Œå¦‚æœæ¨¡å—è¿˜ç”¨åˆ°äº† global æˆ–è€…å…¶ä»– Node ä¸“æœ‰å˜é‡ï¼ˆæ¯”å¦‚ processï¼‰ï¼Œå°±é€šè¿‡ç«‹å³æ‰§è¡Œå‡½æ•°æä¾›å³å¯ã€‚</p><h1 id="AMD"><a href="#AMD" class="headerlink" title="AMD"></a>AMD</h1><p>åŸºäºcommonJSè§„èŒƒçš„nodeJSå‡ºæ¥ä»¥åï¼ŒæœåŠ¡ç«¯çš„æ¨¡å—æ¦‚å¿µå·²ç»å½¢æˆï¼Œå¾ˆè‡ªç„¶åœ°ï¼Œå¤§å®¶å°±æƒ³è¦å®¢æˆ·ç«¯æ¨¡å—ã€‚è€Œä¸”æœ€å¥½ä¸¤è€…èƒ½å¤Ÿå…¼å®¹ï¼Œä¸€ä¸ªæ¨¡å—ä¸ç”¨ä¿®æ”¹ï¼Œåœ¨æœåŠ¡å™¨å’Œæµè§ˆå™¨éƒ½å¯ä»¥è¿è¡Œã€‚ä½†æ˜¯ï¼Œç”±äºä¸€ä¸ªé‡å¤§çš„å±€é™ï¼Œä½¿å¾—CommonJSè§„èŒƒä¸é€‚ç”¨äºæµè§ˆå™¨ç¯å¢ƒã€‚è¿˜æ˜¯ä¸Šé¢çš„ä»£ç ï¼Œå¦‚æœåœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œä¼šæœ‰ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œä½ èƒ½çœ‹å‡ºæ¥å—ï¼Ÿ</p><blockquote><p>var math = require(â€˜mathâ€™);<br>math.add(2, 3);</p></blockquote><p>ç¬¬äºŒè¡Œmath.add(2, 3)ï¼Œåœ¨ç¬¬ä¸€è¡Œrequire(â€˜mathâ€™)ä¹‹åè¿è¡Œï¼Œå› æ­¤å¿…é¡»ç­‰math.jsåŠ è½½å®Œæˆã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœåŠ è½½æ—¶é—´å¾ˆé•¿ï¼Œæ•´ä¸ªåº”ç”¨å°±ä¼šåœåœ¨é‚£é‡Œç­‰ã€‚<font color="red">æ‚¨ä¼šæ³¨æ„åˆ° require æ˜¯åŒæ­¥çš„ã€‚</font></p><p>è¿™å¯¹æœåŠ¡å™¨ç«¯ä¸æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºæ‰€æœ‰çš„æ¨¡å—éƒ½å­˜æ”¾åœ¨æœ¬åœ°ç¡¬ç›˜ï¼Œå¯ä»¥åŒæ­¥åŠ è½½å®Œæˆï¼Œç­‰å¾…æ—¶é—´å°±æ˜¯ç¡¬ç›˜çš„è¯»å–æ—¶é—´ã€‚ä½†æ˜¯ï¼Œå¯¹äºæµè§ˆå™¨ï¼Œè¿™å´æ˜¯ä¸€ä¸ªå¤§é—®é¢˜ï¼Œå› ä¸ºæ¨¡å—éƒ½æ”¾åœ¨æœåŠ¡å™¨ç«¯ï¼Œç­‰å¾…æ—¶é—´å–å†³äºç½‘é€Ÿçš„å¿«æ…¢ï¼Œå¯èƒ½è¦ç­‰å¾ˆé•¿æ—¶é—´ï¼Œæµè§ˆå™¨å¤„äºâ€å‡æ­»â€çŠ¶æ€ã€‚</p><p>å› æ­¤ï¼Œæµè§ˆå™¨ç«¯çš„æ¨¡å—ï¼Œä¸èƒ½é‡‡ç”¨â€åŒæ­¥åŠ è½½â€ï¼ˆsynchronousï¼‰ï¼Œåªèƒ½é‡‡ç”¨â€å¼‚æ­¥åŠ è½½â€ï¼ˆasynchronousï¼‰ã€‚è¿™å°±æ˜¯AMDè§„èŒƒè¯ç”Ÿçš„èƒŒæ™¯ã€‚</p><p>CommonJSæ˜¯ä¸»è¦ä¸ºäº†JSåœ¨åç«¯çš„è¡¨ç°åˆ¶å®šçš„ï¼Œä»–æ˜¯ä¸é€‚åˆå‰ç«¯çš„ï¼ŒAMD(å¼‚æ­¥æ¨¡å—å®šä¹‰)å‡ºç°äº†ï¼Œå®ƒå°±ä¸»è¦ä¸ºå‰ç«¯JSçš„è¡¨ç°åˆ¶å®šè§„èŒƒã€‚</p><p><a href="https://github.com/amdjs/amdjs-api/wiki/AMD" target="_blank" rel="noopener">AMD</a>æ˜¯â€Asynchronous Module Definitionâ€çš„ç¼©å†™ï¼Œæ„æ€å°±æ˜¯â€å¼‚æ­¥æ¨¡å—å®šä¹‰â€ã€‚å®ƒé‡‡ç”¨å¼‚æ­¥æ–¹å¼åŠ è½½æ¨¡å—ï¼Œæ¨¡å—çš„åŠ è½½ä¸å½±å“å®ƒåé¢è¯­å¥çš„è¿è¡Œã€‚æ‰€æœ‰ä¾èµ–è¿™ä¸ªæ¨¡å—çš„è¯­å¥ï¼Œéƒ½å®šä¹‰åœ¨ä¸€ä¸ªå›è°ƒå‡½æ•°ä¸­ï¼Œç­‰åˆ°åŠ è½½å®Œæˆä¹‹åï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°æ‰ä¼šè¿è¡Œã€‚</p><p>AMDä¹Ÿé‡‡ç”¨require()è¯­å¥åŠ è½½æ¨¡å—ï¼Œä½†æ˜¯ä¸åŒäºCommonJSï¼Œå®ƒè¦æ±‚ä¸¤ä¸ªå‚æ•°ï¼š</p><pre><code>require([module], callback);</code></pre><p>ç¬¬ä¸€ä¸ªå‚æ•°[module]ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢çš„æˆå‘˜å°±æ˜¯è¦åŠ è½½çš„æ¨¡å—ï¼›ç¬¬äºŒä¸ªå‚æ•°callbackï¼Œåˆ™æ˜¯åŠ è½½æˆåŠŸä¹‹åçš„å›è°ƒå‡½æ•°ã€‚å¦‚æœå°†å‰é¢çš„ä»£ç æ”¹å†™æˆAMDå½¢å¼ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">require([&apos;math&apos;], function (math) &#123;</span><br><span class="line">    math.add(2, 3);</span><br><span class="line">ã€€&#125;);</span><br></pre></td></tr></table></figure></p><p>math.add()ä¸mathæ¨¡å—åŠ è½½ä¸æ˜¯åŒæ­¥çš„ï¼Œæµè§ˆå™¨ä¸ä¼šå‘ç”Ÿå‡æ­»ã€‚æ‰€ä»¥å¾ˆæ˜¾ç„¶ï¼ŒAMDæ¯”è¾ƒé€‚åˆæµè§ˆå™¨ç¯å¢ƒã€‚ç›®å‰ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªJavascriptåº“å®ç°äº†AMDè§„èŒƒï¼š<a href="https://requirejs.org/" target="_blank" rel="noopener">require.js</a>å’Œ<a href="https://github.com/cujojs/curl" target="_blank" rel="noopener">curl.js</a>ã€‚</p><font color="red">RequireJSå°±æ˜¯å®ç°äº†AMDè§„èŒƒçš„å‘¢ã€‚</font><br><font size="2">è¯¦ç»†æ¦‚æ‹¬ï¼šä¸‹é¢ä»¥RequireJSä¸ºä¾‹è¯´æ˜AMDè§„èŒƒ</font><h2 id="ä¸ºä»€ä¹ˆè¦ç”¨require-jsï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦ç”¨require-jsï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ç”¨require.jsï¼Ÿ"></a><font color="#0099ff" size="3" face="é»‘ä½“">ä¸ºä»€ä¹ˆè¦ç”¨require.jsï¼Ÿ</font></h2><p>æœ€æ—©çš„æ—¶å€™ï¼Œæ‰€æœ‰Javascriptä»£ç éƒ½å†™åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œåªè¦åŠ è½½è¿™ä¸€ä¸ªæ–‡ä»¶å°±å¤Ÿäº†ã€‚åæ¥ï¼Œä»£ç è¶Šæ¥è¶Šå¤šï¼Œä¸€ä¸ªæ–‡ä»¶ä¸å¤Ÿäº†ï¼Œå¿…é¡»åˆ†æˆå¤šä¸ªæ–‡ä»¶ï¼Œä¾æ¬¡åŠ è½½ã€‚ä¸‹é¢çš„ç½‘é¡µä»£ç ï¼Œç›¸ä¿¡å¾ˆå¤šäººéƒ½è§è¿‡ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;1.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;2.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;3.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;4.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;5.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;6.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure><br>è¿™æ®µä»£ç ä¾æ¬¡åŠ è½½å¤šä¸ªjsæ–‡ä»¶ã€‚<br>è¿™æ ·çš„å†™æ³•æœ‰å¾ˆå¤§çš„ç¼ºç‚¹ã€‚é¦–å…ˆï¼ŒåŠ è½½çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šåœæ­¢ç½‘é¡µæ¸²æŸ“ï¼ŒåŠ è½½æ–‡ä»¶è¶Šå¤šï¼Œç½‘é¡µå¤±å»å“åº”çš„æ—¶é—´å°±ä¼šè¶Šé•¿ï¼›å…¶æ¬¡ï¼Œç”±äºjsæ–‡ä»¶ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œå› æ­¤å¿…é¡»ä¸¥æ ¼ä¿è¯åŠ è½½é¡ºåºï¼ˆæ¯”å¦‚ä¸Šä¾‹çš„1.jsè¦åœ¨2.jsçš„å‰é¢ï¼‰ï¼Œä¾èµ–æ€§æœ€å¤§çš„æ¨¡å—ä¸€å®šè¦æ”¾åˆ°æœ€ååŠ è½½ï¼Œå½“ä¾èµ–å…³ç³»å¾ˆå¤æ‚çš„æ—¶å€™ï¼Œä»£ç çš„ç¼–å†™å’Œç»´æŠ¤éƒ½ä¼šå˜å¾—å›°éš¾ã€‚</p><p>require.jsçš„è¯ç”Ÿï¼Œå°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ï¼š</p><blockquote><p>(1) å®ç°jsæ–‡ä»¶çš„å¼‚æ­¥åŠ è½½ï¼Œé¿å…ç½‘é¡µå¤±å»å“åº”ï¼›<br>(2) ç®¡ç†æ¨¡å—ä¹‹é—´çš„ä¾èµ–æ€§ï¼Œä¾¿äºä»£ç çš„ç¼–å†™å’Œç»´æŠ¤ã€‚</p></blockquote><h2 id="require-jsçš„åŠ è½½"><a href="#require-jsçš„åŠ è½½" class="headerlink" title="require.jsçš„åŠ è½½"></a><font color="#0099ff" size="3" face="é»‘ä½“">require.jsçš„åŠ è½½</font></h2><p>ä½¿ç”¨require.jsçš„ç¬¬ä¸€æ­¥ï¼Œæ˜¯å…ˆå»å®˜æ–¹ç½‘ç«™<a href="https://requirejs.org/docs/download.html" target="_blank" rel="noopener">ä¸‹è½½</a>æœ€æ–°ç‰ˆæœ¬ã€‚<br>ä¸‹è½½åï¼Œå‡å®šæŠŠå®ƒæ”¾åœ¨jså­ç›®å½•ä¸‹é¢ï¼Œå°±å¯ä»¥åŠ è½½äº†ã€‚</p><pre><code>&lt;script src=&quot;js/require.js&quot;&gt;&lt;/script&gt;</code></pre><p>æœ‰äººå¯èƒ½ä¼šæƒ³åˆ°ï¼ŒåŠ è½½è¿™ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå¯èƒ½é€ æˆç½‘é¡µå¤±å»å“åº”ã€‚è§£å†³åŠæ³•æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯æŠŠå®ƒæ”¾åœ¨ç½‘é¡µåº•éƒ¨åŠ è½½ï¼Œå¦ä¸€ä¸ªæ˜¯å†™æˆä¸‹é¢è¿™æ ·ï¼š</p><pre><code>&lt;script src=&quot;js/require.js&quot; defer async=&quot;true&quot; &gt;&lt;/script&gt;</code></pre><p>asyncå±æ€§è¡¨æ˜è¿™ä¸ªæ–‡ä»¶éœ€è¦å¼‚æ­¥åŠ è½½ï¼Œé¿å…ç½‘é¡µå¤±å»å“åº”ã€‚IEä¸æ”¯æŒè¿™ä¸ªå±æ€§ï¼Œåªæ”¯æŒdeferï¼Œæ‰€ä»¥æŠŠdeferä¹Ÿå†™ä¸Šã€‚<br>åŠ è½½require.jsä»¥åï¼Œä¸‹ä¸€æ­¥å°±è¦åŠ è½½æˆ‘ä»¬è‡ªå·±çš„ä»£ç äº†ã€‚å‡å®šæˆ‘ä»¬è‡ªå·±çš„ä»£ç æ–‡ä»¶æ˜¯main.jsï¼Œä¹Ÿæ”¾åœ¨jsç›®å½•ä¸‹é¢ã€‚é‚£ä¹ˆï¼Œåªéœ€è¦å†™æˆä¸‹é¢è¿™æ ·å°±è¡Œäº†ï¼š</p><pre><code>&lt;script src=&quot;js/require.js&quot; data-main=&quot;js/main&quot;&gt;&lt;/script&gt;</code></pre><p>data-mainå±æ€§çš„ä½œç”¨æ˜¯ï¼ŒæŒ‡å®šç½‘é¡µç¨‹åºçš„ä¸»æ¨¡å—ã€‚åœ¨ä¸Šä¾‹ä¸­ï¼Œå°±æ˜¯jsç›®å½•ä¸‹é¢çš„main.jsï¼Œè¿™ä¸ªæ–‡ä»¶ä¼šç¬¬ä¸€ä¸ªè¢«require.jsåŠ è½½ã€‚ç”±äºrequire.jsé»˜è®¤çš„æ–‡ä»¶åç¼€åæ˜¯jsï¼Œæ‰€ä»¥å¯ä»¥æŠŠmain.jsç®€å†™æˆmainã€‚</p><h2 id="ä¸»æ¨¡å—çš„å†™æ³•"><a href="#ä¸»æ¨¡å—çš„å†™æ³•" class="headerlink" title="ä¸»æ¨¡å—çš„å†™æ³•"></a><font color="#0099ff" size="3" face="é»‘ä½“">ä¸»æ¨¡å—çš„å†™æ³•</font></h2><p>ä¸Šä¸€èŠ‚çš„main.jsï¼Œæˆ‘æŠŠå®ƒç§°ä¸ºâ€ä¸»æ¨¡å—â€ï¼Œæ„æ€æ˜¯æ•´ä¸ªç½‘é¡µçš„å…¥å£ä»£ç ã€‚å®ƒæœ‰ç‚¹åƒCè¯­è¨€çš„main()å‡½æ•°ï¼Œæ‰€æœ‰ä»£ç éƒ½ä»è¿™å„¿å¼€å§‹è¿è¡Œã€‚<br>ä¸‹é¢å°±æ¥çœ‹ï¼Œæ€ä¹ˆå†™main.jsã€‚<br>å¦‚æœæˆ‘ä»¬çš„ä»£ç ä¸ä¾èµ–ä»»ä½•å…¶ä»–æ¨¡å—ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥å†™å…¥javascriptä»£ç ã€‚</p><blockquote><p> // main.js<br>ã€€ã€€alert(â€œåŠ è½½æˆåŠŸï¼â€);</p></blockquote><p>ä½†è¿™æ ·çš„è¯ï¼Œå°±æ²¡å¿…è¦ä½¿ç”¨require.jsäº†ã€‚çœŸæ­£å¸¸è§çš„æƒ…å†µæ˜¯ï¼Œä¸»æ¨¡å—ä¾èµ–äºå…¶ä»–æ¨¡å—ï¼Œè¿™æ—¶å°±è¦ä½¿ç”¨AMDè§„èŒƒå®šä¹‰çš„çš„require()å‡½æ•°ã€‚</p><blockquote><p>   // main.js<br>ã€€ã€€require([â€˜moduleAâ€™, â€˜moduleBâ€™, â€˜moduleCâ€™], function (moduleA, moduleB, moduleC){<br>ã€€ã€€ã€€ã€€// some code here<br>ã€€ã€€});</p></blockquote><p>require()å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¡¨ç¤ºæ‰€ä¾èµ–çš„æ¨¡å—ï¼Œä¸Šä¾‹å°±æ˜¯[â€˜moduleAâ€™, â€˜moduleBâ€™, â€˜moduleCâ€™]ï¼Œå³ä¸»æ¨¡å—ä¾èµ–è¿™ä¸‰ä¸ªæ¨¡å—ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“å‰é¢æŒ‡å®šçš„æ¨¡å—éƒ½åŠ è½½æˆåŠŸåï¼Œå®ƒå°†è¢«è°ƒç”¨ã€‚åŠ è½½çš„æ¨¡å—ä¼šä»¥å‚æ•°å½¢å¼ä¼ å…¥è¯¥å‡½æ•°ï¼Œä»è€Œåœ¨å›è°ƒå‡½æ•°å†…éƒ¨å°±å¯ä»¥ä½¿ç”¨è¿™äº›æ¨¡å—ã€‚</p><p>require()å¼‚æ­¥åŠ è½½moduleAï¼ŒmoduleBå’ŒmoduleCï¼Œæµè§ˆå™¨ä¸ä¼šå¤±å»å“åº”ï¼›å®ƒæŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œåªæœ‰å‰é¢çš„æ¨¡å—éƒ½åŠ è½½æˆåŠŸåï¼Œæ‰ä¼šè¿è¡Œï¼Œè§£å†³äº†ä¾èµ–æ€§çš„é—®é¢˜ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸ªå®é™…çš„ä¾‹å­ã€‚<br>å‡å®šä¸»æ¨¡å—ä¾èµ–jqueryã€underscoreå’Œbackboneè¿™ä¸‰ä¸ªæ¨¡å—ï¼Œmain.jså°±å¯ä»¥è¿™æ ·å†™ï¼š</p><blockquote><p>require([â€˜jqueryâ€™, â€˜underscoreâ€™, â€˜backboneâ€™], function ($, _, Backbone){<br>ã€€ã€€ã€€ã€€// some code here<br>ã€€ã€€});</p></blockquote><p>require.jsä¼šå…ˆåŠ è½½jQueryã€underscoreå’Œbackboneï¼Œç„¶åå†è¿è¡Œå›è°ƒå‡½æ•°ã€‚ä¸»æ¨¡å—çš„ä»£ç å°±å†™åœ¨å›è°ƒå‡½æ•°ä¸­ã€‚</p><h2 id="æ¨¡å—çš„åŠ è½½"><a href="#æ¨¡å—çš„åŠ è½½" class="headerlink" title="æ¨¡å—çš„åŠ è½½"></a><font color="#0099ff" size="3" face="é»‘ä½“">æ¨¡å—çš„åŠ è½½</font></h2><p>ä¸Šä¸€èŠ‚æœ€åçš„ç¤ºä¾‹ä¸­ï¼Œä¸»æ¨¡å—çš„ä¾èµ–æ¨¡å—æ˜¯[â€˜jqueryâ€™, â€˜underscoreâ€™, â€˜backboneâ€™]ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œrequire.jså‡å®šè¿™ä¸‰ä¸ªæ¨¡å—ä¸main.jsåœ¨åŒä¸€ä¸ªç›®å½•ï¼Œæ–‡ä»¶ååˆ†åˆ«ä¸ºjquery.jsï¼Œunderscore.jså’Œbackbone.jsï¼Œç„¶åè‡ªåŠ¨åŠ è½½ã€‚</p><p>ä½¿ç”¨require.config()æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ¨¡å—çš„åŠ è½½è¡Œä¸ºè¿›è¡Œè‡ªå®šä¹‰ã€‚require.config()å°±å†™åœ¨ä¸»æ¨¡å—ï¼ˆmain.jsï¼‰çš„å¤´éƒ¨ã€‚å‚æ•°å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„pathså±æ€§æŒ‡å®šå„ä¸ªæ¨¡å—çš„åŠ è½½è·¯å¾„ã€‚</p><blockquote><p>   require.config({<br>ã€€ã€€ã€€ã€€paths: {<br>ã€€ã€€ã€€ã€€ã€€ã€€â€œjqueryâ€: â€œjquery.minâ€,<br>ã€€ã€€ã€€ã€€ã€€ã€€â€œunderscoreâ€: â€œunderscore.minâ€,<br>ã€€ã€€ã€€ã€€ã€€ã€€â€œbackboneâ€: â€œbackbone.minâ€<br>ã€€ã€€ã€€ã€€}<br>ã€€ã€€});</p></blockquote><p>ä¸Šé¢çš„ä»£ç ç»™å‡ºäº†ä¸‰ä¸ªæ¨¡å—çš„æ–‡ä»¶åï¼Œè·¯å¾„é»˜è®¤ä¸main.jsåœ¨åŒä¸€ä¸ªç›®å½•ï¼ˆjså­ç›®å½•ï¼‰ã€‚å¦‚æœè¿™äº›æ¨¡å—åœ¨å…¶ä»–ç›®å½•ï¼Œæ¯”å¦‚js/libç›®å½•ï¼Œåˆ™æœ‰ä¸¤ç§å†™æ³•ã€‚ä¸€ç§æ˜¯é€ä¸€æŒ‡å®šè·¯å¾„ã€‚</p><blockquote><p>   require.config({<br>ã€€ã€€ã€€ã€€paths: {<br>ã€€ã€€ã€€ã€€ã€€ã€€â€œjqueryâ€: â€œlib/jquery.minâ€,<br>ã€€ã€€ã€€ã€€ã€€ã€€â€œunderscoreâ€: â€œlib/underscore.minâ€,<br>ã€€ã€€ã€€ã€€ã€€ã€€â€œbackboneâ€: â€œlib/backbone.minâ€<br>ã€€ã€€ã€€ã€€}<br>ã€€ã€€});</p></blockquote><p>å¦ä¸€ç§åˆ™æ˜¯ç›´æ¥æ”¹å˜åŸºç›®å½•ï¼ˆbaseUrlï¼‰ã€‚</p><blockquote><p>   require.config({<br>ã€€ã€€ã€€ã€€baseUrl: â€œjs/libâ€,<br>ã€€ã€€ã€€ã€€paths: {<br>ã€€ã€€ã€€ã€€ã€€ã€€â€œjqueryâ€: â€œjquery.minâ€,<br>ã€€ã€€ã€€ã€€ã€€ã€€â€œunderscoreâ€: â€œunderscore.minâ€,<br>ã€€ã€€ã€€ã€€ã€€ã€€â€œbackboneâ€: â€œbackbone.minâ€<br>ã€€ã€€ã€€ã€€}<br>ã€€ã€€});</p></blockquote><p>å¦‚æœæŸä¸ªæ¨¡å—åœ¨å¦ä¸€å°ä¸»æœºä¸Šï¼Œä¹Ÿå¯ä»¥ç›´æ¥æŒ‡å®šå®ƒçš„ç½‘å€ï¼Œæ¯”å¦‚ï¼š</p><blockquote><p>   require.config({<br>ã€€ã€€ã€€ã€€paths: {<br>ã€€ã€€ã€€ã€€ã€€ã€€â€œjqueryâ€: â€œ<a href="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min&quot;" target="_blank" rel="noopener">https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min&quot;</a><br>ã€€ã€€ã€€ã€€}<br>ã€€ã€€});</p></blockquote><p>require.jsè¦æ±‚ï¼Œæ¯ä¸ªæ¨¡å—æ˜¯ä¸€ä¸ªå•ç‹¬çš„jsæ–‡ä»¶ã€‚è¿™æ ·çš„è¯ï¼Œå¦‚æœåŠ è½½å¤šä¸ªæ¨¡å—ï¼Œå°±ä¼šå‘å‡ºå¤šæ¬¡HTTPè¯·æ±‚ï¼Œä¼šå½±å“ç½‘é¡µçš„åŠ è½½é€Ÿåº¦ã€‚å› æ­¤ï¼Œrequire.jsæä¾›äº†ä¸€ä¸ª<a href="https://requirejs.org/docs/optimization.html" target="_blank" rel="noopener">ä¼˜åŒ–å·¥å…·</a>ï¼Œå½“æ¨¡å—éƒ¨ç½²å®Œæ¯•ä»¥åï¼Œå¯ä»¥ç”¨è¿™ä¸ªå·¥å…·å°†å¤šä¸ªæ¨¡å—åˆå¹¶åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå‡å°‘HTTPè¯·æ±‚æ•°ã€‚</p><h2 id="AMDæ¨¡å—çš„å†™æ³•"><a href="#AMDæ¨¡å—çš„å†™æ³•" class="headerlink" title="AMDæ¨¡å—çš„å†™æ³•"></a><font color="#0099ff" size="3" face="é»‘ä½“">AMDæ¨¡å—çš„å†™æ³•</font></h2><p>require.jsåŠ è½½çš„æ¨¡å—ï¼Œé‡‡ç”¨AMDè§„èŒƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¨¡å—å¿…é¡»æŒ‰ç…§AMDçš„è§„å®šæ¥å†™ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯æ¨¡å—å¿…é¡»é‡‡ç”¨ç‰¹å®šçš„define()å‡½æ•°æ¥å®šä¹‰ã€‚å¦‚æœä¸€ä¸ªæ¨¡å—ä¸ä¾èµ–å…¶ä»–æ¨¡å—ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥å®šä¹‰åœ¨define()å‡½æ•°ä¹‹ä¸­ã€‚</p><p>å‡å®šç°åœ¨æœ‰ä¸€ä¸ªmath.jsæ–‡ä»¶ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªmathæ¨¡å—ã€‚é‚£ä¹ˆï¼Œmath.jså°±è¦è¿™æ ·å†™ï¼š</p><blockquote><p>   // math.js<br>ã€€ã€€define(function (){<br>ã€€ã€€ã€€ã€€var add = function (x,y){<br>ã€€ã€€ã€€ã€€ã€€ã€€return x+y;<br>ã€€ã€€ã€€ã€€};<br>ã€€ã€€ã€€ã€€return {<br>ã€€ã€€ã€€ã€€ã€€ã€€add: add<br>ã€€ã€€ã€€ã€€};<br>ã€€ã€€});</p></blockquote><p>åŠ è½½æ–¹æ³•å¦‚ä¸‹ï¼š</p><blockquote><p>   // main.js<br>ã€€ã€€require([â€˜mathâ€™], function (math){<br>ã€€ã€€ã€€ã€€alert(math.add(1,1));<br>ã€€ã€€});</p></blockquote><p>å¦‚æœè¿™ä¸ªæ¨¡å—è¿˜ä¾èµ–å…¶ä»–æ¨¡å—ï¼Œé‚£ä¹ˆdefine()å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¿…é¡»æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒæŒ‡æ˜è¯¥æ¨¡å—çš„ä¾èµ–æ€§ã€‚</p><blockquote><p>   define([â€˜myLibâ€™], function(myLib){<br>ã€€ã€€ã€€ã€€function foo(){<br>ã€€ã€€ã€€ã€€ã€€ã€€myLib.doSomething();<br>ã€€ã€€ã€€ã€€}<br>ã€€ã€€ã€€ã€€return {<br>ã€€ã€€ã€€ã€€ã€€ã€€foo : foo<br>ã€€ã€€ã€€ã€€};<br>ã€€ã€€});</p></blockquote><p>å½“require()å‡½æ•°åŠ è½½ä¸Šé¢è¿™ä¸ªæ¨¡å—çš„æ—¶å€™ï¼Œå°±ä¼šå…ˆåŠ è½½myLib.jsæ–‡ä»¶ã€‚</p><h2 id="åŠ è½½éè§„èŒƒçš„æ¨¡å—"><a href="#åŠ è½½éè§„èŒƒçš„æ¨¡å—" class="headerlink" title="åŠ è½½éè§„èŒƒçš„æ¨¡å—"></a><font color="#0099ff" size="3" face="é»‘ä½“">åŠ è½½éè§„èŒƒçš„æ¨¡å—</font></h2><p>ç†è®ºä¸Šï¼Œrequire.jsåŠ è½½çš„æ¨¡å—ï¼Œå¿…é¡»æ˜¯æŒ‰ç…§AMDè§„èŒƒã€ç”¨define()å‡½æ•°å®šä¹‰çš„æ¨¡å—ã€‚ä½†æ˜¯å®é™…ä¸Šï¼Œè™½ç„¶å·²ç»æœ‰ä¸€éƒ¨åˆ†æµè¡Œçš„å‡½æ•°åº“ï¼ˆæ¯”å¦‚jQueryï¼‰ç¬¦åˆAMDè§„èŒƒï¼Œæ›´å¤šçš„åº“å¹¶ä¸ç¬¦åˆã€‚é‚£ä¹ˆï¼Œrequire.jsæ˜¯å¦èƒ½å¤ŸåŠ è½½éè§„èŒƒçš„æ¨¡å—å‘¢ï¼Ÿ</p><p>å›ç­”æ˜¯å¯ä»¥çš„ã€‚</p><p>è¿™æ ·çš„æ¨¡å—åœ¨ç”¨require()åŠ è½½ä¹‹å‰ï¼Œè¦å…ˆç”¨require.config()æ–¹æ³•ï¼Œå®šä¹‰å®ƒä»¬çš„ä¸€äº›ç‰¹å¾ã€‚</p><p>ä¸¾ä¾‹æ¥è¯´ï¼Œunderscoreå’Œbackboneè¿™ä¸¤ä¸ªåº“ï¼Œéƒ½æ²¡æœ‰é‡‡ç”¨AMDè§„èŒƒç¼–å†™ã€‚å¦‚æœè¦åŠ è½½å®ƒä»¬çš„è¯ï¼Œå¿…é¡»å…ˆå®šä¹‰å®ƒä»¬çš„ç‰¹å¾ã€‚</p><blockquote><p>   require.config({<br>ã€€ã€€ã€€ã€€shim: {<br>ã€€ã€€ã€€ã€€ã€€ã€€â€˜underscoreâ€™:{<br>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€exports: â€˜_â€™<br>ã€€ã€€ã€€ã€€ã€€ã€€},<br>ã€€ã€€ã€€ã€€ã€€ã€€â€˜backboneâ€™: {<br>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€deps: [â€˜underscoreâ€™, â€˜jqueryâ€™],<br>ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€exports: â€˜Backboneâ€™<br>ã€€ã€€ã€€ã€€ã€€ã€€}<br>ã€€ã€€ã€€ã€€}<br>ã€€ã€€});</p></blockquote><p>require.config()æ¥å—ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡é™¤äº†æœ‰å‰é¢è¯´è¿‡çš„pathså±æ€§ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªshimå±æ€§ï¼Œä¸“é—¨ç”¨æ¥é…ç½®ä¸å…¼å®¹çš„æ¨¡å—ã€‚å…·ä½“æ¥è¯´ï¼Œæ¯ä¸ªæ¨¡å—è¦å®šä¹‰ï¼ˆ1ï¼‰exportså€¼ï¼ˆè¾“å‡ºçš„å˜é‡åï¼‰ï¼Œè¡¨æ˜è¿™ä¸ªæ¨¡å—å¤–éƒ¨è°ƒç”¨æ—¶çš„åç§°ï¼›ï¼ˆ2ï¼‰depsæ•°ç»„ï¼Œè¡¨æ˜è¯¥æ¨¡å—çš„ä¾èµ–æ€§ã€‚</p><p>æ¯”å¦‚ï¼ŒjQueryçš„æ’ä»¶å¯ä»¥è¿™æ ·å®šä¹‰ï¼š</p><blockquote><p>   shim: {<br>ã€€ã€€ã€€ã€€â€˜jquery.scrollâ€™: {<br>ã€€ã€€ã€€ã€€ã€€ã€€deps: [â€˜jqueryâ€™],<br>ã€€ã€€ã€€ã€€ã€€ã€€exports: â€˜jQuery.fn.scrollâ€™<br>ã€€ã€€ã€€ã€€}<br>ã€€ã€€}</p></blockquote><h2 id="require-jsæ’ä»¶"><a href="#require-jsæ’ä»¶" class="headerlink" title="require.jsæ’ä»¶"></a><font color="#0099ff" size="3" face="é»‘ä½“">require.jsæ’ä»¶</font></h2><p>require.jsè¿˜æä¾›ä¸€ç³»åˆ—<a href="https://github.com/requirejs/requirejs/wiki/Plugins" target="_blank" rel="noopener">æ’ä»¶</a>ï¼Œå®ç°ä¸€äº›ç‰¹å®šçš„åŠŸèƒ½ã€‚</p><p>domreadyæ’ä»¶ï¼Œå¯ä»¥è®©å›è°ƒå‡½æ•°åœ¨é¡µé¢DOMç»“æ„åŠ è½½å®Œæˆåå†è¿è¡Œã€‚</p><blockquote><p>   require([â€˜domready!â€™], function (doc){<br>ã€€ã€€ã€€ã€€// called once the DOM is ready<br>ã€€ã€€});</p></blockquote><p>textå’Œimageæ’ä»¶ï¼Œåˆ™æ˜¯å…è®¸require.jsåŠ è½½æ–‡æœ¬å’Œå›¾ç‰‡æ–‡ä»¶ã€‚</p><blockquote><p>ã€€ã€€   define([<br>ã€€ã€€ã€€ã€€â€˜text!review.txtâ€™,<br>ã€€ã€€ã€€ã€€â€˜image!cat.jpgâ€™<br>ã€€ã€€ã€€ã€€],<br>ã€€ã€€ã€€ã€€function(review,cat){<br>ã€€ã€€ã€€ã€€ã€€ã€€console.log(review);<br>ã€€ã€€ã€€ã€€ã€€ã€€document.body.appendChild(cat);<br>ã€€ã€€ã€€ã€€}<br>ã€€ã€€);</p></blockquote><p>ç±»ä¼¼çš„æ’ä»¶è¿˜æœ‰jsonå’Œmdownï¼Œç”¨äºåŠ è½½jsonæ–‡ä»¶å’Œmarkdownæ–‡ä»¶ã€‚ï¼ˆå®Œï¼‰</p><p>å¦ä¸€ä¸ªäººçš„æ¦‚æ‹¬(æœ‰ç‚¹ç®€å•)ï¼š</p><p>AMDå°±åªæœ‰ä¸€ä¸ªæ¥å£ï¼šdefine(id?,dependencies?,factory);</p><p>å®ƒè¦åœ¨å£°æ˜æ¨¡å—çš„æ—¶å€™åˆ¶å®šæ‰€æœ‰çš„ä¾èµ–(dep)ï¼Œå¹¶ä¸”è¿˜è¦å½“åšå½¢å‚ä¼ åˆ°factoryä¸­ï¼Œåƒè¿™æ ·ï¼š</p><blockquote><p>define([â€˜dep1â€™,â€™dep2â€™],function(dep1,dep2){â€¦});</p></blockquote><p>è¦æ˜¯æ²¡ä»€ä¹ˆä¾èµ–ï¼Œå°±å®šä¹‰ç®€å•çš„æ¨¡å—ï¼Œä¸‹é¢è¿™æ ·å°±å¯ä»¥å•¦ï¼š</p><blockquote><pre><code>   define(function(){    var exports = {};    exports.method = function(){...};    return exports;});</code></pre></blockquote><p>å’¦ï¼Œè¿™é‡Œæœ‰defineï¼ŒæŠŠä¸œè¥¿åŒ…è£…èµ·æ¥å•¦ï¼Œé‚£Nodeå®ç°ä¸­æ€ä¹ˆæ²¡çœ‹åˆ°æœ‰defineå…³é”®å­—å‘¢ï¼Œå®ƒä¹Ÿè¦æŠŠä¸œè¥¿åŒ…è£…èµ·æ¥å‘€ï¼Œå…¶å®å§ï¼Œåªæ˜¯Nodeéšå¼åŒ…è£…äº†è€Œå·²â€¦..</p><p>è¿™æœ‰AMDçš„WIKIä¸­æ–‡ç‰ˆï¼Œè®²äº†å¾ˆå¤šè›®è¯¦ç»†çš„ä¸œè¥¿ï¼Œç”¨åˆ°çš„æ—¶å€™å¯ä»¥æŸ¥çœ‹ï¼š<a href="https://github.com/amdjs/amdjs-api/wiki/AMD-(%E4%B8%AD%E6%96%87%E7%89%88" target="_blank" rel="noopener">AMDçš„WIKIä¸­æ–‡ç‰ˆ</a></p><h1 id="CMD"><a href="#CMD" class="headerlink" title="CMD"></a>CMD</h1><p>å¤§åè¿œæ‰¬çš„ç‰ä¼¯å†™äº†seajsï¼Œå°±æ˜¯éµå¾ªä»–æå‡ºçš„CMDè§„èŒƒï¼Œä¸AMDè›®ç›¸è¿‘çš„ï¼Œä¸è¿‡ç”¨èµ·æ¥æ„Ÿè§‰æ›´åŠ æ–¹ä¾¿äº›ï¼Œæœ€é‡è¦çš„æ˜¯ä¸­æ–‡ç‰ˆï¼Œåº”æœ‰å°½æœ‰ï¼š<a href="http://www6.seajs.org/?s_token=1548666648.0457692136&amp;kw=Javascript&amp;term=learn%20javascript&amp;term=javascript%20example&amp;term=module%20loader&amp;term=api%20integration&amp;term=javascript%20online%20courses&amp;showDomain=1&amp;backfill=0&amp;tdfs=1#docs" target="_blank" rel="noopener">seajså®˜æ–¹doc</a></p><blockquote><p>define(function(require,exports,module){â€¦});</p></blockquote><p>ç”¨è¿‡seajså§ï¼Œè¿™ä¸ªä¸é™Œç”Ÿå§ï¼Œå¯¹å§ã€‚</p><p>å‰é¢è¯´AMDï¼Œè¯´RequireJSå®ç°äº†AMDï¼ŒCMDçœ‹èµ·æ¥ä¸AMDå¥½åƒå‘€ï¼Œé‚£RequireJSä¸SeaJSåƒä¸åƒå‘¢ï¼Ÿ</p><p>è™½ç„¶CMDä¸AMDè›®åƒçš„ï¼Œä½†åŒºåˆ«è¿˜æ˜¯æŒºæ˜æ˜¾çš„ï¼Œå®˜æ–¹éå®˜æ–¹éƒ½æœ‰é˜è¿°å’Œç†è§£ï¼Œæˆ‘è§‰å¾—å§ï¼Œè¯´çš„éƒ½æŒºå¥½ï¼š</p><p><a href="https://github.com/seajs/seajs/issues/277" target="_blank" rel="noopener">å®˜æ–¹é˜è¿°SeaJSä¸RequireJSå¼‚åŒ</a></p><p><a href="https://www.douban.com/note/283566440/" target="_blank" rel="noopener">SeaJSä¸RequireJSçš„æœ€å¤§å¼‚åŒï¼ˆè¿™ä¸ªè¯´çš„ä¹ŸæŒºå¥½)</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;p&gt;ä¸ºä»€ä¹ˆæ¨¡å—å¾ˆé‡è¦ï¼Ÿ &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å› ä¸ºæœ‰äº†æ¨¡å—ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ›´æ–¹ä¾¿åœ°ä½¿ç”¨åˆ«äººçš„ä»£ç ï¼Œæƒ³è¦ä»€ä¹ˆåŠŸèƒ½ï¼Œå°±åŠ è½½ä»€ä¹ˆæ¨¡å—ã€‚&lt;br&gt;ä½†æ˜¯ï¼Œè¿™æ ·åšæœ‰ä¸€ä¸ªå‰æï¼Œé‚£å°±æ˜¯å¤§å®¶å¿…é¡»ä»¥åŒæ ·çš„æ–¹å¼ç¼–å†™æ¨¡å—ï¼Œå¦åˆ™ä½ æœ‰ä½ çš„å†™æ³•ï¼Œæˆ‘æœ‰æˆ‘çš„å†™æ³•ï¼Œå²‚ä¸æ˜¯ä¹±äº†å¥—ï¼&lt;br&gt;
    
    </summary>
    
      <category term="web" scheme="https://zhanghuaxiao.github.io/categories/web/"/>
    
    
      <category term="CommonJS/AMD/CMD" scheme="https://zhanghuaxiao.github.io/tags/CommonJS-AMD-CMD/"/>
    
  </entry>
  
  <entry>
    <title>ç”¨ JavaScript å’Œ Emoji åšåœ°å€æ åŠ¨ç”»</title>
    <link href="https://zhanghuaxiao.github.io/2019/01/27/Emojis-url/"/>
    <id>https://zhanghuaxiao.github.io/2019/01/27/Emojis-url/</id>
    <published>2019-01-27T04:06:29.000Z</published>
    <updated>2019-01-27T04:28:32.875Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>åŒæ ·æ˜¯9å¹´ä¹‰åŠ¡æ•™è‚²ï¼Œä½ ä¸ºä½•è¿™ä¹ˆä¼˜ç§€ </p></blockquote><a id="more"></a><blockquote><p>è¯‘è€…ï¼š<a href="https://juejin.im/post/5c49b822f265da6142743a87" target="_blank" rel="noopener">Wpeach</a><br> åŸæ–‡ä½œè€…ï¼šMatthew Rayfield<br> åŸæ–‡åœ°å€ï¼š<a href="http://matthewrayfield.com/articles/animating-urls-with-javascript-and-emojis/" target="_blank" rel="noopener">Animating URLs with Javascript and Emojis</a></p></blockquote><p> ä½ å¯ä»¥åœ¨åœ°å€æ ä½¿ç”¨ emojiï¼ˆå’Œå…¶å®ƒå›¾å½¢ unicode å­—ç¬¦ï¼‰ï¼Œè¿™çœ‹ç€å¾ˆæ£’ï¼Œä½†æ˜¯å¥½åƒæ²¡äººè¿™ä¹ˆåšï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿä¹Ÿè®¸ emoji å¯¹äºæ­£å¸¸çš„ç½‘ç»œå¹³å°æ¥è¯´å¤ªè¿‡å¼‚å›½æƒ…è°ƒäº†ï¼Ÿæˆ–è®¸æ˜¯ä»–ä»¬å› ä¸ºå®³æ€•ä¸åˆ©äºSEOï¼Ÿ<br>ä¸ç®¡ä»€ä¹ˆåŸå› ï¼Œç»´æ©å›¾ä¸­çš„åˆç†æ€§è§‚ç‚¹â€œæ²¡äººè¿™ä¹ˆåšï¼Œä½†è¿™æ˜¯å¯èƒ½çš„â€æ˜¯è®©æˆ‘å…´å¥‹çš„ç‚¹ã€‚æ‰€ä»¥æˆ‘å†³å®šèŠ±è´¹ä¸€äº›æ—¶é—´ç ”ç©¶åœ¨åœ°å€æ ä¸­å›¾å½¢å­—ç¬¦çš„å¯èƒ½æ€§ï¼Œç‰¹åˆ«æ˜¯é€šè¿‡ JavaScript ç»™è¿™äº›å­—ç¬¦åŠ ä¸ŠåŠ¨ç”»ã€‚<br>å¾ªç¯åŠ¨ç”»<br>é¦–å…ˆï¼Œç¡®ä¿ä½ é¡µé¢çš„ JavaScript ä»£ç æ˜¯ UTF-8 ç¼–ç ï¼Œå¦åˆ™æ— æ³•åœ¨ä½ çš„ä»£ç ä¸­æ˜¾ç¤º emojiï¼Œè¿™å¯ä»¥é€šè¿‡è®¾ç½® HTTP å¤´éƒ¨æˆ–é¡µé¢çš„ META æ ‡ç­¾æ¥å®ç°ã€‚ä½ å¾ˆå¯èƒ½ä¸ç”¨æ‹…å¿ƒè¿™ä¸ªï¼Œä½†ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æ›´å¤šä¿¡æ¯ï¼šUnicode in Javascript by Flavioã€‚<br>ä¸ºäº†è¾¾åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœï¼Œè®© emoji åƒå°ä»™å¥³ä¸€æ ·åœ¨åœ°å€æ é‡Œååèµ·èˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¾ªç¯ï¼Œå®é™…ä¸Šï¼Œæˆ‘ä»¬æ‰€éœ€è¦çš„åªæ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œæˆ‘ä»¬å¯åŠ¨è¿™ä¸ªå¾ªç¯ï¼Œå®ƒä¸æ–­å¾ªç¯ï¼Œæˆ‘ä»¬çš„ç›®çš„å°±è¾¾åˆ°äº†ã€‚è¿™æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªå¾ªç¯åŠ¨ç”»ï¼Œä¸€ä¸ªæ—‹è½¬çš„emoji æœˆäº®ã€‚æˆ‘çŒœå½“ä»–ä»¬æ·»åŠ è¿™ä¸ª emoji åºåˆ—æ—¶ï¼Œä¹Ÿæœ‰è¿™ä¸ªæƒ³æ³•å§ï¼Ÿ</p><pre><code>var f = [&apos;ğŸŒ‘&apos;, &apos;ğŸŒ’&apos;, &apos;ğŸŒ“&apos;, &apos;ğŸŒ”&apos;, &apos;ğŸŒ&apos;, &apos;ğŸŒ–&apos;, &apos;ğŸŒ—&apos;, &apos;ğŸŒ˜&apos;];function loop() {    location.hash = f[Math.floor((Date.now()/100)%f.length)];    setTimeout(loop, 50);}loop();</code></pre><p>å¤åˆ¶ä»£ç è¿è¡Œä»£ç ï¼Œä½ å¯ä»¥åœ¨åœ°å€æ çœ‹åˆ°æ­¤å¾ªç¯çš„ç»“æœã€‚<br>å¦‚æœä½ ä¸å–œæ¬¢æ—‹è½¬çš„æœˆäº®ï¼Œä½ å¯ä»¥é€‰æ‹©ä»»ä½•ä½ å–œæ¬¢çš„ emoji æ¥æ›¿æ¢è¿™ä¸ªæ•°ç»„ï¼Œæ¯”å¦‚ä¸€ä¸ªæ—¶é’Ÿï¼š</p><p>var f = [â€˜ğŸ•â€™,â€™ğŸ•‘â€™,â€™ğŸ•’â€™,â€™ğŸ•“â€™,â€™ğŸ•”â€™,â€™ğŸ••â€™,â€™ğŸ•–â€™,â€™ğŸ•—â€™,â€™ğŸ•˜â€™,â€™ğŸ•™â€™,â€™ğŸ•šâ€™,â€™ğŸ•›â€™];<br>å¤åˆ¶ä»£ç è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ä¾‹å­ï¼ŒçœŸçš„éå¸¸ç®€å•ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥å‡çº§ä¸€ä¸‹å¾ªç¯ï¼Œè®©å®ƒæ˜¾ç¤ºä¸€ä¸² emoji ! è¿™æ¬¡æˆ‘ä»¬ä½¿ç”¨ emoji çš„skin tone modifiersè‚¤è‰²è°ƒèŠ‚å±æ€§æ¥åˆ¶ä½œä¸€äº›å˜è‰²å®å®ï¼š</p><pre><code>var e = [&apos;ğŸ»&apos;, &apos;ğŸ¼&apos;, &apos;ğŸ½&apos;, &apos;ğŸ¾&apos;, &apos;ğŸ¿&apos;];function loop() {    var s = &apos;&apos;,        i, m;    for (i = 0; i &lt; 10; i ++) {        m = Math.floor(e.length * ((Math.sin((Date.now()/100) + i)+1)/2));        s += &apos;ğŸ‘¶&apos; + e[m];    }    location.hash = s;    setTimeout(loop, 50);}loop(); </code></pre><p>å¤åˆ¶ä»£ç æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ—¶é—´å’Œä½ç½®æ§åˆ¶çš„æ­£å¼¦æ³¢æ¥é€‰æ‹©æˆ‘ä»¬æƒ³è¦çš„é¢œè‰²ï¼Œè¿™ç»™äº†æˆ‘ä»¬ä¸€ä¸ªå¾ˆå¥½çš„é¢œè‰²å˜å¹»æ•ˆæœï¼<br>æ¯”å¦‚æˆ‘ä»¬å†æ¥ä¸€æ¬¡æœˆäº®æ—‹è½¬ï¼Œä½¿å®ƒå±•å¼€ï¼Œåˆ¶ä½œä¸€ä¸ªç±»ä¼¼äºåŠ è½½æ¡çš„åŠ¨ç”»ï¼Ÿå¥½çš„ï¼Œå¼€å§‹å®ç°ï¼š</p><pre><code>var f = [&apos;ğŸŒ‘&apos;, &apos;ğŸŒ˜&apos;, &apos;ğŸŒ—&apos;, &apos;ğŸŒ–&apos;, &apos;ğŸŒ•&apos;, &apos;ğŸŒ”&apos;, &apos;ğŸŒ“&apos;, &apos;ğŸŒ’&apos;],    d = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],    m = 0;function loop() {    var s = &apos;&apos;, x = 0;    if (!m) {        while (d[x] == 4) {            x ++;        }        if (x &gt;= d.length) m = 1;        else {            d[x] ++;        }    }    else {        while (d[x] == 0) {            x ++;        }        if (x &gt;= d.length) m = 0;        else {            d[x] ++;            if (d[x] == 8) d[x] = 0;        }    }    d.forEach(function (n) {        s += f[n];    });    location.hash = s;    setTimeout(loop, 50);}loop();</code></pre><p>å¤åˆ¶ä»£ç æ¢ç´¢å…¶å®ƒå­—ç¬¦<br>ä¸æ­¢æ˜¯ emoji ç»™æˆ‘ä»¬æä¾›äº†ä¸€ç§åœ¨åœ°å€æ æ˜¾ç¤ºå›¾å½¢çš„æ–¹æ³•ï¼Œæˆ‘ä»¬çš„ç›®æ ‡ä¸­ä¹Ÿæœ‰ä¸€äº› unicode å­—ç¬¦ã€‚<br>ç‰¹åˆ«æœ‰è¶£çš„æ˜¯ æ¡†çº¿å­—ç¬¦:</p><p>å®ƒä»¬ä¸­å¾ˆå¤šæ›´é€‚åˆäºŒç»´è¾“å‡ºï¼Œä½†å®ƒä»¬åœ¨ä¸€ç»´è¾“å‡ºä¹Ÿå¾ˆæ£’ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå¤šä¸ªé«˜åº¦å˜åŒ–çš„å—å­—ç¬¦ä¸²ï¼Œå¹¶æ„é€ ä¸€ä¸ªæ¼‚äº®çš„å°æ³¢æµªåŠ¨ç”»ï¼š</p><pre><code>function loop() {    var i, n, s = &apos;&apos;;    for (i = 0; i &lt; 10; i++) {        n = Math.floor(Math.sin((Date.now()/200) + (i/2)) * 4) + 4;        s += String.fromCharCode(0x2581 + n);    }    window.location.hash = s;    setTimeout(loop, 50);}loop();</code></pre><p>å¤åˆ¶ä»£ç æˆ‘éå¸¸å–œæ¬¢å®ƒçš„æ•ˆæœï¼Œæˆ‘æŠŠå®ƒæ°¸ä¹…æ”¾åœ¨äº† wavyurl.com ä¸Šã€‚<br>ä½¿ç”¨å¯å˜å®½åº¦å­—ç¬¦ï¼Œæˆ‘ä»¬ç”šè‡³åœ¨æ°´å¹³æ–¹å‘ä¸Šæ‘†åŠ¨ï¼Œåˆ›å»ºç±»ä¼¼äºè¿›åº¦æ¡çš„ä¸œè¥¿ï¼š</p><pre><code>function loop() {    var s = &apos;&apos;,        p;    p = Math.floor(((Math.sin(Date.now()/300)+1)/2) * 100);    while (p &gt;= 8) {        s += &apos;â–ˆ&apos;;        p -= 8;    }    s += [&apos;â €&apos;,&apos;â–&apos;,&apos;â–&apos;,&apos;â–&apos;,&apos;â–Œ&apos;,&apos;â–‹&apos;,&apos;â–Š&apos;,&apos;â–‰&apos;][p];    location.hash = s;    setTimeout(loop, 50);}</code></pre><p>å¤åˆ¶ä»£ç è¿›åº¦æ¡ï¼Ÿè¿™çœ‹èµ·æ¥ï¼Œè¿˜æ˜¯æœ‰ç”¨çš„ï¼Œè¿™è®©æˆ‘æƒ³åˆ°äº†â€¦â€¦<br>åœ¨åœ°å€æ æ˜¾ç¤ºè§†é¢‘è¿›åº¦<br>ä¸ºäº†å¢åŠ æˆ‘ä»¬å°å®éªŒçš„å¯èƒ½æ€§ï¼Œæˆ‘æå‡ºäº†åœ¨åœ°å€æ ä¸­æ˜¾ç¤ºç½‘ç»œè§†é¢‘è¿›åº¦çš„æƒ³æ³•ã€‚æˆ‘åªéœ€é™„åŠ ä¸€ä¸ªå‡½æ•°ï¼Œå°†æˆ‘ä»¬çš„è¿›åº¦å­—ç¬¦ä¸²å®šä¹‰åœ¨è§†é¢‘çš„timeupdateäº‹ä»¶ä¸­ï¼Œç§ï¼åœ°å€æ ä¸­çš„è§†é¢‘è¿›åº¦æ¡åŒ…å«æ—¶é—´å’ŒæŒç»­æ—¶é—´ï¼</p><pre><code>var video;function formatTime(seconds) {    var minutes = Math.floor(seconds/60),        seconds = Math.floor(seconds - (minutes*60));    return (&apos;0&apos;+minutes).substr(-2) + &apos;:&apos; + (&apos;0&apos;+seconds).substr(-2);}function renderProgressBar() {    var s = &apos;&apos;,        l = 15,        p = Math.floor(video.currentTime / video.duration * (l-1)),        i;    for (i = 0; i &lt; l; i ++) {        if (i == p) s +=&apos;â—¯&apos;;        else if (i &lt; p) s += &apos;â”€&apos;;        else s += &apos;â”„&apos;;    }    location.hash = &apos;â•­&apos;+s+&apos;â•®&apos;+formatTime(video.currentTime)+&apos;â•±&apos;+formatTime(video.duration);}video = document.getElementById(&apos;video&apos;);video.addEventListener(&apos;timeupdate&apos;, renderProgressBar);</code></pre><p>å¤åˆ¶ä»£ç æˆ‘æ¯”è¾ƒå–œæ¬¢è¿™ä¸ªçº¿æ¡å’Œåœ†ç»„æˆçš„è¿›åº¦æ¡ï¼Œå¦‚æœä½ å–œæ¬¢åˆ«çš„ emoji æ¯”å¦‚æœˆäº®ï¼Œæˆ‘ä¹Ÿèƒ½è®©ä½ æ»¡æ„ï¼š</p><pre><code>var e = [&apos;ğŸŒ‘&apos;, &apos;ğŸŒ˜&apos;, &apos;ğŸŒ—&apos;, &apos;ğŸŒ–&apos;, &apos;ğŸŒ•&apos;],    video;function formatTime(seconds) {    var minutes = Math.floor(seconds/60),        seconds = Math.floor(seconds - (minutes*60));    return (&apos;0&apos;+minutes).substr(-2) + &apos;:&apos; + (&apos;0&apos;+seconds).substr(-2);}function renderProgressBar() {    var s = &apos;&apos;,        c = 0,        l = 10,        p = Math.floor(video.currentTime / video.duration * ((l*5)-1)),        i;    while (p &gt;= 5) {        s += e[4];        c ++;        p -= 5;    }    s += e[p];    c ++;    while (c &lt; l) {        s += e[0];        c ++;    }    location.hash = s+formatTime(video.currentTime)+&apos;â•±&apos;+formatTime(video.duration);}video = document.getElementById(&apos;video&apos;);video.addEventListener(&apos;timeupdate&apos;, renderProgressBar);</code></pre><p>å¤åˆ¶ä»£ç å¥½çš„ï¼Œå°†æ­¤è¿›åº¦æ¡ç§°ä¸ºâ€œæœ‰ç”¨â€çš„å»¶ä¼¸ã€‚ åªç„ä¸€çœ¼ï¼Œæˆ‘ä¹Ÿå¯ä»¥çœ‹åˆ°åœ¨è§†é¢‘åˆ†äº« URL ä¸­çš„è¿›åº¦ã€‚ ä¸YouTubeä¸€æ ·ï¼Œä½ å¯ä»¥é€‰æ‹©åœ¨ç‰¹å®šæ—¶é—´åˆ›å»ºæŒ‡å‘è§†é¢‘çš„é“¾æ¥ï¼Œæ·»åŠ è§†è§‰æŒ‡ç¤ºæ˜¯ä¸æ˜¯å¾ˆé…·ï¼Ÿå—¯ï¼Ÿ<br>ä¹Ÿè®¸æˆ‘è¿˜æ²¡æœ‰æå‡ºä¸€äº›æ›´æœ‰ç”¨çš„â€œæŠ€æœ¯â€å®ç°ï¼Œæˆ‘ä¼šç»§ç»­æ€è€ƒè¿™ä¸ªé—®é¢˜ã€‚ å˜¿ï¼Œä¹Ÿè®¸ä½ å¯ä»¥å°è¯•ä¸€äº›ä¸œè¥¿ï¼Ÿ<br>æœ€å<br>ä½ å¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ä½¿ç”¨location.hash =ï¼Œè€Œä¸æ˜¯æ–°ä¸”é…·çš„HTML5 History APIã€‚ æœ‰ä¸¤ä¸ªåŸå› ï¼š<br>ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ History APIæœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼šå®ƒå®é™…ä¸Šæ›´æ”¹äº†æ•´ä¸ª URL è·¯å¾„ï¼Œè€Œä¸ä»…ä»…æ˜¯ hashã€‚ å› æ­¤ï¼Œå¦‚æœæˆ‘ä½¿ç”¨ History API å¹¶å°†é¡µé¢æ›´æ”¹ä¸º/ğŸŒ‘ğŸŒ˜ğŸŒ—ğŸŒ–ğŸŒ•ï¼Œå®ƒçœ‹èµ·æ¥ä¼šæ¯”æ·»åŠ  ï¼ƒ æ›´å¥½ã€‚ ä½†è¿™ä¹Ÿæ„å‘³ç€æˆ‘çš„ Web æœåŠ¡å™¨å¿…é¡»èƒ½å¤Ÿå“åº”/ğŸŒ‘ğŸŒ˜ğŸŒ—ğŸŒ–ğŸŒ•ï¼Œå¦åˆ™å¦‚æœç”¨æˆ·åˆ·æ–°æˆ–ä»¥å…¶ä»–æ–¹å¼å¯¼èˆªåˆ°ä¿®æ”¹åçš„ URL å°†ä¼šå¤±è´¥ã€‚ è¿™æ˜¯å¯è¡Œçš„ï¼Œä½†æ¯”ä½¿ç”¨location.hash =æ›´å¤æ‚ï¼Œéœ€è¦æˆ‘ä¿®æ”¹æœåŠ¡å™¨é…ç½®ã€‚<br>ç¬¬äºŒä¸ªé—®é¢˜æœ‰äº›å‡ºä¹æ„æ–™ã€‚ å®é™…ä¸Šï¼Œåœ¨æˆ‘æµ‹è¯•çš„3ä¸ªæµè§ˆå™¨ä¸­ï¼Œæœ‰2ä¸ªå†å²APIè¢«é™åˆ¶çš„ã€‚ å¦‚æœæˆ‘ä»¥æå¿«çš„é€Ÿåº¦å°†æˆ‘çš„æ³¢å½¢ç½‘å€æ¨é€åˆ°åœ°å€æ ï¼Œæˆ‘æœ€ç»ˆä¼šåœ¨ Chrome ä¸­æ”¶åˆ°ä»¥ä¸‹é”™è¯¯ï¼š</p><p>Throttling history state changes to prevent the browser from hanging.</p><p>Safari ç»™æˆ‘ä»¬æä¾›äº†æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼š</p><p>SecurityError: Attempt to use history.pushState() more than 100 times per 30.000000 seconds</p><p>ç°åœ¨ï¼Œå¦‚æœè®©æˆ‘ä¿æŒåœ¨è¿™ä¸ªé™åˆ¶ä¸‹ä¹Ÿè¡Œï¼Œä½†æ˜¯æ¯ç§’3å¸§åªæ˜¯ä¸ä¼šå½±å“æˆ‘ç›®å‰çš„åŠ¨ç”»æ•ˆæœã€‚<br>å¥½å­©å­ Firefox ä¼¼ä¹å¹¶ä¸åœ¨ä¹æˆ‘æ¨é€æ–°å†å²çš„æ¬¡æ•°å’Œé€Ÿåº¦ï¼Œè¿™çœŸæ˜¯æƒ³å¾—å¤ªå‘¨åˆ°äº†ã€‚ä½†æ˜¯ï¼Œä¸¤ä¸ªä¸»è¦çš„æµè§ˆå™¨å—åˆ°å½±å“ï¼ŒåŠ ä¸Šéœ€è¦webæœåŠ¡å™¨é…ç½®æ¥ä¿®å¤ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œä½¿æˆ‘æ›´æ„¿æ„å¿å— URL ä¸­çš„ #ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;p&gt;åŒæ ·æ˜¯9å¹´ä¹‰åŠ¡æ•™è‚²ï¼Œä½ ä¸ºä½•è¿™ä¹ˆä¼˜ç§€ &lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="web" scheme="https://zhanghuaxiao.github.io/categories/web/"/>
    
    
      <category term="ç”¨JavaScriptå’ŒEmoji åšåœ°å€æ åŠ¨ç”»" scheme="https://zhanghuaxiao.github.io/tags/%E7%94%A8JavaScript%E5%92%8CEmoji-%E5%81%9A%E5%9C%B0%E5%9D%80%E6%A0%8F%E5%8A%A8%E7%94%BB/"/>
    
  </entry>
  
  <entry>
    <title>webpack4.29.0åŸºæœ¬ç”¨æ³•</title>
    <link href="https://zhanghuaxiao.github.io/2019/01/25/webpack4-29-0/"/>
    <id>https://zhanghuaxiao.github.io/2019/01/25/webpack4-29-0/</id>
    <published>2019-01-25T09:11:32.000Z</published>
    <updated>2019-02-15T05:26:46.205Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>ä¸ç§¯è·¬æ­¥æ— ä»¥è‡³åƒé‡Œï¼Œä¸ç§¯å°æµæ— ä»¥æˆæ±Ÿæµ· </p></blockquote><p><img src="/img/jy.png"><br><a id="more"></a></p><h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><ul><li><p>å…¨å±€å®‰è£…webpackå’Œwebpack-cli</p><blockquote><p>sudo npm install webpack -g<br>sudo npm install webpack-cli -g</p></blockquote></li><li><p>æ–‡ä»¶å¤¹ä¸‹å±€éƒ¨å®‰è£…</p><blockquote><p>npm init -y<br>sudo npm install webpack â€“save-dev<br>sudo npm install webpack-cli â€“save-dev</p></blockquote></li></ul><h2 id="å®ç°å¯¹ä¸€ä¸ªjsæ–‡ä»¶æ‰“åŒ…"><a href="#å®ç°å¯¹ä¸€ä¸ªjsæ–‡ä»¶æ‰“åŒ…" class="headerlink" title="å®ç°å¯¹ä¸€ä¸ªjsæ–‡ä»¶æ‰“åŒ…"></a>å®ç°å¯¹ä¸€ä¸ªjsæ–‡ä»¶æ‰“åŒ…</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//webpack.config.js</span><br><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line">module.exports = &#123;</span><br><span class="line">    mode:&apos;development&apos;,</span><br><span class="line">    entry:&apos;./app.js&apos;,</span><br><span class="line">    output:&#123;</span><br><span class="line">        filename:&apos;[name].bundle.js&apos;,</span><br><span class="line">        path:path.join(__dirname,&apos;./dist&apos;),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">è¿™æ ·å°±èƒ½åœ¨distç›®å½•ä¸‹å‡ºç°ä¸€ä¸ªapp.bundle.jsæ–‡ä»¶å•¦ï¼</span><br></pre></td></tr></table></figure><h2 id="å®ç°å¤šä¸ªjsæ–‡ä»¶æ‰“åŒ…"><a href="#å®ç°å¤šä¸ªjsæ–‡ä»¶æ‰“åŒ…" class="headerlink" title="å®ç°å¤šä¸ªjsæ–‡ä»¶æ‰“åŒ…"></a>å®ç°å¤šä¸ªjsæ–‡ä»¶æ‰“åŒ…</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">//webpack.config.js</span><br><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line">const CleanWebpackPlugin = require(&apos;clean-webpack-plugin&apos;)</span><br><span class="line">module.exports = &#123;</span><br><span class="line">    mode: &apos;development&apos;,</span><br><span class="line">    entry: &#123;</span><br><span class="line">        index: &apos;./src/index.js&apos;,</span><br><span class="line">        test: &apos;./src/test.js&apos;,</span><br><span class="line">        test1: &apos;./src/test1.js&apos;,</span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.join(__dirname,&apos;./dist/js&apos;),</span><br><span class="line">        filename:&apos;[name]-[hash].js&apos;,</span><br><span class="line">        pubicPath: &apos;http://cdn.con&apos; //è¯·æ±‚æ—¶ä¼šè‡ªå·±åŠ åè®®ï¼ˆlocation.protocol=&apos;http&apos;ï¼‰å’Œç«¯å£å·(host=&apos;cdn.con&apos;)</span><br><span class="line">    &#125;ï¼Œ</span><br><span class="line">    plugins: [</span><br><span class="line">        new CleanWebpackPlugin ([&apos;./dist/js&apos;]) //æ¸…é™¤ä¹‹å‰æ‰“åŒ…çš„æ–‡ä»¶</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨æ¨¡ç‰ˆå®ç°æ¯ä¸ªjså¯¹åº”è‡ªå·±çš„html"><a href="#ä½¿ç”¨æ¨¡ç‰ˆå®ç°æ¯ä¸ªjså¯¹åº”è‡ªå·±çš„html" class="headerlink" title="ä½¿ç”¨æ¨¡ç‰ˆå®ç°æ¯ä¸ªjså¯¹åº”è‡ªå·±çš„html"></a>ä½¿ç”¨æ¨¡ç‰ˆå®ç°æ¯ä¸ªjså¯¹åº”è‡ªå·±çš„html</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">//webpack.config.js</span><br><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line">const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;) //æ¨¡ç‰ˆloader</span><br><span class="line">const CleanWebpackPlugin = require(&apos;clean-webpack-plugin&apos;)</span><br><span class="line">module.exports = &#123;</span><br><span class="line">    entry:&#123;</span><br><span class="line">        index:&apos;./src/index.js&apos;,</span><br><span class="line">        test:&apos;./src/test.js&apos;,</span><br><span class="line">        test1:&apos;./src/test1.js&apos;,</span><br><span class="line">    &#125;,</span><br><span class="line">    output:&#123;</span><br><span class="line">        path:path.join(__dirname,&apos;./dist/js&apos;),</span><br><span class="line">        filename:&apos;[name]-[hash].js&apos;,</span><br><span class="line">        publicPath:&quot;http://cdn.com&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins:[</span><br><span class="line">        new HtmlWebpackPlugin(&#123;</span><br><span class="line">            title: &apos;this a index.html&apos;, //æ¯ä¸ªhtml çš„title</span><br><span class="line">            template:&apos;hello.html&apos;,</span><br><span class="line">            filename:&apos;index.html&apos;,</span><br><span class="line">            excludeChunks:[&apos;test&apos;,&apos;test1&apos;] //æ’é™¤åä¸ºtest.js,test1.jsæ‰“åŒ…çš„jsæ–‡ä»¶</span><br><span class="line">        &#125;),</span><br><span class="line">        new HtmlWebpackPlugin(&#123;</span><br><span class="line">            title:&apos;this a test.js&apos;,</span><br><span class="line">            template:&apos;hello.html&apos;,</span><br><span class="line">            filename:&apos;test.html&apos;,</span><br><span class="line">            excludeChunks:[&apos;index&apos;,&apos;test1&apos;]</span><br><span class="line">        &#125;),</span><br><span class="line">        new HtmlWebpackPlugin(&#123;</span><br><span class="line">            title:&apos;this a test1.js&apos;,</span><br><span class="line">            template:&apos;hello.html&apos;,</span><br><span class="line">            filename:&apos;test1.html&apos;,</span><br><span class="line">            excludeChunks:[&apos;test&apos;,&apos;index&apos;]       </span><br><span class="line">        &#125;),</span><br><span class="line">        new CleanWebpackPlugin([&apos;./dist/js&apos;])</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//hello.html æ¨¡ç‰ˆå†…å®¹</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;</span><br><span class="line">&lt;title&gt;&lt;%= htmlWebpackPlugin.options.title%&gt;&lt;/title&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">    &lt;%=</span><br><span class="line">    compilation.assets[htmlWebpackPlugin.files.chunks.test1.entry.substr</span><br><span class="line">    (htmlWebpackPlugin.files.publicPath.length)].source() %&gt;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;% for(let k in htmlWebpackPlugin.files.chunks) &#123;%&gt;</span><br><span class="line">        &lt;% if(k != &apos;index&apos;) &#123;%&gt;</span><br><span class="line">            &lt;script src=&quot;&lt;%=htmlWebpackPlugin.files.chunks[k].entry %&gt;&quot;&gt;&lt;/script&gt;</span><br><span class="line">        &lt;% &#125;%&gt;</span><br><span class="line">    &lt;% &#125; %&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨file-loader-css-loader-style-loader-postcss-loader"><a href="#ä½¿ç”¨file-loader-css-loader-style-loader-postcss-loader" class="headerlink" title="ä½¿ç”¨file-loader|css-loader|style-loader|postcss-loader"></a>ä½¿ç”¨file-loader|css-loader|style-loader|postcss-loader</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">//webpack.config.js</span><br><span class="line">module.exports = &#123;</span><br><span class="line">mode: &apos;development&apos;,</span><br><span class="line">entry: &apos;./app.js&apos;,</span><br><span class="line">output: &#123;</span><br><span class="line">    filename: &apos;[name].bundle.js&apos;,</span><br><span class="line">    path: path.join(__dirname, &apos;./dist/js1&apos;),</span><br><span class="line">&#125;,</span><br><span class="line">plugins: [</span><br><span class="line">    new CleanWebpackPlugin([&apos;./dist/js1&apos;]),</span><br><span class="line">    require(&apos;autoprefixer&apos;)</span><br><span class="line">],</span><br><span class="line">module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">    &#123;</span><br><span class="line">        test: /\.(le|c)ss$/,</span><br><span class="line">        test: /\.(png|jpg|gif)$/,</span><br><span class="line">        use: [</span><br><span class="line">        &#123; loader: &quot;style-loader&quot; &#125;,</span><br><span class="line">        &#123; loader: &quot;css-loader&quot; &#125;,</span><br><span class="line">        &#123; loader: &apos;file-loader&apos;&#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            loader: &quot;postcss-loader&quot;,</span><br><span class="line">            options: &#123;</span><br><span class="line">            plugins: [</span><br><span class="line">                require(&quot;autoprefixer&quot;) /*åœ¨è¿™é‡Œæ·»åŠ */,</span><br><span class="line">            ],</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    ]</span><br><span class="line"> &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;p&gt;ä¸ç§¯è·¬æ­¥æ— ä»¥è‡³åƒé‡Œï¼Œä¸ç§¯å°æµæ— ä»¥æˆæ±Ÿæµ· &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;/img/jy.png&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="web" scheme="https://zhanghuaxiao.github.io/categories/web/"/>
    
    
      <category term="webpack4+" scheme="https://zhanghuaxiao.github.io/tags/webpack4/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨githubå’Œhexoæ­å»ºä¸ªäººåšå®¢</title>
    <link href="https://zhanghuaxiao.github.io/2019/01/24/posts/"/>
    <id>https://zhanghuaxiao.github.io/2019/01/24/posts/</id>
    <published>2019-01-24T06:16:00.000Z</published>
    <updated>2019-02-15T06:15:19.603Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>æ‰€è°“åšå®¢ï¼Œéƒ½æ˜¯å­¤èŠ³è‡ªèµ </p></blockquote><p>ç°åœ¨è¶Šæ¥è¶Šå¤šçš„äººå–œæ¬¢åˆ©ç”¨Githubæ­å»ºé™æ€ç½‘ç«™ï¼ŒåŸå› ä¸å¤–ä¹ç®€å•çœé’±ã€‚æœ¬äººä¹Ÿåˆ©ç”¨hexo+githubæ­å»ºäº†æœ¬åšå®¢ï¼Œç”¨äºåˆ†äº«ä¸€äº›å¿ƒå¾—ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼ŒæŠ˜è…¾åšå®¢çš„å„ç§é…ç½®ä»¥åŠåŠŸèƒ½å å…·äº†æˆ‘ä¸€éƒ¨åˆ†æ—¶é—´ï¼Œåœ¨æ­¤è¯¦ç»†è®°å½•ä¸‹æˆ‘æ˜¯å¦‚ä½•åˆ©ç”¨hexo+githubæ­å»ºé™æ€åšå®¢ä»¥åŠä¸€äº›é…ç½®ç›¸å…³é—®é¢˜ï¼Œä»¥å…è¿‡åé—å¿˜ï¼Œä¸”å½“å¤‡ä»½ä¹‹ç”¨ã€‚<br><a id="more"></a></p><h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><p> ä¸‹è½½node.jså¹¶å®‰è£…ï¼ˆå®˜ç½‘ä¸‹è½½å®‰è£…ï¼‰ï¼Œé»˜è®¤ä¼šå®‰è£…npmã€‚<br> ä¸‹è½½å®‰è£…gitï¼ˆå®˜ç½‘ä¸‹è½½å®‰è£…ï¼‰<br> ä¸‹è½½å®‰è£…hexoã€‚æ–¹æ³•ï¼šæ‰“å¼€cmd è¿è¡Œnpm install -g hexo</p><h1 id="æœ¬åœ°æ­å»ºhexoé™æ€åšå®¢"><a href="#æœ¬åœ°æ­å»ºhexoé™æ€åšå®¢" class="headerlink" title="æœ¬åœ°æ­å»ºhexoé™æ€åšå®¢"></a>æœ¬åœ°æ­å»ºhexoé™æ€åšå®¢</h1><p> æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå¦‚MyBlog<br> è¿›å…¥è¯¥æ–‡ä»¶å¤¹å†…ï¼Œå³å‡»è¿è¡Œgitï¼Œè¾“å…¥ï¼šhexo initï¼ˆç”Ÿæˆhexoæ¨¡æ¿ï¼Œå¯èƒ½è¦ç¿»å¢™ï¼‰<br> ç”Ÿæˆå®Œæ¨¡æ¿ï¼Œè¿è¡Œnpm installï¼ˆç›®å‰è²Œä¼¼ä¸ç”¨è¿è¡Œè¿™ä¸€æ­¥ï¼‰<br> æœ€åè¿è¡Œï¼šhexo server ï¼ˆè¿è¡Œç¨‹åºï¼Œè®¿é—®æœ¬åœ°+localhost:4000å¯ä»¥çœ‹åˆ°åšå®¢å·²ç»æ­å»ºæˆåŠŸï¼‰</p><h1 id="ç«™å†…æœç´¢é…ç½®"><a href="#ç«™å†…æœç´¢é…ç½®" class="headerlink" title="ç«™å†…æœç´¢é…ç½®"></a>ç«™å†…æœç´¢é…ç½®</h1><p>é¦–å…ˆå®‰è£…hexo-generator-searchdbæ’ä»¶</p><blockquote><p>npm install hexo-generator-searchdb â€“save</p></blockquote><p>ç¼–è¾‘åšå®¢æ ¹ç›®å½•ä¸‹çš„åšå®¢æœ¬åœ°ç›®å½•/_config.ymlç«™ç‚¹é…ç½®æ–‡ä»¶ï¼Œæ–°å¢ä»¥ä¸‹å†…å®¹åˆ°ä»»æ„ä½ç½®ï¼Œsearché¡¶æ ¼æ”¾å¦åˆ™å¯èƒ½æ²¡æ•ˆæœï¼š</p><pre><code>search:  path: search.xml  field: post  format: html  limit: 10000</code></pre><p>ç¼–è¾‘åšå®¢æœ¬åœ°ç›®å½•/themes/next/_config.yml ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼Œå¯ç”¨æœ¬åœ°æœç´¢åŠŸèƒ½,å°†local_search:ä¸‹é¢çš„enable:çš„å€¼ï¼Œæ”¹æˆtrue<br>å¯ä»¥è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œå…ˆæ¸…ç†ç¼“å­˜ï¼Œç„¶åæœ¬åœ°éƒ¨ç½²è°ƒè¯•</p><blockquote><p>hexo clean<br>hexo s</p></blockquote><h2 id="æœç´¢æ— æ•ˆã€ä¸€ç›´loadingçš„é—®é¢˜"><a href="#æœç´¢æ— æ•ˆã€ä¸€ç›´loadingçš„é—®é¢˜" class="headerlink" title="æœç´¢æ— æ•ˆã€ä¸€ç›´loadingçš„é—®é¢˜"></a>æœç´¢æ— æ•ˆã€ä¸€ç›´loadingçš„é—®é¢˜</h2><p>æŒ‰F12å¯ä»¥æŸ¥çœ‹è¯·æ±‚å‘½ä»¤çš„çŠ¶æ€ï¼ŒçŠ¶æ€ç 200è¡¨ç¤ºè¯·æ±‚æˆåŠŸã€‚ä½†æ˜¯æœç´¢åŠ¨ç”»è¿˜æ˜¯ä¸€ç›´åœ¨è½¬ã€‚<br>1.æ–‡ç« ä¸­åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼Œæ–‡ä»¶ç¼–ç æ—¶å‡ºé”™<br><img src="/img/Garbled.png"></p><h1 id="éƒ¨ç½²github"><a href="#éƒ¨ç½²github" class="headerlink" title="éƒ¨ç½²github"></a>éƒ¨ç½²github</h1><p>MyBlogæ–‡ä»¶å¤¹å®‰è£… npm install â€“save hexo-deployer-git<br> æ‰¾åˆ° <em>_config.yml</em>æ–‡ä»¶ä¿®æ”¹ä¸€ä¸‹æ–‡ä»¶<br>deploy:<br>type: git<br>repo: <a href="https://github.com/Zhanghuaxiao/Zhanghuaxiao.github.io.git" target="_blank" rel="noopener">https://github.com/Zhanghuaxiao/Zhanghuaxiao.github.io.git</a><br>branch: master<br><img style="width:600px;height:200px" src="/img/urlimg.png" class="full-image"> æœ€åè¿è¡Œhexo clean(æ¸…é™¤) hexo g(ç”Ÿæˆ) hexo d(éƒ¨ç½²)<br>ç‚¹å‡»æŸ¥çœ‹æ•ˆæœ: <a href="https://zhanghuaxiao.github.io/">https://zhanghuaxiao.github.io/</a><br><img style="width:600px;height:200px" src="/img/github-pages.png" class="full-image"></p><h1 id="ä½¿ç”¨nexTä¸»é¢˜"><a href="#ä½¿ç”¨nexTä¸»é¢˜" class="headerlink" title="ä½¿ç”¨nexTä¸»é¢˜"></a>ä½¿ç”¨nexTä¸»é¢˜</h1><p> å®‰è£… <a href="https://github.com/iissnan/hexo-theme-next themes/next" target="_blank" rel="noopener">git clone</a><br> ä¿®æ”¹_config.ymlæ–‡ä»¶ä¸­ theme:next<br> è¿è¡Œ</p><blockquote><p>hexo clean<br> hexo s</p></blockquote><h1 id="hexoå’ŒnexTä¸­æ–‡ç½‘"><a href="#hexoå’ŒnexTä¸­æ–‡ç½‘" class="headerlink" title="hexoå’ŒnexTä¸­æ–‡ç½‘"></a>hexoå’ŒnexTä¸­æ–‡ç½‘</h1><p> <a href="https://hexo.io/zh-cn/docs/helpers" target="_blank" rel="noopener">hexoä¸­æ–‡ç½‘</a><br> <a href="http://theme-next.iissnan.com/getting-started.html" target="_blank" rel="noopener">nexTä¸­æ–‡å®˜ç½‘</a></p><h1 id="nexTä¸»é¢˜å‚è€ƒæ–‡ç« "><a href="#nexTä¸»é¢˜å‚è€ƒæ–‡ç« " class="headerlink" title="nexTä¸»é¢˜å‚è€ƒæ–‡ç« "></a>nexTä¸»é¢˜å‚è€ƒæ–‡ç« </h1><p> <a href="https://segmentfault.com/a/1190000009544924#articleHeader2" target="_blank" rel="noopener">å¯¹nexTä¸»é¢˜è®¾ç½®</a><br> <a href="https://www.jianshu.com/p/86557c34b671" target="_blank" rel="noopener">seoä¼˜åŒ–</a><br> <a href="https://www.jianshu.com/p/02afabcae502" target="_blank" rel="noopener">Hexoåšå®¢Nextä¸»é¢˜ç«™å†…æœç´¢æ¨¡å—ç›¸å…³ï¼Œè§£å†³æœç´¢æ— æ•ˆã€ä¸€ç›´loadingçš„é—®é¢˜</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;p&gt;æ‰€è°“åšå®¢ï¼Œéƒ½æ˜¯å­¤èŠ³è‡ªèµ &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç°åœ¨è¶Šæ¥è¶Šå¤šçš„äººå–œæ¬¢åˆ©ç”¨Githubæ­å»ºé™æ€ç½‘ç«™ï¼ŒåŸå› ä¸å¤–ä¹ç®€å•çœé’±ã€‚æœ¬äººä¹Ÿåˆ©ç”¨hexo+githubæ­å»ºäº†æœ¬åšå®¢ï¼Œç”¨äºåˆ†äº«ä¸€äº›å¿ƒå¾—ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼ŒæŠ˜è…¾åšå®¢çš„å„ç§é…ç½®ä»¥åŠåŠŸèƒ½å å…·äº†æˆ‘ä¸€éƒ¨åˆ†æ—¶é—´ï¼Œåœ¨æ­¤è¯¦ç»†è®°å½•ä¸‹æˆ‘æ˜¯å¦‚ä½•åˆ©ç”¨hexo+githubæ­å»ºé™æ€åšå®¢ä»¥åŠä¸€äº›é…ç½®ç›¸å…³é—®é¢˜ï¼Œä»¥å…è¿‡åé—å¿˜ï¼Œä¸”å½“å¤‡ä»½ä¹‹ç”¨ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="web" scheme="https://zhanghuaxiao.github.io/categories/web/"/>
    
    
      <category term="hexo" scheme="https://zhanghuaxiao.github.io/tags/hexo/"/>
    
      <category term="nexT" scheme="https://zhanghuaxiao.github.io/tags/nexT/"/>
    
      <category term="æ­å»ºè‡ªå·±åšå®¢" scheme="https://zhanghuaxiao.github.io/tags/%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E5%8D%9A%E5%AE%A2/"/>
    
      <category term="è§£å†³nextä¸»é¢˜æœç´¢loaddingé—®é¢˜" scheme="https://zhanghuaxiao.github.io/tags/%E8%A7%A3%E5%86%B3next%E4%B8%BB%E9%A2%98%E6%90%9C%E7%B4%A2loadding%E9%97%AE%E9%A2%98/"/>
    
  </entry>
  
</feed>
